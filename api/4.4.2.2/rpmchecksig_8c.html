<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>rpm: lib/rpmchecksig.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul>
</div>
<h1>lib/rpmchecksig.c File Reference</h1>Verify the signature of a package. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="system_8h-source.html">system.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="rpmio__internal_8h-source.html">rpmio_internal.h</a>&quot;</code><br>
<code>#include &lt;<a class="el" href="rpmcli_8h-source.html">rpmcli.h</a>&gt;</code><br>
<code>#include &quot;<a class="el" href="rpmdb_8h-source.html">rpmdb.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="rpmts_8h-source.html">rpmts.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="rpmlead_8h-source.html">rpmlead.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="signature_8h-source.html">signature.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="misc_8h-source.html">misc.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="debug_8h-source.html">debug.h</a>&quot;</code><br>

<p>
<a href="rpmchecksig_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmchecksig_8c.html#21607faa2692fedb89cd54312125583c">manageFile</a> (<a class="el" href="struct__FD__s.html">FD_t</a> *fdp, const char **fnp, int flags, int rc)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmchecksig_8c.html#cef76d9715ed2674d8bc30de19a9d46f">copyFile</a> (<a class="el" href="struct__FD__s.html">FD_t</a> *sfdp, const char **sfnp, <a class="el" href="struct__FD__s.html">FD_t</a> *tfdp, const char **tfnp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy header+payload, calculating digest(s) on the fly.  <a href="#cef76d9715ed2674d8bc30de19a9d46f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmchecksig_8c.html#cf26569efc60f40d9085b9285ba489c6">getSignid</a> (<a class="el" href="structheaderToken__s.html">Header</a> sig, int sigtag, unsigned char *signid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve signer fingerprint from an OpenPGP signature tag.  <a href="#cf26569efc60f40d9085b9285ba489c6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmcli.html#g241bf516ea4a8df6d18f2ef212b8ae3d">rpmReSign</a> (<a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, <a class="el" href="structrpmQVKArguments__s.html">QVA_t</a> qva, const char **<a class="el" href="compress_8c.html#a06161d5bbbc977dc1ad9e6669902c5e">argv</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create/modify elements in signature header.  <a href="group__rpmcli.html#g241bf516ea4a8df6d18f2ef212b8ae3d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmcli.html#g6a17ba25516688beb36616c897241f89">rpmcliImportPubkey</a> (const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, const unsigned char *pkt, ssize_t pktlen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Import public key packet(s).  <a href="group__rpmcli.html#g6a17ba25516688beb36616c897241f89"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmcli.html#gfaca0d709bcdd14fc56073afc6b96fa8">rpmcliImportPubkeys</a> (const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, <a class="el" href="structrpmQVKArguments__s.html">QVA_t</a> qva, const char **<a class="el" href="compress_8c.html#a06161d5bbbc977dc1ad9e6669902c5e">argv</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Import public key(s).  <a href="group__rpmcli.html#gfaca0d709bcdd14fc56073afc6b96fa8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmchecksig_8c.html#ed4ea6b1de356f4e24b10a8de7629318">readFile</a> (<a class="el" href="struct__FD__s.html">FD_t</a> fd, const char *fn, <a class="el" href="structpgpDig__s.html">pgpDig</a> dig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmchecksig_8c.html#f77deba26d5fc58e18909166cb5bc020">rpmVerifySignatures</a> (<a class="el" href="structrpmQVKArguments__s.html">QVA_t</a> qva, <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, <a class="el" href="struct__FD__s.html">FD_t</a> fd, const char *fn)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check package and header signatures.  <a href="#f77deba26d5fc58e18909166cb5bc020"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmcli.html#g33f182c151d78105f8e4bc36b6f48420">rpmcliSign</a> (<a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, <a class="el" href="structrpmQVKArguments__s.html">QVA_t</a> qva, const char **<a class="el" href="compress_8c.html#a06161d5bbbc977dc1ad9e6669902c5e">argv</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create/Modify/Check elements from signature header.  <a href="group__rpmcli.html#g33f182c151d78105f8e4bc36b6f48420"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmchecksig_8c.html#751ebc9b28c168fda034b5a6b5b25722">_print_pkts</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmchecksig_8c.html#739b796ffa0a2e9218383068dc83b215">header_magic</a> [8]</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Verify the signature of a package. 
<p>

<p>
Definition in file <a class="el" href="rpmchecksig_8c-source.html">rpmchecksig.c</a>.<hr><h2>Function Documentation</h2>
<a class="anchor" name="cef76d9715ed2674d8bc30de19a9d46f"></a><!-- doxytag: member="rpmchecksig.c::copyFile" ref="cef76d9715ed2674d8bc30de19a9d46f" args="(FD_t *sfdp, const char **sfnp, FD_t *tfdp, const char **tfnp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int copyFile           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__FD__s.html">FD_t</a> *&nbsp;</td>
          <td class="paramname"> <em>sfdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>sfnp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__FD__s.html">FD_t</a> *&nbsp;</td>
          <td class="paramname"> <em>tfdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>tfnp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copy header+payload, calculating digest(s) on the fly. 
<p>

<p>
Definition at line <a class="el" href="rpmchecksig_8c-source.html#l00091">91</a> of file <a class="el" href="rpmchecksig_8c-source.html">rpmchecksig.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmio_8c-source.html#l03257">Fflush()</a>, <a class="el" href="rpmio_8c-source.html#l02824">Fread()</a>, <a class="el" href="rpmio_8c-source.html#l02813">Fstrerror()</a>, <a class="el" href="rpmio_8c-source.html#l02846">Fwrite()</a>, <a class="el" href="rpmchecksig_8c-source.html#l00030">manageFile()</a>, <a class="el" href="rpmerr_8h-source.html#l00117">RPMERR_FREAD</a>, <a class="el" href="rpmerr_8h-source.html#l00116">RPMERR_FWRITE</a>, and <a class="el" href="rpmerr_8h-source.html#l00143">rpmError</a>.
<p>
Referenced by <a class="el" href="rpmchecksig_8c-source.html#l00172">rpmReSign()</a>.
</div>
</div><p>
<a class="anchor" name="cf26569efc60f40d9085b9285ba489c6"></a><!-- doxytag: member="rpmchecksig.c::getSignid" ref="cf26569efc60f40d9085b9285ba489c6" args="(Header sig, int sigtag, unsigned char *signid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int getSignid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td>
          <td class="paramname"> <em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sigtag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>signid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Retrieve signer fingerprint from an OpenPGP signature tag. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sig</em>&nbsp;</td><td>signature header </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sigtag</em>&nbsp;</td><td>signature tag </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>signid</em>&nbsp;</td><td>signer fingerprint </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success </dd></dl>

<p>
Definition at line <a class="el" href="rpmchecksig_8c-source.html#l00140">140</a> of file <a class="el" href="rpmchecksig_8c-source.html">rpmchecksig.c</a>.
<p>
References <a class="el" href="header_8h-source.html#l00704">headerFreeData()</a>, <a class="el" href="hdrinline_8h-source.html#l00268">headerGetEntry()</a>, <a class="el" href="rpmpgp_8c-source.html#l01056">pgpFreeDig()</a>, <a class="el" href="rpmpgp_8c-source.html#l01014">pgpNewDig()</a>, <a class="el" href="rpmpgp_8c-source.html#l01109">pgpPrtPkts()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00067">pgpDig_s::signature</a>, and <a class="el" href="rpmio__internal_8h-source.html#l00056">pgpDigParams_s::signid</a>.
<p>
Referenced by <a class="el" href="rpmchecksig_8c-source.html#l00172">rpmReSign()</a>.
</div>
</div><p>
<a class="anchor" name="21607faa2692fedb89cd54312125583c"></a><!-- doxytag: member="rpmchecksig.c::manageFile" ref="21607faa2692fedb89cd54312125583c" args="(FD_t *fdp, const char **fnp, int flags, int rc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int manageFile           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__FD__s.html">FD_t</a> *&nbsp;</td>
          <td class="paramname"> <em>fdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>fnp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="rpmchecksig_8c-source.html#l00030">30</a> of file <a class="el" href="rpmchecksig_8c-source.html">rpmchecksig.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmio_8c-source.html#l02903">Fclose()</a>, <a class="el" href="rpmio_8h-source.html#l00533">fdFree</a>, <a class="el" href="rpmio_8h-source.html#l00524">fdLink</a>, <a class="el" href="rpmio_8c-source.html#l03277">Ferror()</a>, <a class="el" href="rpmio_8c-source.html#l03184">Fopen()</a>, <a class="el" href="rpmio_8c-source.html#l02813">Fstrerror()</a>, <a class="el" href="lib_2misc_8c-source.html#l00122">makeTempFile()</a>, <a class="el" href="rpmerr_8h-source.html#l00115">RPMERR_MAKETEMP</a>, <a class="el" href="rpmerr_8h-source.html#l00102">RPMERR_OPEN</a>, and <a class="el" href="rpmerr_8h-source.html#l00143">rpmError</a>.
<p>
Referenced by <a class="el" href="rpmchecksig_8c-source.html#l00091">copyFile()</a>, and <a class="el" href="rpmchecksig_8c-source.html#l00172">rpmReSign()</a>.
</div>
</div><p>
<a class="anchor" name="ed4ea6b1de356f4e24b10a8de7629318"></a><!-- doxytag: member="rpmchecksig.c::readFile" ref="ed4ea6b1de356f4e24b10a8de7629318" args="(FD_t fd, const char *fn, pgpDig dig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int readFile           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__FD__s.html">FD_t</a>&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpgpDig__s.html">pgpDig</a>&nbsp;</td>
          <td class="paramname"> <em>dig</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000029">Todo:</a></b></dt><dd>If the GPG key was known available, the md5 digest could be skipped. </dd></dl>

<p>
Definition at line <a class="el" href="rpmchecksig_8c-source.html#l00640">640</a> of file <a class="el" href="rpmchecksig_8c-source.html">rpmchecksig.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmio__internal_8h-source.html#l00174">_FD_s::digests</a>, <a class="el" href="rpmio_8c-source.html#l02824">Fread()</a>, <a class="el" href="rpmio_8c-source.html#l02813">Fstrerror()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00052">pgpDigParams_s::hash_algo</a>, <a class="el" href="rpmio__internal_8h-source.html#l00136">_FDDIGEST_s::hashalgo</a>, <a class="el" href="rpmio__internal_8h-source.html#l00137">_FDDIGEST_s::hashctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00083">pgpDig_s::hdrmd5ctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00075">pgpDig_s::hdrsha1ctx</a>, <a class="el" href="header_8h-source.html#l00209">HEADER_MAGIC_YES</a>, <a class="el" href="hdrinline_8h-source.html#l00047">headerFree()</a>, <a class="el" href="header_8h-source.html#l00704">headerFreeData()</a>, <a class="el" href="hdrinline_8h-source.html#l00268">headerGetEntry()</a>, <a class="el" href="hdrinline_8h-source.html#l00230">headerIsEntry()</a>, <a class="el" href="hdrinline_8h-source.html#l00200">headerRead()</a>, <a class="el" href="hdrinline_8h-source.html#l00120">headerSizeof()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00081">pgpDig_s::md5ctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00070">pgpDig_s::nbytes</a>, <a class="el" href="rpmio__internal_8h-source.html#l00172">_FD_s::ndigests</a>, <a class="el" href="rpmpgp_8h-source.html#l00285">PGPHASHALGO_MD5</a>, <a class="el" href="rpmpgp_8h-source.html#l00286">PGPHASHALGO_SHA1</a>, <a class="el" href="rpmpgp_8h-source.html#l00291">PGPHASHALGO_SHA256</a>, <a class="el" href="rpmpgp_8h-source.html#l00292">PGPHASHALGO_SHA384</a>, <a class="el" href="rpmpgp_8h-source.html#l00293">PGPHASHALGO_SHA512</a>, <a class="el" href="rpmpgp_8h-source.html#l00978">RPMDIGEST_NONE</a>, <a class="el" href="digest_8c-source.html#l00046">rpmDigestInit()</a>, <a class="el" href="digest_8c-source.html#l00141">rpmDigestUpdate()</a>, <a class="el" href="rpmerr_8h-source.html#l00117">RPMERR_FREAD</a>, <a class="el" href="rpmerr_8h-source.html#l00143">rpmError</a>, <a class="el" href="rpmlib_8h-source.html#l00236">RPMTAG_HEADERIMMUTABLE</a>, <a class="el" href="rpmio__internal_8h-source.html#l00073">pgpDig_s::sha1ctx</a>, and <a class="el" href="rpmio__internal_8h-source.html#l00067">pgpDig_s::signature</a>.
<p>
Referenced by <a class="el" href="rpmchecksig_8c-source.html#l00721">rpmVerifySignatures()</a>.
</div>
</div><p>
<a class="anchor" name="f77deba26d5fc58e18909166cb5bc020"></a><!-- doxytag: member="rpmchecksig.c::rpmVerifySignatures" ref="f77deba26d5fc58e18909166cb5bc020" args="(QVA_t qva, rpmts ts, FD_t fd, const char *fn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rpmVerifySignatures           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrpmQVKArguments__s.html">QVA_t</a>&nbsp;</td>
          <td class="paramname"> <em>qva</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__FD__s.html">FD_t</a>&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check package and header signatures. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>qva</em>&nbsp;</td><td>parsed query/verify options </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ts</em>&nbsp;</td><td>transaction set </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>package file handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fn</em>&nbsp;</td><td>package file <a class="el" href="structname.html">name</a> </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, 1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="rpmchecksig_8c-source.html#l00721">721</a> of file <a class="el" href="rpmchecksig_8c-source.html">rpmchecksig.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="package_8c-source.html#l00032">_print_pkts</a>, <a class="el" href="rpmio__internal_8h-source.html#l00533">fdInitDigest()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00052">pgpDigParams_s::hash_algo</a>, <a class="el" href="header_8h-source.html#l00704">headerFreeData()</a>, <a class="el" href="hdrinline_8h-source.html#l00466">headerFreeIterator()</a>, <a class="el" href="hdrinline_8h-source.html#l00268">headerGetEntry()</a>, <a class="el" href="hdrinline_8h-source.html#l00478">headerInitIterator()</a>, <a class="el" href="hdrinline_8h-source.html#l00230">headerIsEntry()</a>, <a class="el" href="hdrinline_8h-source.html#l00494">headerNextIterator()</a>, <a class="el" href="rpmpgp_8c-source.html#l01021">pgpCleanDig()</a>, <a class="el" href="rpmpgp_8h-source.html#l00285">PGPHASHALGO_MD5</a>, <a class="el" href="rpmpgp_8h-source.html#l00286">PGPHASHALGO_SHA1</a>, <a class="el" href="rpmpgp_8c-source.html#l01109">pgpPrtPkts()</a>, <a class="el" href="rpmcli_8h-source.html#l00266">rpmQVKArguments_s::qva_flags</a>, <a class="el" href="rpmchecksig_8c-source.html#l00640">readFile()</a>, <a class="el" href="rpmlead_8c-source.html#l00048">readLead()</a>, <a class="el" href="rpmerr_8h-source.html#l00127">RPMERR_BADSIGTYPE</a>, <a class="el" href="rpmerr_8h-source.html#l00118">RPMERR_READLEAD</a>, <a class="el" href="rpmerr_8h-source.html#l00128">RPMERR_SIGGEN</a>, <a class="el" href="rpmerr_8h-source.html#l00129">RPMERR_SIGVFY</a>, <a class="el" href="rpmerr_8h-source.html#l00143">rpmError</a>, <a class="el" href="signature_8c-source.html#l00381">rpmFreeSignature()</a>, <a class="el" href="rpmmessages_8h-source.html#l00031">rpmIsDebug</a>, <a class="el" href="rpmmessages_8h-source.html#l00029">rpmIsVerbose</a>, <a class="el" href="rpmlib_8h-source.html#l00025">RPMRC_NOKEY</a>, <a class="el" href="rpmlib_8h-source.html#l00024">RPMRC_NOTTRUSTED</a>, <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>, <a class="el" href="signature_8c-source.html#l00155">rpmReadSignature()</a>, <a class="el" href="rpmlib_8h-source.html#l01218">RPMSIGTAG_DSA</a>, <a class="el" href="rpmlib_8h-source.html#l01212">RPMSIGTAG_GPG</a>, <a class="el" href="rpmlib_8h-source.html#l01208">RPMSIGTAG_LEMD5_1</a>, <a class="el" href="rpmlib_8h-source.html#l01210">RPMSIGTAG_LEMD5_2</a>, <a class="el" href="rpmlib_8h-source.html#l01211">RPMSIGTAG_MD5</a>, <a class="el" href="rpmlib_8h-source.html#l01209">RPMSIGTAG_PGP</a>, <a class="el" href="rpmlib_8h-source.html#l01213">RPMSIGTAG_PGP5</a>, <a class="el" href="rpmlib_8h-source.html#l01219">RPMSIGTAG_RSA</a>, <a class="el" href="rpmlib_8h-source.html#l01217">RPMSIGTAG_SHA1</a>, <a class="el" href="rpmlib_8h-source.html#l01207">RPMSIGTAG_SIZE</a>, <a class="el" href="rpmts_8c-source.html#l00754">rpmtsCleanDig()</a>, <a class="el" href="rpmts_8c-source.html#l01171">rpmtsDig()</a>, <a class="el" href="rpmts_8c-source.html#l01155">rpmtsSetSig()</a>, <a class="el" href="rpmts_8c-source.html#l01182">rpmtsSignature()</a>, <a class="el" href="signature_8c-source.html#l01486">rpmVerifySignature()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00067">pgpDig_s::signature</a>, <a class="el" href="system_8h.html#58841684f76853b313e27e663c850381">stpcpy()</a>, <a class="el" href="system_8h.html#d9f2a89c949c0fb5ab54318cca1f11d8">stpncpy()</a>, <a class="el" href="rpmcli_8h-source.html#l00209">VERIFY_DIGEST</a>, <a class="el" href="rpmcli_8h-source.html#l00210">VERIFY_SIGNATURE</a>, and <a class="el" href="rpmio__internal_8h-source.html#l00048">pgpDigParams_s::version</a>.
<p>
Referenced by <a class="el" href="rpmchecksig_8c-source.html#l01064">rpmcliSign()</a>.
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="751ebc9b28c168fda034b5a6b5b25722"></a><!-- doxytag: member="rpmchecksig.c::_print_pkts" ref="751ebc9b28c168fda034b5a6b5b25722" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="rpmchecksig_8c.html#751ebc9b28c168fda034b5a6b5b25722">_print_pkts</a> = 0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="rpmchecksig_8c-source.html#l00025">25</a> of file <a class="el" href="rpmchecksig_8c-source.html">rpmchecksig.c</a>.
</div>
</div><p>
<a class="anchor" name="739b796ffa0a2e9218383068dc83b215"></a><!-- doxytag: member="rpmchecksig.c::header_magic" ref="739b796ffa0a2e9218383068dc83b215" args="[8]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char <a class="el" href="group__header.html#g739b796ffa0a2e9218383068dc83b215">header_magic</a>[8]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        0x8e, 0xad, 0xe8, 0x01, 0x00, 0x00, 0x00, 0x00
}
</pre></div>
<p>
Definition at line <a class="el" href="rpmchecksig_8c-source.html#l00633">633</a> of file <a class="el" href="rpmchecksig_8c-source.html">rpmchecksig.c</a>.
</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Oct 12 08:44:55 2007 for rpm by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
