<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>rpm: lib/signature.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul>
</div>
<h1>lib/signature.c File Reference</h1><code>#include &quot;<a class="el" href="system_8h-source.html">system.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="rpmio__internal_8h-source.html">rpmio_internal.h</a>&quot;</code><br>
<code>#include &lt;<a class="el" href="rpmlib_8h-source.html">rpmlib.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="rpmmacro_8h-source.html">rpmmacro.h</a>&gt;</code><br>
<code>#include &quot;<a class="el" href="rpmdb_8h-source.html">rpmdb.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="rpmts_8h-source.html">rpmts.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="misc_8h-source.html">misc.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="legacy_8h-source.html">legacy.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="rpmlead_8h-source.html">rpmlead.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="signature_8h-source.html">signature.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="header__internal_8h-source.html">header_internal.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="debug_8h-source.html">debug.h</a>&quot;</code><br>

<p>
<a href="signature_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g2ff1c79a477fc07e2f8fc46f6f043d2f">rpmLookupSignatureType</a> (int action)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return type of signature needed for signing/building.  <a href="group__signature.html#g2ff1c79a477fc07e2f8fc46f6f043d2f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#ge2cc77c91f11db1b73b43848dba892d5">rpmDetectPGPVersion</a> (<a class="el" href="group__signature.html#gfa8ccac086339aaef67c9ff8497e9798">pgpVersion</a> *pgpVer)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return path to pgp executable of given type, or NULL when not found.  <a href="group__signature.html#ge2cc77c91f11db1b73b43848dba892d5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#a543ed1b84c2c350f70e04b07f143cdc">printSize</a> (<a class="el" href="struct__FD__s.html">FD_t</a> fd, int siglen, int pad, int datalen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print package size.  <a href="#a543ed1b84c2c350f70e04b07f143cdc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g0fe8e4ac74a97007c91b911720df2941">rpmReadSignature</a> (<a class="el" href="struct__FD__s.html">FD_t</a> fd, <a class="el" href="structheaderToken__s.html">Header</a> *sighp, <a class="el" href="group__signature.html#g2104c37f6609aab12980d46c54299008">sigType</a> sig_type, const char **msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read (and verify header+payload size) signature header.  <a href="group__signature.html#g0fe8e4ac74a97007c91b911720df2941"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#gaa40d7f97708b8badc11deabb0f35207">rpmWriteSignature</a> (<a class="el" href="struct__FD__s.html">FD_t</a> fd, <a class="el" href="structheaderToken__s.html">Header</a> sigh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write signature header.  <a href="group__signature.html#gaa40d7f97708b8badc11deabb0f35207"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g7b8d13bd83797ed4e64684d4f128004e">rpmNewSignature</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return new, empty (signature) header instance.  <a href="group__signature.html#g7b8d13bd83797ed4e64684d4f128004e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#gc8c1b815975de5d320d36eb5d6ae032d">rpmFreeSignature</a> (<a class="el" href="structheaderToken__s.html">Header</a> sigh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy signature header from package.  <a href="group__signature.html#gc8c1b815975de5d320d36eb5d6ae032d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#226fa88a72e90122d32f25fad6758706">makePGPSignature</a> (const char *<a class="el" href="parseScript_8c.html#4f4da8b93048dccc588f5ddc4d7e1561">file</a>, <a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> *sigTagp, <a class="el" href="rpmpgp_8h.html#ea185528b70b44efcecbc49855184018">byte</a> **pktp, <a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> *pktlenp, const char *passPhrase)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate PGP signature(s) for a header+payload file.  <a href="#226fa88a72e90122d32f25fad6758706"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#7710e6dd628e6da4ddb311337877e46c">makeGPGSignature</a> (const char *<a class="el" href="parseScript_8c.html#4f4da8b93048dccc588f5ddc4d7e1561">file</a>, <a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> *sigTagp, <a class="el" href="rpmpgp_8h.html#ea185528b70b44efcecbc49855184018">byte</a> **pktp, <a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> *pktlenp, const char *passPhrase)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate GPG signature(s) for a header+payload file.  <a href="#7710e6dd628e6da4ddb311337877e46c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#f31c7385a0013106f1af34d887a7d591">makeHDRSignature</a> (<a class="el" href="structheaderToken__s.html">Header</a> sigh, const char *<a class="el" href="parseScript_8c.html#4f4da8b93048dccc588f5ddc4d7e1561">file</a>, <a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> sigTag, const char *passPhrase)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate header only signature(s) from a header+payload file.  <a href="#f31c7385a0013106f1af34d887a7d591"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g83c70b3fbfde7ba29cdde61689bbb29f">rpmAddSignature</a> (<a class="el" href="structheaderToken__s.html">Header</a> sigh, const char *<a class="el" href="parseScript_8c.html#4f4da8b93048dccc588f5ddc4d7e1561">file</a>, <a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> sigTag, const char *passPhrase)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate signature(s) from a header+payload file, save in signature header.  <a href="group__signature.html#g83c70b3fbfde7ba29cdde61689bbb29f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#edb1b804e83d504ae6f8d827cf521df4">checkPassPhrase</a> (const char *passPhrase, const int sigTag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g3c5f526587b37055f4f8d481d1e4fb49">rpmGetPassPhrase</a> (const char *prompt, const int sigTag)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a pass phrase using getpass(3), confirm with gpg/pgp helper binaries.  <a href="group__signature.html#g3c5f526587b37055f4f8d481d1e4fb49"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#a70cb7eb4b26a664efb7a95d503d22e8">rpmSigString</a> (<a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> res)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#c056ccfffae05c1eda0bf5194d7de997">verifySizeSignature</a> (const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, char *t)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#0eb78e9fdc549b1cb926b355f2b3fa35">verifyMD5Signature</a> (const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, char *t, <a class="el" href="structDIGEST__CTX__s.html">DIGEST_CTX</a> md5ctx)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#f38a8fe22ac77fe770ed2df5ab6f2675">verifySHA1Signature</a> (const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, char *t, <a class="el" href="structDIGEST__CTX__s.html">DIGEST_CTX</a> sha1ctx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify header immutable region SHA1 digest.  <a href="#f38a8fe22ac77fe770ed2df5ab6f2675"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#4461bea31fe1f7c1aca90fef44512708">nibble</a> (char c)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert hex to binary nibble.  <a href="#4461bea31fe1f7c1aca90fef44512708"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#9f56af77b5e4c2ccb87e0b31f36dc0eb">verifyRSASignature</a> (<a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, char *t, <a class="el" href="structDIGEST__CTX__s.html">DIGEST_CTX</a> md5ctx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify RSA signature.  <a href="#9f56af77b5e4c2ccb87e0b31f36dc0eb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#876ecccbaf4494a313f5ff55bba47ce8">verifyDSASignature</a> (<a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, char *t, <a class="el" href="structDIGEST__CTX__s.html">DIGEST_CTX</a> sha1ctx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify DSA signature.  <a href="#876ecccbaf4494a313f5ff55bba47ce8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g0057ca9b565ec097c7e80dc7640a9196">rpmVerifySignature</a> (const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, char *result)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify a signature from a package.  <a href="group__signature.html#g0057ca9b565ec097c7e80dc7640a9196"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#26d345f5cb95c9000b59e3add5fc5a94">environ</a> = NULL</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html#739b796ffa0a2e9218383068dc83b215">header_magic</a> [8]</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>
Definition in file <a class="el" href="signature_8c-source.html">signature.c</a>.<hr><h2>Function Documentation</h2>
<a class="anchor" name="edb1b804e83d504ae6f8d827cf521df4"></a><!-- doxytag: member="signature.c::checkPassPhrase" ref="edb1b804e83d504ae6f8d827cf521df4" args="(const char *passPhrase, const int sigTag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int checkPassPhrase           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>passPhrase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>sigTag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00854">854</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="lib_2misc_8c-source.html#l00110">dosetenv()</a>, <a class="el" href="signature_8c-source.html#l00030">environ</a>, <a class="el" href="system_8h.html#a5e6580e8f12679392f66d3c9b146ab4">errno</a>, <a class="el" href="signature_8h-source.html#l00025">PGP_2</a>, <a class="el" href="signature_8h-source.html#l00026">PGP_5</a>, <a class="el" href="signature_8h-source.html#l00023">PGP_NOTDETECTED</a>, <a class="el" href="signature_8h-source.html#l00024">PGP_UNKNOWN</a>, <a class="el" href="signature_8c-source.html#l00073">rpmDetectPGPVersion()</a>, <a class="el" href="rpmerr_8h-source.html#l00091">RPMERR_EXEC</a>, <a class="el" href="rpmerr_8h-source.html#l00128">RPMERR_SIGGEN</a>, <a class="el" href="rpmerr_8h-source.html#l00143">rpmError</a>, <a class="el" href="macro_8c-source.html#l02116">rpmExpand()</a>, <a class="el" href="rpmmessages_8h-source.html#l00029">rpmIsVerbose</a>, <a class="el" href="rpmlib_8h-source.html#l01218">RPMSIGTAG_DSA</a>, <a class="el" href="rpmlib_8h-source.html#l01212">RPMSIGTAG_GPG</a>, <a class="el" href="rpmlib_8h-source.html#l01209">RPMSIGTAG_PGP</a>, <a class="el" href="rpmlib_8h-source.html#l01213">RPMSIGTAG_PGP5</a>, <a class="el" href="rpmlib_8h-source.html#l01219">RPMSIGTAG_RSA</a>, <a class="el" href="file_8h-source.html#l00323">strerror</a>, and <a class="el" href="system_8h.html#440dcd7dd71b4d668d8b9112643b9e0a">unsetenv()</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l00965">rpmGetPassPhrase()</a>.
</div>
</div><p>
<a class="anchor" name="7710e6dd628e6da4ddb311337877e46c"></a><!-- doxytag: member="signature.c::makeGPGSignature" ref="7710e6dd628e6da4ddb311337877e46c" args="(const char *file, int_32 *sigTagp, byte **pktp, int_32 *pktlenp, const char *passPhrase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int makeGPGSignature           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> *&nbsp;</td>
          <td class="paramname"> <em>sigTagp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rpmpgp_8h.html#ea185528b70b44efcecbc49855184018">byte</a> **&nbsp;</td>
          <td class="paramname"> <em>pktp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> *&nbsp;</td>
          <td class="paramname"> <em>pktlenp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>passPhrase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate GPG signature(s) for a header+payload file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>header+payload file <a class="el" href="structname.html">name</a> </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*sigTagp</em>&nbsp;</td><td>signature tag </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>*pktp</em>&nbsp;</td><td>signature packet(s) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>*pktlenp</em>&nbsp;</td><td>signature packet(s) length </td></tr>
  </table>
</dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>passPhrase</em>&nbsp;</td><td>private key pass phrase </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, 1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00544">544</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="macro_8c-source.html#l01872">addMacro()</a>, <a class="el" href="system_8h.html#58ff5c3142f685bf7e95cc0cbfaf49c9">alloca()</a>, <a class="el" href="macro_8c-source.html#l01898">delMacro()</a>, <a class="el" href="lib_2misc_8c-source.html#l00110">dosetenv()</a>, <a class="el" href="signature_8c-source.html#l00030">environ</a>, <a class="el" href="system_8h.html#a5e6580e8f12679392f66d3c9b146ab4">errno</a>, <a class="el" href="rpmio_8c-source.html#l02903">Fclose()</a>, <a class="el" href="rpmio_8c-source.html#l03277">Ferror()</a>, <a class="el" href="rpmio_8c-source.html#l03184">Fopen()</a>, <a class="el" href="rpmpgp_8c-source.html#l01056">pgpFreeDig()</a>, <a class="el" href="rpmpgp_8c-source.html#l01014">pgpNewDig()</a>, <a class="el" href="rpmpgp_8c-source.html#l01109">pgpPrtPkts()</a>, <a class="el" href="rpmpgp_8h-source.html#l00173">PGPPUBKEYALGO_DSA</a>, <a class="el" href="rpmpgp_8h-source.html#l00169">PGPPUBKEYALGO_RSA</a>, <a class="el" href="rpmio__internal_8h-source.html#l00050">pgpDigParams_s::pubkey_algo</a>, <a class="el" href="rpmerr_8h-source.html#l00091">RPMERR_EXEC</a>, <a class="el" href="rpmerr_8h-source.html#l00128">RPMERR_SIGGEN</a>, <a class="el" href="rpmerr_8h-source.html#l00143">rpmError</a>, <a class="el" href="macro_8c-source.html#l02116">rpmExpand()</a>, <a class="el" href="rpmmessages_8h-source.html#l00011">RPMMESS_DEBUG</a>, <a class="el" href="rpmmessages_8h-source.html#l00020">rpmMessage</a>, <a class="el" href="rpmlib_8h-source.html#l01218">RPMSIGTAG_DSA</a>, <a class="el" href="rpmlib_8h-source.html#l01212">RPMSIGTAG_GPG</a>, <a class="el" href="rpmlib_8h-source.html#l01211">RPMSIGTAG_MD5</a>, <a class="el" href="rpmlib_8h-source.html#l01209">RPMSIGTAG_PGP</a>, <a class="el" href="rpmlib_8h-source.html#l01213">RPMSIGTAG_PGP5</a>, <a class="el" href="rpmlib_8h-source.html#l01219">RPMSIGTAG_RSA</a>, <a class="el" href="rpmlib_8h-source.html#l01217">RPMSIGTAG_SHA1</a>, <a class="el" href="rpmlib_8h-source.html#l01207">RPMSIGTAG_SIZE</a>, <a class="el" href="rpmio__internal_8h-source.html#l00067">pgpDig_s::signature</a>, <a class="el" href="system_8h.html#58841684f76853b313e27e663c850381">stpcpy()</a>, <a class="el" href="file_8h-source.html#l00323">strerror</a>, <a class="el" href="rpmio_8h-source.html#l00640">timedRead</a>, <a class="el" href="system_8h.html#440dcd7dd71b4d668d8b9112643b9e0a">unsetenv()</a>, and <a class="el" href="rpmmalloc_8c-source.html#l00024">xmalloc()</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l00697">makeHDRSignature()</a>, and <a class="el" href="signature_8c-source.html#l00801">rpmAddSignature()</a>.
</div>
</div><p>
<a class="anchor" name="f31c7385a0013106f1af34d887a7d591"></a><!-- doxytag: member="signature.c::makeHDRSignature" ref="f31c7385a0013106f1af34d887a7d591" args="(Header sigh, const char *file, int_32 sigTag, const char *passPhrase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int makeHDRSignature           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td>
          <td class="paramname"> <em>sigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a>&nbsp;</td>
          <td class="paramname"> <em>sigTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>passPhrase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate header only signature(s) from a header+payload file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sigh</em>&nbsp;</td><td>signature header </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>header+payload file <a class="el" href="structname.html">name</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sigTag</em>&nbsp;</td><td>type of signature(s) to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>passPhrase</em>&nbsp;</td><td>private key pass phrase </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00697">697</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="rpmio_8c-source.html#l02903">Fclose()</a>, <a class="el" href="rpmio_8c-source.html#l03277">Ferror()</a>, <a class="el" href="rpmio_8c-source.html#l03184">Fopen()</a>, <a class="el" href="package_8c-source.html#l00044">header_magic</a>, <a class="el" href="header_8h-source.html#l00209">HEADER_MAGIC_YES</a>, <a class="el" href="hdrinline_8h-source.html#l00315">headerAddEntry()</a>, <a class="el" href="hdrinline_8h-source.html#l00047">headerFree()</a>, <a class="el" href="header_8h-source.html#l00704">headerFreeData()</a>, <a class="el" href="hdrinline_8h-source.html#l00268">headerGetEntry()</a>, <a class="el" href="hdrinline_8h-source.html#l00230">headerIsEntry()</a>, <a class="el" href="hdrinline_8h-source.html#l00200">headerRead()</a>, <a class="el" href="hdrinline_8h-source.html#l00214">headerWrite()</a>, <a class="el" href="signature_8c-source.html#l00544">makeGPGSignature()</a>, <a class="el" href="signature_8c-source.html#l00395">makePGPSignature()</a>, <a class="el" href="lib_2misc_8c-source.html#l00122">makeTempFile()</a>, <a class="el" href="rpmpgp_8h-source.html#l00286">PGPHASHALGO_SHA1</a>, <a class="el" href="header_8h-source.html#l00224">RPM_BIN_TYPE</a>, <a class="el" href="header_8h-source.html#l00223">RPM_STRING_TYPE</a>, <a class="el" href="rpmpgp_8h-source.html#l00978">RPMDIGEST_NONE</a>, <a class="el" href="digest_8c-source.html#l00155">rpmDigestFinal()</a>, <a class="el" href="digest_8c-source.html#l00046">rpmDigestInit()</a>, <a class="el" href="digest_8c-source.html#l00141">rpmDigestUpdate()</a>, <a class="el" href="rpmlib_8h-source.html#l01218">RPMSIGTAG_DSA</a>, <a class="el" href="rpmlib_8h-source.html#l01212">RPMSIGTAG_GPG</a>, <a class="el" href="rpmlib_8h-source.html#l01211">RPMSIGTAG_MD5</a>, <a class="el" href="rpmlib_8h-source.html#l01209">RPMSIGTAG_PGP</a>, <a class="el" href="rpmlib_8h-source.html#l01213">RPMSIGTAG_PGP5</a>, <a class="el" href="rpmlib_8h-source.html#l01219">RPMSIGTAG_RSA</a>, <a class="el" href="rpmlib_8h-source.html#l01217">RPMSIGTAG_SHA1</a>, <a class="el" href="rpmlib_8h-source.html#l01207">RPMSIGTAG_SIZE</a>, and <a class="el" href="rpmlib_8h-source.html#l00236">RPMTAG_HEADERIMMUTABLE</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l00801">rpmAddSignature()</a>.
</div>
</div><p>
<a class="anchor" name="226fa88a72e90122d32f25fad6758706"></a><!-- doxytag: member="signature.c::makePGPSignature" ref="226fa88a72e90122d32f25fad6758706" args="(const char *file, int_32 *sigTagp, byte **pktp, int_32 *pktlenp, const char *passPhrase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int makePGPSignature           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> *&nbsp;</td>
          <td class="paramname"> <em>sigTagp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rpmpgp_8h.html#ea185528b70b44efcecbc49855184018">byte</a> **&nbsp;</td>
          <td class="paramname"> <em>pktp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> *&nbsp;</td>
          <td class="paramname"> <em>pktlenp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>passPhrase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate PGP signature(s) for a header+payload file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>header+payload file <a class="el" href="structname.html">name</a> </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*sigTagp</em>&nbsp;</td><td>signature tag </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>*pktp</em>&nbsp;</td><td>signature packet(s) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>*pktlenp</em>&nbsp;</td><td>signature packet(s) length </td></tr>
  </table>
</dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>passPhrase</em>&nbsp;</td><td>private key pass phrase </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, 1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00395">395</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="macro_8c-source.html#l01872">addMacro()</a>, <a class="el" href="system_8h.html#58ff5c3142f685bf7e95cc0cbfaf49c9">alloca()</a>, <a class="el" href="macro_8c-source.html#l01898">delMacro()</a>, <a class="el" href="lib_2misc_8c-source.html#l00110">dosetenv()</a>, <a class="el" href="signature_8c-source.html#l00030">environ</a>, <a class="el" href="system_8h.html#a5e6580e8f12679392f66d3c9b146ab4">errno</a>, <a class="el" href="rpmio_8c-source.html#l02903">Fclose()</a>, <a class="el" href="rpmio_8c-source.html#l03277">Ferror()</a>, <a class="el" href="rpmio_8c-source.html#l03184">Fopen()</a>, <a class="el" href="signature_8h-source.html#l00025">PGP_2</a>, <a class="el" href="signature_8h-source.html#l00026">PGP_5</a>, <a class="el" href="signature_8h-source.html#l00023">PGP_NOTDETECTED</a>, <a class="el" href="signature_8h-source.html#l00024">PGP_UNKNOWN</a>, <a class="el" href="rpmpgp_8c-source.html#l01056">pgpFreeDig()</a>, <a class="el" href="rpmpgp_8c-source.html#l01014">pgpNewDig()</a>, <a class="el" href="rpmpgp_8c-source.html#l01109">pgpPrtPkts()</a>, <a class="el" href="signature_8c-source.html#l00073">rpmDetectPGPVersion()</a>, <a class="el" href="rpmerr_8h-source.html#l00091">RPMERR_EXEC</a>, <a class="el" href="rpmerr_8h-source.html#l00128">RPMERR_SIGGEN</a>, <a class="el" href="rpmerr_8h-source.html#l00143">rpmError</a>, <a class="el" href="macro_8c-source.html#l02116">rpmExpand()</a>, <a class="el" href="rpmmessages_8h-source.html#l00011">RPMMESS_DEBUG</a>, <a class="el" href="rpmmessages_8h-source.html#l00020">rpmMessage</a>, <a class="el" href="rpmio__internal_8h-source.html#l00067">pgpDig_s::signature</a>, <a class="el" href="system_8h.html#58841684f76853b313e27e663c850381">stpcpy()</a>, <a class="el" href="file_8h-source.html#l00323">strerror</a>, <a class="el" href="rpmio_8h-source.html#l00640">timedRead</a>, <a class="el" href="system_8h.html#440dcd7dd71b4d668d8b9112643b9e0a">unsetenv()</a>, and <a class="el" href="rpmmalloc_8c-source.html#l00024">xmalloc()</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l00697">makeHDRSignature()</a>, and <a class="el" href="signature_8c-source.html#l00801">rpmAddSignature()</a>.
</div>
</div><p>
<a class="anchor" name="4461bea31fe1f7c1aca90fef44512708"></a><!-- doxytag: member="signature.c::nibble" ref="4461bea31fe1f7c1aca90fef44512708" args="(char c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned char nibble           </td>
          <td>(</td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>c</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convert hex to binary nibble. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>hex character </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>binary nibble </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l01185">1185</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
</div>
</div><p>
<a class="anchor" name="a543ed1b84c2c350f70e04b07f143cdc"></a><!-- doxytag: member="signature.c::printSize" ref="a543ed1b84c2c350f70e04b07f143cdc" args="(FD_t fd, int siglen, int pad, int datalen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> printSize           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__FD__s.html">FD_t</a>&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>siglen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>datalen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Print package size. 
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000082">Todo:</a></b></dt><dd>rpmio: use fdSize rather than fstat(2) to get file size. </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>package file handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>siglen</em>&nbsp;</td><td>signature header size </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pad</em>&nbsp;</td><td>signature padding </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>datalen</em>&nbsp;</td><td>length of header+payload </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>rpmRC return code </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00122">122</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmio_8c-source.html#l03316">Fileno()</a>, <a class="el" href="rpmmessages_8h-source.html#l00011">RPMMESS_DEBUG</a>, <a class="el" href="rpmmessages_8h-source.html#l00020">rpmMessage</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, and <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l00155">rpmReadSignature()</a>.
</div>
</div><p>
<a class="anchor" name="a70cb7eb4b26a664efb7a95d503d22e8"></a><!-- doxytag: member="signature.c::rpmSigString" ref="a70cb7eb4b26a664efb7a95d503d22e8" args="(rpmRC res)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static const char* rpmSigString           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td>
          <td class="paramname"> <em>res</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l01018">1018</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00025">RPMRC_NOKEY</a>, <a class="el" href="rpmlib_8h-source.html#l00022">RPMRC_NOTFOUND</a>, <a class="el" href="rpmlib_8h-source.html#l00024">RPMRC_NOTTRUSTED</a>, and <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l01390">verifyDSASignature()</a>, <a class="el" href="signature_8c-source.html#l01072">verifyMD5Signature()</a>, <a class="el" href="signature_8c-source.html#l01206">verifyRSASignature()</a>, <a class="el" href="signature_8c-source.html#l01131">verifySHA1Signature()</a>, and <a class="el" href="signature_8c-source.html#l01035">verifySizeSignature()</a>.
</div>
</div><p>
<a class="anchor" name="876ecccbaf4494a313f5ff55bba47ce8"></a><!-- doxytag: member="signature.c::verifyDSASignature" ref="876ecccbaf4494a313f5ff55bba47ce8" args="(rpmts ts, char *t, DIGEST_CTX sha1ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> verifyDSASignature           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDIGEST__CTX__s.html">DIGEST_CTX</a>&nbsp;</td>
          <td class="paramname"> <em>sha1ctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Verify DSA signature. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ts</em>&nbsp;</td><td>transaction set </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>t</em>&nbsp;</td><td>verbose success/failure text </td></tr>
  </table>
</dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sha1ctx</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>RPMRC_OK on success </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l01390">1390</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmsw_8h-source.html#l00035">rpmop_s::count</a>, <a class="el" href="rpmio__internal_8h-source.html#l00091">pgpDig_s::g</a>, <a class="el" href="rpmio__internal_8h-source.html#l00044">pgpDigParams_s::hash</a>, <a class="el" href="rpmio__internal_8h-source.html#l00052">pgpDigParams_s::hash_algo</a>, <a class="el" href="rpmio__internal_8h-source.html#l00054">pgpDigParams_s::hashlen</a>, <a class="el" href="rpmio__internal_8h-source.html#l00075">pgpDig_s::hdrsha1ctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00093">pgpDig_s::hm</a>, <a class="el" href="rpmio__internal_8h-source.html#l00089">pgpDig_s::p</a>, <a class="el" href="rpmpgp_8h-source.html#l00286">PGPHASHALGO_SHA1</a>, <a class="el" href="rpmpgp_8h-source.html#l01064">pgpHexCvt()</a>, <a class="el" href="rpmpgp_8h-source.html#l00173">PGPPUBKEYALGO_DSA</a>, <a class="el" href="rpmio__internal_8h-source.html#l00050">pgpDigParams_s::pubkey_algo</a>, <a class="el" href="rpmio__internal_8h-source.html#l00090">pgpDig_s::q</a>, <a class="el" href="rpmio__internal_8h-source.html#l00094">pgpDig_s::r</a>, <a class="el" href="digest_8c-source.html#l00036">rpmDigestDup()</a>, <a class="el" href="digest_8c-source.html#l00155">rpmDigestFinal()</a>, <a class="el" href="digest_8c-source.html#l00141">rpmDigestUpdate()</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00025">RPMRC_NOKEY</a>, <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>, <a class="el" href="signature_8c-source.html#l01018">rpmSigString()</a>, <a class="el" href="rpmlib_8h-source.html#l01218">RPMSIGTAG_DSA</a>, <a class="el" href="rpmlib_8h-source.html#l01212">RPMSIGTAG_GPG</a>, <a class="el" href="rpmsw_8c-source.html#l00241">rpmswEnter()</a>, <a class="el" href="rpmsw_8c-source.html#l00257">rpmswExit()</a>, <a class="el" href="rpmts_8h-source.html#l00089">RPMTS_OP_DIGEST</a>, <a class="el" href="rpmts_8h-source.html#l00090">RPMTS_OP_SIGNATURE</a>, <a class="el" href="rpmts_8c-source.html#l01171">rpmtsDig()</a>, <a class="el" href="rpmts_8c-source.html#l00338">rpmtsFindPubkey()</a>, <a class="el" href="rpmts_8c-source.html#l01483">rpmtsOp()</a>, <a class="el" href="rpmts_8c-source.html#l01139">rpmtsSig()</a>, <a class="el" href="rpmts_8c-source.html#l01147">rpmtsSiglen()</a>, <a class="el" href="rpmts_8c-source.html#l01182">rpmtsSignature()</a>, <a class="el" href="rpmts_8c-source.html#l01123">rpmtsSigtag()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00095">pgpDig_s::s</a>, <a class="el" href="rpmio__internal_8h-source.html#l00077">pgpDig_s::sha1</a>, <a class="el" href="rpmio__internal_8h-source.html#l00078">pgpDig_s::sha1len</a>, <a class="el" href="rpmio__internal_8h-source.html#l00055">pgpDigParams_s::signhash16</a>, <a class="el" href="rpmio__internal_8h-source.html#l00056">pgpDigParams_s::signid</a>, <a class="el" href="system_8h.html#58841684f76853b313e27e663c850381">stpcpy()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00048">pgpDigParams_s::version</a>, and <a class="el" href="rpmio__internal_8h-source.html#l00092">pgpDig_s::y</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l01486">rpmVerifySignature()</a>.
</div>
</div><p>
<a class="anchor" name="0eb78e9fdc549b1cb926b355f2b3fa35"></a><!-- doxytag: member="signature.c::verifyMD5Signature" ref="0eb78e9fdc549b1cb926b355f2b3fa35" args="(const rpmts ts, char *t, DIGEST_CTX md5ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> verifyMD5Signature           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDIGEST__CTX__s.html">DIGEST_CTX</a>&nbsp;</td>
          <td class="paramname"> <em>md5ctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l01072">1072</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="rpmsw_8h-source.html#l00035">rpmop_s::count</a>, <a class="el" href="rpmpgp_8h-source.html#l01064">pgpHexCvt()</a>, <a class="el" href="digest_8c-source.html#l00036">rpmDigestDup()</a>, <a class="el" href="digest_8c-source.html#l00155">rpmDigestFinal()</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00025">RPMRC_NOKEY</a>, <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>, <a class="el" href="signature_8c-source.html#l01018">rpmSigString()</a>, <a class="el" href="rpmsw_8c-source.html#l00241">rpmswEnter()</a>, <a class="el" href="rpmsw_8c-source.html#l00257">rpmswExit()</a>, <a class="el" href="rpmts_8h-source.html#l00089">RPMTS_OP_DIGEST</a>, <a class="el" href="rpmts_8c-source.html#l01171">rpmtsDig()</a>, <a class="el" href="rpmts_8c-source.html#l01483">rpmtsOp()</a>, <a class="el" href="rpmts_8c-source.html#l01139">rpmtsSig()</a>, <a class="el" href="rpmts_8c-source.html#l01147">rpmtsSiglen()</a>, and <a class="el" href="system_8h.html#58841684f76853b313e27e663c850381">stpcpy()</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l01486">rpmVerifySignature()</a>.
</div>
</div><p>
<a class="anchor" name="9f56af77b5e4c2ccb87e0b31f36dc0eb"></a><!-- doxytag: member="signature.c::verifyRSASignature" ref="9f56af77b5e4c2ccb87e0b31f36dc0eb" args="(rpmts ts, char *t, DIGEST_CTX md5ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> verifyRSASignature           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDIGEST__CTX__s.html">DIGEST_CTX</a>&nbsp;</td>
          <td class="paramname"> <em>md5ctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Verify RSA signature. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ts</em>&nbsp;</td><td>transaction set </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>t</em>&nbsp;</td><td>verbose success/failure text </td></tr>
  </table>
</dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>md5ctx</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>RPMRC_OK on success </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l01206">1206</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00100">pgpDig_s::c</a>, <a class="el" href="rpmsw_8h-source.html#l00035">rpmop_s::count</a>, <a class="el" href="rpmio__internal_8h-source.html#l00044">pgpDigParams_s::hash</a>, <a class="el" href="rpmio__internal_8h-source.html#l00052">pgpDigParams_s::hash_algo</a>, <a class="el" href="rpmio__internal_8h-source.html#l00054">pgpDigParams_s::hashlen</a>, <a class="el" href="rpmio__internal_8h-source.html#l00083">pgpDig_s::hdrmd5ctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00085">pgpDig_s::md5</a>, <a class="el" href="rpmio__internal_8h-source.html#l00086">pgpDig_s::md5len</a>, <a class="el" href="rpmio__internal_8h-source.html#l00070">pgpDig_s::nbytes</a>, <a class="el" href="query_8c-source.html#l00423">nibble()</a>, <a class="el" href="rpmpgp_8h-source.html#l00290">PGPHASHALGO_HAVAL_5_160</a>, <a class="el" href="rpmpgp_8h-source.html#l00288">PGPHASHALGO_MD2</a>, <a class="el" href="rpmpgp_8h-source.html#l00285">PGPHASHALGO_MD5</a>, <a class="el" href="rpmpgp_8h-source.html#l00287">PGPHASHALGO_RIPEMD160</a>, <a class="el" href="rpmpgp_8h-source.html#l00286">PGPHASHALGO_SHA1</a>, <a class="el" href="rpmpgp_8h-source.html#l00291">PGPHASHALGO_SHA256</a>, <a class="el" href="rpmpgp_8h-source.html#l00292">PGPHASHALGO_SHA384</a>, <a class="el" href="rpmpgp_8h-source.html#l00293">PGPHASHALGO_SHA512</a>, <a class="el" href="rpmpgp_8h-source.html#l00289">PGPHASHALGO_TIGER192</a>, <a class="el" href="rpmpgp_8h-source.html#l01064">pgpHexCvt()</a>, <a class="el" href="rpmpgp_8h-source.html#l00169">PGPPUBKEYALGO_RSA</a>, <a class="el" href="rpmpgp_8h-source.html#l00119">PGPSIGTYPE_BINARY</a>, <a class="el" href="rpmio__internal_8h-source.html#l00050">pgpDigParams_s::pubkey_algo</a>, <a class="el" href="digest_8c-source.html#l00036">rpmDigestDup()</a>, <a class="el" href="digest_8c-source.html#l00155">rpmDigestFinal()</a>, <a class="el" href="digest_8c-source.html#l00141">rpmDigestUpdate()</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00025">RPMRC_NOKEY</a>, <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>, <a class="el" href="signature_8c-source.html#l01018">rpmSigString()</a>, <a class="el" href="rpmlib_8h-source.html#l01209">RPMSIGTAG_PGP</a>, <a class="el" href="rpmlib_8h-source.html#l01213">RPMSIGTAG_PGP5</a>, <a class="el" href="rpmlib_8h-source.html#l01219">RPMSIGTAG_RSA</a>, <a class="el" href="rpmsw_8c-source.html#l00241">rpmswEnter()</a>, <a class="el" href="rpmsw_8c-source.html#l00257">rpmswExit()</a>, <a class="el" href="rpmts_8h-source.html#l00089">RPMTS_OP_DIGEST</a>, <a class="el" href="rpmts_8h-source.html#l00090">RPMTS_OP_SIGNATURE</a>, <a class="el" href="rpmts_8c-source.html#l01171">rpmtsDig()</a>, <a class="el" href="rpmts_8c-source.html#l00338">rpmtsFindPubkey()</a>, <a class="el" href="rpmts_8c-source.html#l01483">rpmtsOp()</a>, <a class="el" href="rpmts_8c-source.html#l01139">rpmtsSig()</a>, <a class="el" href="rpmts_8c-source.html#l01147">rpmtsSiglen()</a>, <a class="el" href="rpmts_8c-source.html#l01182">rpmtsSignature()</a>, <a class="el" href="rpmts_8c-source.html#l01123">rpmtsSigtag()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00098">pgpDig_s::rsa_pk</a>, <a class="el" href="rpmio__internal_8h-source.html#l00101">pgpDig_s::rsahm</a>, <a class="el" href="rpmio__internal_8h-source.html#l00055">pgpDigParams_s::signhash16</a>, <a class="el" href="rpmio__internal_8h-source.html#l00056">pgpDigParams_s::signid</a>, <a class="el" href="rpmio__internal_8h-source.html#l00053">pgpDigParams_s::sigtype</a>, <a class="el" href="system_8h.html#58841684f76853b313e27e663c850381">stpcpy()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00048">pgpDigParams_s::version</a>, and <a class="el" href="rpmmalloc_8c-source.html#l00024">xmalloc()</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l01486">rpmVerifySignature()</a>.
</div>
</div><p>
<a class="anchor" name="f38a8fe22ac77fe770ed2df5ab6f2675"></a><!-- doxytag: member="signature.c::verifySHA1Signature" ref="f38a8fe22ac77fe770ed2df5ab6f2675" args="(const rpmts ts, char *t, DIGEST_CTX sha1ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> verifySHA1Signature           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDIGEST__CTX__s.html">DIGEST_CTX</a>&nbsp;</td>
          <td class="paramname"> <em>sha1ctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Verify header immutable region SHA1 digest. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ts</em>&nbsp;</td><td>transaction set </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>t</em>&nbsp;</td><td>verbose success/failure text </td></tr>
  </table>
</dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sha1ctx</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>RPMRC_OK on success </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l01131">1131</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="digest_8c-source.html#l00036">rpmDigestDup()</a>, <a class="el" href="digest_8c-source.html#l00155">rpmDigestFinal()</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00025">RPMRC_NOKEY</a>, <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>, <a class="el" href="signature_8c-source.html#l01018">rpmSigString()</a>, <a class="el" href="rpmsw_8c-source.html#l00241">rpmswEnter()</a>, <a class="el" href="rpmsw_8c-source.html#l00257">rpmswExit()</a>, <a class="el" href="rpmts_8h-source.html#l00089">RPMTS_OP_DIGEST</a>, <a class="el" href="rpmts_8c-source.html#l01171">rpmtsDig()</a>, <a class="el" href="rpmts_8c-source.html#l01483">rpmtsOp()</a>, <a class="el" href="rpmts_8c-source.html#l01139">rpmtsSig()</a>, <a class="el" href="rpmts_8c-source.html#l01147">rpmtsSiglen()</a>, and <a class="el" href="system_8h.html#58841684f76853b313e27e663c850381">stpcpy()</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l01486">rpmVerifySignature()</a>.
</div>
</div><p>
<a class="anchor" name="c056ccfffae05c1eda0bf5194d7de997"></a><!-- doxytag: member="signature.c::verifySizeSignature" ref="c056ccfffae05c1eda0bf5194d7de997" args="(const rpmts ts, char *t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> verifySizeSignature           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>t</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l01035">1035</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmio__internal_8h-source.html#l00070">pgpDig_s::nbytes</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00025">RPMRC_NOKEY</a>, <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>, <a class="el" href="signature_8c-source.html#l01018">rpmSigString()</a>, <a class="el" href="rpmts_8c-source.html#l01171">rpmtsDig()</a>, <a class="el" href="rpmts_8c-source.html#l01139">rpmtsSig()</a>, and <a class="el" href="system_8h.html#58841684f76853b313e27e663c850381">stpcpy()</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l01486">rpmVerifySignature()</a>.
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="26d345f5cb95c9000b59e3add5fc5a94"></a><!-- doxytag: member="signature.c::environ" ref="26d345f5cb95c9000b59e3add5fc5a94" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char** <a class="el" href="signature_8c.html#26d345f5cb95c9000b59e3add5fc5a94">environ</a> = NULL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00030">30</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l00854">checkPassPhrase()</a>, <a class="el" href="rpmqv_8c-source.html#l00166">main()</a>, <a class="el" href="signature_8c-source.html#l00544">makeGPGSignature()</a>, <a class="el" href="signature_8c-source.html#l00395">makePGPSignature()</a>, <a class="el" href="legacy_8c-source.html#l00036">open_dso()</a>, <a class="el" href="rpmsq_8c-source.html#l00636">rpmsqExecve()</a>, and <a class="el" href="psm_8c-source.html#l00607">runScript()</a>.
</div>
</div><p>
<a class="anchor" name="739b796ffa0a2e9218383068dc83b215"></a><!-- doxytag: member="signature.c::header_magic" ref="739b796ffa0a2e9218383068dc83b215" args="[8]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char <a class="el" href="group__header.html#g739b796ffa0a2e9218383068dc83b215">header_magic</a>[8]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    0x8e, 0xad, 0xe8, 0x01, 0x00, 0x00, 0x00, 0x00
}
</pre></div>
<p>
Definition at line <a class="el" href="signature_8c-source.html#l00151">151</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Oct 12 08:44:55 2007 for rpm by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
