<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>rpm: rpmqv.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul>
</div>
<h1>rpmqv.c</h1><a href="rpmqv_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include "<a class="code" href="system_8h.html">system.h</a>"</span>
<a name="l00002"></a><a class="code" href="system_8h.html#bfe6ec379e0fe85b10ff6015bc0fdacc">00002</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>;
<a name="l00003"></a>00003 
<a name="l00004"></a><a class="code" href="rpmqv_8c.html#f0ab4eb2c5e6d0f95ea6c2a279d99b5a">00004</a> <span class="preprocessor">#define _AUTOHELP</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span>
<a name="l00006"></a>00006 <span class="preprocessor">#if defined(IAM_RPM) || defined(__LCLINT__)</span>
<a name="l00007"></a>00007 <span class="preprocessor"></span><span class="preprocessor">#define IAM_RPMBT</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define IAM_RPMDB</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor">#define IAM_RPMEIU</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span><span class="preprocessor">#define IAM_RPMQV</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span><span class="preprocessor">#define IAM_RPMK</span>
<a name="l00012"></a>00012 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;<a class="code" href="rpmcli_8h.html">rpmcli.h</a>&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;<a class="code" href="rpmbuild_8h.html" title="This is the *only* module users of librpmbuild should need to include.">rpmbuild.h</a>&gt;</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="preprocessor">#include "<a class="code" href="rpmdb_8h.html" title="Access RPM indices using Berkeley DB interface(s).">rpmdb.h</a>"</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include "<a class="code" href="rpmps_8h.html" title="Structures and prototypes used for an "rpmps" problem set.">rpmps.h</a>"</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include "<a class="code" href="rpmts_8h.html" title="Structures and prototypes used for an "rpmts" transaction set.">rpmts.h</a>"</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="preprocessor">#ifdef  IAM_RPMBT</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="build_8h.html">build.h</a>"</span>
<a name="l00023"></a>00023 <span class="preprocessor">#define GETOPT_REBUILD          1003</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#define GETOPT_RECOMPILE        1004</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>
<a name="l00027"></a>00027 <span class="preprocessor">#if defined(IAM_RPMBT) || defined(IAM_RPMK)</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="signature_8h.html" title="Generate and verify signatures.">signature.h</a>"</span>
<a name="l00029"></a>00029 <span class="preprocessor">#endif</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a>00031 <span class="preprocessor">#include "<a class="code" href="debug_8h.html">debug.h</a>"</span>
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0">00033</a> <span class="keyword">enum</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0">modes</a> {
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c04834b44c122dab4a87c0f6f944447471">00035</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c04834b44c122dab4a87c0f6f944447471">MODE_QUERY</a>          = (1 &lt;&lt;  0),
<a name="l00036"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c264959db5fabe4379fcc7b42f314032">00036</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c264959db5fabe4379fcc7b42f314032">MODE_VERIFY</a>         = (1 &lt;&lt;  3),
<a name="l00037"></a>00037 <span class="preprocessor">#define MODES_QV (MODE_QUERY | MODE_VERIFY)</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">00039</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a>        = (1 &lt;&lt;  1),
<a name="l00040"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">00040</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a>          = (1 &lt;&lt;  2),
<a name="l00041"></a>00041 <span class="preprocessor">#define MODES_IE (MODE_INSTALL | MODE_ERASE)</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span>
<a name="l00043"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">00043</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>          = (1 &lt;&lt;  4),
<a name="l00044"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0e938d5ca7fc880318726b0eae528ae63">00044</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0e938d5ca7fc880318726b0eae528ae63">MODE_REBUILD</a>        = (1 &lt;&lt;  5),
<a name="l00045"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0193e36b9bffdd15baa2f110a5eeb91e1">00045</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0193e36b9bffdd15baa2f110a5eeb91e1">MODE_RECOMPILE</a>      = (1 &lt;&lt;  8),
<a name="l00046"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c026d894aafd0cb8e82ec0be9115ee7a09">00046</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c026d894aafd0cb8e82ec0be9115ee7a09">MODE_TARBUILD</a>       = (1 &lt;&lt; 11),
<a name="l00047"></a>00047 <span class="preprocessor">#define MODES_BT (MODE_BUILD | MODE_TARBUILD | MODE_REBUILD | MODE_RECOMPILE)</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>
<a name="l00049"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0dfa7048d726620c69d7a31877ad52f01">00049</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0dfa7048d726620c69d7a31877ad52f01">MODE_CHECKSIG</a>       = (1 &lt;&lt;  6),
<a name="l00050"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c06db4cf60ae90c071555a082bf7428cc3">00050</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c06db4cf60ae90c071555a082bf7428cc3">MODE_RESIGN</a>         = (1 &lt;&lt;  7),
<a name="l00051"></a>00051 <span class="preprocessor">#define MODES_K  (MODE_CHECKSIG | MODE_RESIGN)</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span>
<a name="l00053"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0a0ff4d21dac86db4dc362ac08bf0f637">00053</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0a0ff4d21dac86db4dc362ac08bf0f637">MODE_INITDB</a>         = (1 &lt;&lt; 10),
<a name="l00054"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c03e9ff972b88d469f34274d5a47d0e4d5">00054</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c03e9ff972b88d469f34274d5a47d0e4d5">MODE_REBUILDDB</a>      = (1 &lt;&lt; 12),
<a name="l00055"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c042548dfaa5df6f4be39579f543e5797e">00055</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c042548dfaa5df6f4be39579f543e5797e">MODE_VERIFYDB</a>       = (1 &lt;&lt; 13),
<a name="l00056"></a>00056 #define MODES_DB (<a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0a0ff4d21dac86db4dc362ac08bf0f637">MODE_INITDB</a> | <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c03e9ff972b88d469f34274d5a47d0e4d5">MODE_REBUILDDB</a> | <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c042548dfaa5df6f4be39579f543e5797e">MODE_VERIFYDB</a>)
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">00059</a>     <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a>        = 0
<a name="l00060"></a>00060 };
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="rpmqv_8c.html#063638a9efc3dc6d90f51e592f5599d1">00062</a> <span class="preprocessor">#define MODES_FOR_DBPATH        (MODES_BT | MODES_IE | MODES_QV | MODES_DB)</span>
<a name="l00063"></a><a class="code" href="rpmqv_8c.html#ba43417bee535804ab6c64f5f93aae9f">00063</a> <span class="preprocessor"></span><span class="preprocessor">#define MODES_FOR_NODEPS        (MODES_BT | MODES_IE | MODE_VERIFY)</span>
<a name="l00064"></a><a class="code" href="rpmqv_8c.html#928e5e297b94cacb2450c3756d3e4370">00064</a> <span class="preprocessor"></span><span class="preprocessor">#define MODES_FOR_TEST          (MODES_BT | MODES_IE)</span>
<a name="l00065"></a><a class="code" href="rpmqv_8c.html#694075d156022e6fa1bde11dbe915b69">00065</a> <span class="preprocessor"></span><span class="preprocessor">#define MODES_FOR_ROOT          (MODES_BT | MODES_IE | MODES_QV | MODES_DB | MODES_K)</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00067"></a>00067 <span class="comment">/* the structure describing the options we take and the defaults */</span>
<a name="l00068"></a>00068 <span class="comment">/*@unchecked@*/</span>
<a name="l00069"></a><a class="code" href="rpmqv_8c.html#1205e54530fc93ecb48c40e2fe35c29d">00069</a> <span class="keyword">static</span> <span class="keyword">struct </span>poptOption optionsTable[] = {
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="preprocessor">#ifdef  IAM_RPMQV</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span> { NULL, <span class="charliteral">'\0'</span>, POPT_ARG_INCLUDE_TABLE, <a class="code" href="group__rpmcli.html#g1232398c577c9c98d2efb2076f5874f1" title="Query mode options.">rpmQueryPoptTable</a>, 0,
<a name="l00073"></a>00073         <a class="code" href="system_8h.html#cac8dc9c2554000001040435a0b0010d">N_</a>(<span class="stringliteral">"Query options (with -q or --query):"</span>),
<a name="l00074"></a>00074         NULL },
<a name="l00075"></a>00075  { NULL, <span class="charliteral">'\0'</span>, POPT_ARG_INCLUDE_TABLE, <a class="code" href="group__rpmcli.html#gf3298422a70c2c043dc1b99209136181" title="Verify mode options.">rpmVerifyPoptTable</a>, 0,
<a name="l00076"></a>00076         <a class="code" href="system_8h.html#cac8dc9c2554000001040435a0b0010d">N_</a>(<span class="stringliteral">"Verify options (with -V or --verify):"</span>),
<a name="l00077"></a>00077         NULL },
<a name="l00078"></a>00078 <span class="preprocessor">#ifdef  NOTYET</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span> { NULL, <span class="charliteral">'\0'</span>, POPT_ARG_INCLUDE_TABLE, rpmcliQVSourcePoptTable, 0,
<a name="l00080"></a>00080         <a class="code" href="system_8h.html#cac8dc9c2554000001040435a0b0010d">N_</a>(<span class="stringliteral">"Source options (with --query or --verify):"</span>),
<a name="l00081"></a>00081         NULL },
<a name="l00082"></a>00082 <span class="preprocessor">#endif</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span> { NULL, <span class="charliteral">'\0'</span>, POPT_ARG_INCLUDE_TABLE, <a class="code" href="poptALL_8c.html#a0dca5e7a058c79bfeb97973fc02d41f">rpmcliFtsPoptTable</a>, 0,
<a name="l00084"></a>00084         <a class="code" href="system_8h.html#cac8dc9c2554000001040435a0b0010d">N_</a>(<span class="stringliteral">"File tree walk options (with --ftswalk):"</span>),
<a name="l00085"></a>00085         NULL },
<a name="l00086"></a>00086 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMQV */</span>
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 <span class="preprocessor">#ifdef  IAM_RPMK</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span> { NULL, <span class="charliteral">'\0'</span>, POPT_ARG_INCLUDE_TABLE, <a class="code" href="group__rpmcli.html#gc332f0e4a1a77d6784784d591860c7da" title="Signature mode options.">rpmSignPoptTable</a>, 0,
<a name="l00090"></a>00090         <a class="code" href="system_8h.html#cac8dc9c2554000001040435a0b0010d">N_</a>(<span class="stringliteral">"Signature options:"</span>),
<a name="l00091"></a>00091         NULL },
<a name="l00092"></a>00092 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMK */</span>
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="preprocessor">#ifdef  IAM_RPMDB</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span> { NULL, <span class="charliteral">'\0'</span>, POPT_ARG_INCLUDE_TABLE, <a class="code" href="group__rpmcli.html#g2369de2d332a9a15bb569d440784cdc0">rpmDatabasePoptTable</a>, 0,
<a name="l00096"></a>00096         <a class="code" href="system_8h.html#cac8dc9c2554000001040435a0b0010d">N_</a>(<span class="stringliteral">"Database options:"</span>),
<a name="l00097"></a>00097         NULL },
<a name="l00098"></a>00098 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMDB */</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="preprocessor">#ifdef  IAM_RPMBT</span>
<a name="l00101"></a>00101 <span class="preprocessor"></span> { NULL, <span class="charliteral">'\0'</span>, POPT_ARG_INCLUDE_TABLE, <a class="code" href="group__rpmcli.html#ge6d7f2387a7d8e2f94b08b3cc6fbd74d">rpmBuildPoptTable</a>, 0,
<a name="l00102"></a>00102         <a class="code" href="system_8h.html#cac8dc9c2554000001040435a0b0010d">N_</a>(<span class="stringliteral">"Build options with [ &lt;specfile&gt; | &lt;tarball&gt; | &lt;source package&gt; ]:"</span>),
<a name="l00103"></a>00103         NULL },
<a name="l00104"></a>00104 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMBT */</span>
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="preprocessor">#ifdef  IAM_RPMEIU</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span> { NULL, <span class="charliteral">'\0'</span>, POPT_ARG_INCLUDE_TABLE, <a class="code" href="group__rpmcli.html#ga9a5bdf9356ca4855c0dafd791a2a860">rpmInstallPoptTable</a>, 0,
<a name="l00108"></a>00108         <a class="code" href="system_8h.html#cac8dc9c2554000001040435a0b0010d">N_</a>(<span class="stringliteral">"Install/Upgrade/Erase options:"</span>),
<a name="l00109"></a>00109         NULL },
<a name="l00110"></a>00110 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMEIU */</span>
<a name="l00111"></a>00111 
<a name="l00112"></a>00112  { NULL, <span class="charliteral">'\0'</span>, POPT_ARG_INCLUDE_TABLE, <a class="code" href="group__rpmcli.html#g132a54ddf32fb598fe2e5b70a22a270d" title="Popt option table for options shared by all modes and executables.">rpmcliAllPoptTable</a>, 0,
<a name="l00113"></a>00113         <a class="code" href="system_8h.html#cac8dc9c2554000001040435a0b0010d">N_</a>(<span class="stringliteral">"Common options for all rpm modes and executables:"</span>),
<a name="l00114"></a>00114         NULL },
<a name="l00115"></a>00115 
<a name="l00116"></a>00116    POPT_AUTOALIAS
<a name="l00117"></a>00117    POPT_AUTOHELP
<a name="l00118"></a>00118    POPT_TABLEEND
<a name="l00119"></a>00119 };
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="preprocessor">#ifdef __MINT__</span>
<a name="l00122"></a>00122 <span class="preprocessor"></span><span class="comment">/* MiNT cannot dynamically increase the stack.  */</span>
<a name="l00123"></a>00123 <span class="keywordtype">long</span> _stksize = 64 * 1024L;
<a name="l00124"></a>00124 <span class="preprocessor">#endif</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span>
<a name="l00126"></a><a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">00126</a> <span class="comment">/*@exits@*/</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * desc)
<a name="l00127"></a>00127         <span class="comment">/*@globals __assert_program_name, fileSystem @*/</span>
<a name="l00128"></a>00128         <span class="comment">/*@modifies fileSystem @*/</span>
<a name="l00129"></a>00129 {
<a name="l00130"></a>00130     fprintf(stderr, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"%s: %s\n"</span>), <a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, desc);
<a name="l00131"></a>00131     exit(<a class="code" href="system_8h.html#d851a8925c3675478e7dbb01d23a4dfa">EXIT_FAILURE</a>);
<a name="l00132"></a>00132 }
<a name="l00133"></a>00133 
<a name="l00134"></a><a class="code" href="rpmqv_8c.html#c12df4d10e9a90d2d036bd81171cc1fa">00134</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="rpmqv_8c.html#c12df4d10e9a90d2d036bd81171cc1fa">printVersion</a>(FILE * fp)
<a name="l00135"></a>00135         <span class="comment">/*@globals rpmEVR, fileSystem @*/</span>
<a name="l00136"></a>00136         <span class="comment">/*@modifies *fp, fileSystem @*/</span>
<a name="l00137"></a>00137 {
<a name="l00138"></a>00138     fprintf(fp, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"RPM version %s\n"</span>), <a class="code" href="depends_8c.html#216d09b20b67c12df42eb7df90067177">rpmEVR</a>);
<a name="l00139"></a>00139 }
<a name="l00140"></a>00140 
<a name="l00141"></a><a class="code" href="rpmqv_8c.html#3f59f39294aae5ee71bcd9bf00895437">00141</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="rpmqv_8c.html#3f59f39294aae5ee71bcd9bf00895437">printBanner</a>(FILE * fp)
<a name="l00142"></a>00142         <span class="comment">/*@globals fileSystem @*/</span>
<a name="l00143"></a>00143         <span class="comment">/*@modifies *fp, fileSystem @*/</span>
<a name="l00144"></a>00144 {
<a name="l00145"></a>00145     fprintf(fp, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"Copyright (C) 1998-2002 - Red Hat, Inc.\n"</span>));
<a name="l00146"></a>00146     fprintf(fp, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"This program may be freely redistributed under the terms of the GNU GPL\n"</span>));
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 
<a name="l00149"></a><a class="code" href="rpmqv_8c.html#ecdd450b2d6963761ab9eb5783650842">00149</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="rpmqv_8c.html#ecdd450b2d6963761ab9eb5783650842">printUsage</a>(poptContext con, FILE * fp, <span class="keywordtype">int</span> flags)
<a name="l00150"></a>00150         <span class="comment">/*@globals rpmEVR, fileSystem, internalState @*/</span>
<a name="l00151"></a>00151         <span class="comment">/*@modifies *fp, fileSystem, internalState @*/</span>
<a name="l00152"></a>00152 {
<a name="l00153"></a>00153     <a class="code" href="rpmqv_8c.html#c12df4d10e9a90d2d036bd81171cc1fa">printVersion</a>(fp);
<a name="l00154"></a>00154     <a class="code" href="rpmqv_8c.html#3f59f39294aae5ee71bcd9bf00895437">printBanner</a>(fp);
<a name="l00155"></a>00155     fprintf(fp, <span class="stringliteral">"\n"</span>);
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <span class="keywordflow">if</span> (<a class="code" href="rpmmessages_8h.html#27e9ca69465ed215147b0ec1a018a7fa">rpmIsVerbose</a>())
<a name="l00158"></a>00158         poptPrintHelp(con, fp, flags);
<a name="l00159"></a>00159     <span class="keywordflow">else</span>
<a name="l00160"></a>00160         poptPrintUsage(con, fp, flags);
<a name="l00161"></a>00161 }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="comment">/*@-bounds@*/</span> <span class="comment">/* LCL: segfault */</span>
<a name="l00164"></a>00164 <span class="comment">/*@-mods@*/</span> <span class="comment">/* FIX: shrug */</span>
<a name="l00165"></a>00165 <span class="preprocessor">#if !defined(__GLIBC__) &amp;&amp; !defined(__LCLINT__)</span>
<a name="l00166"></a><a class="code" href="rpmqv_8c.html#3d04ca28ed34f9e8632ffe35e03177b1">00166</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="rpmqv_8c.html#3d04ca28ed34f9e8632ffe35e03177b1">main</a>(<span class="keywordtype">int</span> argc, <span class="keyword">const</span> <span class="keywordtype">char</span> ** <a class="code" href="compress_8c.html#a06161d5bbbc977dc1ad9e6669902c5e">argv</a>, <span class="comment">/*@unused@*/</span> <span class="keywordtype">char</span> ** envp)
<a name="l00167"></a>00167 <span class="preprocessor">#else</span>
<a name="l00168"></a>00168 <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="rpmqv_8c.html#3d04ca28ed34f9e8632ffe35e03177b1">main</a>(<span class="keywordtype">int</span> argc, <span class="keyword">const</span> <span class="keywordtype">char</span> ** argv)
<a name="l00169"></a>00169 <span class="preprocessor">#endif</span>
<a name="l00170"></a>00170 <span class="preprocessor"></span>        <span class="comment">/*@globals __assert_program_name, rpmEVR, RPMVERSION,</span>
<a name="l00171"></a>00171 <span class="comment">                rpmGlobalMacroContext, rpmCLIMacroContext,</span>
<a name="l00172"></a>00172 <span class="comment">                h_errno, fileSystem, internalState@*/</span>
<a name="l00173"></a>00173         <span class="comment">/*@modifies __assert_program_name,</span>
<a name="l00174"></a>00174 <span class="comment">                fileSystem, internalState@*/</span>
<a name="l00175"></a>00175 {
<a name="l00176"></a>00176     <a class="code" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb" title="The RPM Transaction Set.">rpmts</a> ts = NULL;
<a name="l00177"></a>00177     <span class="keyword">enum</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0">modes</a> bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a>;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 <span class="preprocessor">#if defined(IAM_RPMQV)</span>
<a name="l00180"></a>00180 <span class="preprocessor"></span>    <a class="code" href="structrpmQVKArguments__s.html" title="Describe query/verify/signature command line operation.">QVA_t</a> qva = &amp;<a class="code" href="group__rpmcli.html#g0968737c82697019cc6b5e453a52dedc">rpmQVKArgs</a>;
<a name="l00181"></a>00181 <span class="preprocessor">#endif</span>
<a name="l00182"></a>00182 <span class="preprocessor"></span>
<a name="l00183"></a>00183 <span class="preprocessor">#ifdef  IAM_RPMBT</span>
<a name="l00184"></a>00184 <span class="preprocessor"></span>    <a class="code" href="structrpmBuildArguments__s.html" title="Describe build command line request.">BTA_t</a> ba = &amp;<a class="code" href="group__rpmcli.html#g19038337d0203b5f776dc608c5f07dcb">rpmBTArgs</a>;
<a name="l00185"></a>00185 <span class="preprocessor">#endif</span>
<a name="l00186"></a>00186 <span class="preprocessor"></span>
<a name="l00187"></a>00187 <span class="preprocessor">#ifdef  IAM_RPMEIU</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span>   <span class="keyword">struct </span><a class="code" href="structrpmInstallArguments__s.html" title="Describe database command line requests.">rpmInstallArguments_s</a> * ia = &amp;<a class="code" href="group__rpmcli.html#g992de0cda0d0bc73f54a32c1c094ca44">rpmIArgs</a>;
<a name="l00189"></a>00189 <span class="preprocessor">#endif</span>
<a name="l00190"></a>00190 <span class="preprocessor"></span>
<a name="l00191"></a>00191 <span class="preprocessor">#if defined(IAM_RPMDB)</span>
<a name="l00192"></a>00192 <span class="preprocessor"></span>   <span class="keyword">struct </span><a class="code" href="structrpmDatabaseArguments__s.html" title="Describe database command line requests.">rpmDatabaseArguments_s</a> * da = &amp;<a class="code" href="group__rpmcli.html#g57e2d6cd00698016f93b02c6ebca7a3e">rpmDBArgs</a>;
<a name="l00193"></a>00193 <span class="preprocessor">#endif</span>
<a name="l00194"></a>00194 <span class="preprocessor"></span>
<a name="l00195"></a>00195 <span class="preprocessor">#if defined(IAM_RPMK)</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span>   <a class="code" href="structrpmQVKArguments__s.html" title="Describe query/verify/signature command line operation.">QVA_t</a> ka = &amp;<a class="code" href="group__rpmcli.html#g0968737c82697019cc6b5e453a52dedc">rpmQVKArgs</a>;
<a name="l00197"></a>00197 <span class="preprocessor">#endif</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span>
<a name="l00199"></a>00199 <span class="preprocessor">#if defined(IAM_RPMBT) || defined(IAM_RPMK)</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span>    <span class="keywordtype">char</span> * passPhrase = <span class="stringliteral">""</span>;
<a name="l00201"></a>00201 <span class="preprocessor">#endif</span>
<a name="l00202"></a>00202 <span class="preprocessor"></span>
<a name="l00203"></a>00203     <span class="keywordtype">int</span> arg;
<a name="l00204"></a>00204 
<a name="l00205"></a>00205     <span class="keyword">const</span> <span class="keywordtype">char</span> * optArg;
<a name="l00206"></a>00206     pid_t pipeChild = 0;
<a name="l00207"></a>00207     poptContext optCon;
<a name="l00208"></a>00208     <span class="keywordtype">int</span> ec = 0;
<a name="l00209"></a>00209     <span class="keywordtype">int</span> status;
<a name="l00210"></a>00210     <span class="keywordtype">int</span> p[2];
<a name="l00211"></a>00211 <span class="preprocessor">#ifdef  IAM_RPMEIU</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span>    <span class="keywordtype">int</span> i;
<a name="l00213"></a>00213 <span class="preprocessor">#endif</span>
<a name="l00214"></a>00214 <span class="preprocessor"></span>        
<a name="l00215"></a>00215 <span class="preprocessor">#if HAVE_MCHECK_H &amp;&amp; HAVE_MTRACE</span>
<a name="l00216"></a>00216 <span class="preprocessor"></span>    <span class="comment">/*@-noeffect@*/</span>
<a name="l00217"></a>00217     mtrace();   <span class="comment">/* Trace malloc only if MALLOC_TRACE=mtrace-output-file. */</span>
<a name="l00218"></a>00218     <span class="comment">/*@=noeffect@*/</span>
<a name="l00219"></a>00219 <span class="preprocessor">#endif</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span>    <a class="code" href="system_8h.html#78a6646c789a8a902ecad3f9f4b34ff1">setprogname</a>(argv[0]);       <span class="comment">/* Retrofit glibc __progname */</span>
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 <span class="preprocessor">#if !defined(__GLIBC__) &amp;&amp; !defined(__LCLINT__)</span>
<a name="l00223"></a>00223 <span class="preprocessor"></span>    <a class="code" href="signature_8c.html#26d345f5cb95c9000b59e3add5fc5a94">environ</a> = envp;
<a name="l00224"></a>00224 <span class="preprocessor">#endif  </span>
<a name="l00225"></a>00225 <span class="preprocessor"></span>
<a name="l00226"></a>00226     <span class="comment">/* XXX glibc churn sanity */</span>
<a name="l00227"></a>00227     <span class="keywordflow">if</span> (<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a> == NULL) {
<a name="l00228"></a>00228         <span class="keywordflow">if</span> ((<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a> = strrchr(argv[0], <span class="charliteral">'/'</span>)) != NULL) <a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>++;
<a name="l00229"></a>00229         <span class="keywordflow">else</span> <a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a> = argv[0];
<a name="l00230"></a>00230     }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     <span class="comment">/* Set the major mode based on argv[0] */</span>
<a name="l00233"></a>00233     <span class="comment">/*@-nullpass@*/</span>
<a name="l00234"></a>00234 <span class="preprocessor">#ifdef  IAM_RPMBT</span>
<a name="l00235"></a>00235 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"rpmb"</span>))    bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>;
<a name="l00236"></a>00236     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"lt-rpmb"</span>)) bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>;
<a name="l00237"></a>00237     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"rpmt"</span>))    bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c026d894aafd0cb8e82ec0be9115ee7a09">MODE_TARBUILD</a>;
<a name="l00238"></a>00238     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"rpmbuild"</span>))        bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>;
<a name="l00239"></a>00239 <span class="preprocessor">#endif</span>
<a name="l00240"></a>00240 <span class="preprocessor"></span><span class="preprocessor">#ifdef  IAM_RPMQV</span>
<a name="l00241"></a>00241 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"rpmq"</span>))    bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c04834b44c122dab4a87c0f6f944447471">MODE_QUERY</a>;
<a name="l00242"></a>00242     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"lt-rpmq"</span>)) bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c04834b44c122dab4a87c0f6f944447471">MODE_QUERY</a>;
<a name="l00243"></a>00243     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"rpmv"</span>))    bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c264959db5fabe4379fcc7b42f314032">MODE_VERIFY</a>;
<a name="l00244"></a>00244     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"rpmquery"</span>))        bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c04834b44c122dab4a87c0f6f944447471">MODE_QUERY</a>;
<a name="l00245"></a>00245     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"rpmverify"</span>))       bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c264959db5fabe4379fcc7b42f314032">MODE_VERIFY</a>;
<a name="l00246"></a>00246 <span class="preprocessor">#endif</span>
<a name="l00247"></a>00247 <span class="preprocessor"></span><span class="preprocessor">#ifdef  RPMEIU</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"rpme"</span>))    bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a>;
<a name="l00249"></a>00249     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"rpmi"</span>))    bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a>;
<a name="l00250"></a>00250     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"lt-rpmi"</span>)) bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a>;
<a name="l00251"></a>00251     <span class="keywordflow">if</span> (!strcmp(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, <span class="stringliteral">"rpmu"</span>))    bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a>;
<a name="l00252"></a>00252 <span class="preprocessor">#endif</span>
<a name="l00253"></a>00253 <span class="preprocessor"></span>    <span class="comment">/*@=nullpass@*/</span>
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 <span class="preprocessor">#if defined(IAM_RPMQV)</span>
<a name="l00256"></a>00256 <span class="preprocessor"></span>    <span class="comment">/* Jumpstart option from argv[0] if necessary. */</span>
<a name="l00257"></a>00257     <span class="keywordflow">switch</span> (bigMode) {
<a name="l00258"></a>00258     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c04834b44c122dab4a87c0f6f944447471">MODE_QUERY</a>:    qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#15937691758ddae9ec77fa9446b29b30">qva_mode</a> = <span class="charliteral">'q'</span>;    <span class="keywordflow">break</span>;
<a name="l00259"></a>00259     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c264959db5fabe4379fcc7b42f314032">MODE_VERIFY</a>:   qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#15937691758ddae9ec77fa9446b29b30">qva_mode</a> = <span class="charliteral">'V'</span>;    <span class="keywordflow">break</span>;
<a name="l00260"></a>00260     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0dfa7048d726620c69d7a31877ad52f01">MODE_CHECKSIG</a>: qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#15937691758ddae9ec77fa9446b29b30">qva_mode</a> = <span class="charliteral">'K'</span>;    <span class="keywordflow">break</span>;
<a name="l00261"></a>00261     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c06db4cf60ae90c071555a082bf7428cc3">MODE_RESIGN</a>:   qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#15937691758ddae9ec77fa9446b29b30">qva_mode</a> = <span class="charliteral">'R'</span>;    <span class="keywordflow">break</span>;
<a name="l00262"></a>00262     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a>:
<a name="l00263"></a>00263     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a>:
<a name="l00264"></a>00264     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>:
<a name="l00265"></a>00265     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0e938d5ca7fc880318726b0eae528ae63">MODE_REBUILD</a>:
<a name="l00266"></a>00266     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0193e36b9bffdd15baa2f110a5eeb91e1">MODE_RECOMPILE</a>:
<a name="l00267"></a>00267     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c026d894aafd0cb8e82ec0be9115ee7a09">MODE_TARBUILD</a>:
<a name="l00268"></a>00268     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0a0ff4d21dac86db4dc362ac08bf0f637">MODE_INITDB</a>:
<a name="l00269"></a>00269     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c03e9ff972b88d469f34274d5a47d0e4d5">MODE_REBUILDDB</a>:
<a name="l00270"></a>00270     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c042548dfaa5df6f4be39579f543e5797e">MODE_VERIFYDB</a>:
<a name="l00271"></a>00271     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a>:
<a name="l00272"></a>00272     <span class="keywordflow">default</span>:
<a name="l00273"></a>00273         <span class="keywordflow">break</span>;
<a name="l00274"></a>00274     }
<a name="l00275"></a>00275 <span class="preprocessor">#endif</span>
<a name="l00276"></a>00276 <span class="preprocessor"></span>
<a name="l00277"></a>00277 <span class="preprocessor">#if defined(ENABLE_NLS)</span>
<a name="l00278"></a>00278 <span class="preprocessor"></span>    <span class="comment">/* set up the correct locale */</span>
<a name="l00279"></a>00279     (void) <a class="code" href="system_8h.html#a47f05250104fa292814ebe43195eaad">setlocale</a>(LC_ALL, <span class="stringliteral">""</span> );
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="preprocessor">#ifdef  __LCLINT__</span>
<a name="l00282"></a>00282 <span class="preprocessor"></span><span class="preprocessor">#define LOCALEDIR       "/usr/share/locale"</span>
<a name="l00283"></a>00283 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00284"></a>00284 <span class="preprocessor"></span>    <a class="code" href="system_8h.html#49158295fb1f28fd518de4ac881d5d3c">bindtextdomain</a>(<a class="code" href="config_8h.html#4ab8e2a5732119017d5f1ace10d9bf49">PACKAGE</a>, <a class="code" href="config_8h.html#303d8fa02c516d9a1386ea55d5627ad5">LOCALEDIR</a>);
<a name="l00285"></a>00285     <a class="code" href="system_8h.html#a8b1c17a71ab11aa2620555b22c0ccd2">textdomain</a>(<a class="code" href="config_8h.html#4ab8e2a5732119017d5f1ace10d9bf49">PACKAGE</a>);
<a name="l00286"></a>00286 <span class="preprocessor">#endif</span>
<a name="l00287"></a>00287 <span class="preprocessor"></span>
<a name="l00288"></a>00288     <a class="code" href="rpmmessages_8h.html#8d8b22b9914bfdd0667df17eed998b57">rpmSetVerbosity</a>(<a class="code" href="rpmmessages_8h.html#60521ccf51c65929828788d73762004f">RPMMESS_NORMAL</a>);    <span class="comment">/* XXX silly use by showrc */</span>
<a name="l00289"></a>00289 
<a name="l00290"></a>00290     <span class="comment">/* Make a first pass through the arguments, looking for --rcfile */</span>
<a name="l00291"></a>00291     <span class="comment">/* We need to handle that before dealing with the rest of the arguments. */</span>
<a name="l00292"></a>00292     <span class="comment">/*@-nullpass -temptrans@*/</span>
<a name="l00293"></a>00293     optCon = poptGetContext(<a class="code" href="system_8h.html#50180bf6cf9a16254855e00c82286804">__progname</a>, argc, argv, optionsTable, 0);
<a name="l00294"></a>00294     <span class="comment">/*@=nullpass =temptrans@*/</span>
<a name="l00295"></a>00295     (void) poptReadConfigFile(optCon, <a class="code" href="config_8h.html#5a4bef54a0ffe86154275f37c64b99f1">LIBRPMALIAS_FILENAME</a>);
<a name="l00296"></a>00296     (void) poptReadDefaultConfig(optCon, 1);
<a name="l00297"></a>00297     poptSetExecPath(optCon, <a class="code" href="config_8h.html#376fdbb987437b65df566c571f8de4d1">RPMCONFIGDIR</a>, 1);
<a name="l00298"></a>00298 
<a name="l00299"></a>00299     <span class="keywordflow">while</span> ((arg = poptGetNextOpt(optCon)) &gt; 0) {
<a name="l00300"></a>00300         optArg = poptGetOptArg(optCon);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302         <span class="keywordflow">switch</span> (arg) {
<a name="l00303"></a>00303         <span class="keywordflow">default</span>:
<a name="l00304"></a>00304             fprintf(stderr, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"Internal error in argument processing (%d) :-(\n"</span>), arg);
<a name="l00305"></a>00305             exit(<a class="code" href="system_8h.html#d851a8925c3675478e7dbb01d23a4dfa">EXIT_FAILURE</a>);
<a name="l00306"></a>00306         }
<a name="l00307"></a>00307     }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309     <span class="keywordflow">if</span> (arg &lt; -1) {
<a name="l00310"></a>00310         fprintf(stderr, <span class="stringliteral">"%s: %s\n"</span>, 
<a name="l00311"></a>00311                 poptBadOption(optCon, POPT_BADOPTION_NOALIAS), 
<a name="l00312"></a>00312                 poptStrerror(arg));
<a name="l00313"></a>00313         exit(<a class="code" href="system_8h.html#d851a8925c3675478e7dbb01d23a4dfa">EXIT_FAILURE</a>);
<a name="l00314"></a>00314     }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     <a class="code" href="poptALL_8c.html#fbff8c532c98dba81765dd5145b09554" title="Make sure that rpm configuration has been read.">rpmcliConfigured</a>();
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 <span class="preprocessor">#ifdef  IAM_RPMBT</span>
<a name="l00319"></a>00319 <span class="preprocessor"></span>    <span class="keywordflow">switch</span> (ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#0582d776874856ad4a7b5476f369dc0d">buildMode</a>) {
<a name="l00320"></a>00320     <span class="keywordflow">case</span> <span class="charliteral">'b'</span>:   bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>;           <span class="keywordflow">break</span>;
<a name="l00321"></a>00321     <span class="keywordflow">case</span> <span class="charliteral">'t'</span>:   bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c026d894aafd0cb8e82ec0be9115ee7a09">MODE_TARBUILD</a>;        <span class="keywordflow">break</span>;
<a name="l00322"></a>00322     <span class="keywordflow">case</span> <span class="charliteral">'B'</span>:   bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0e938d5ca7fc880318726b0eae528ae63">MODE_REBUILD</a>;         <span class="keywordflow">break</span>;
<a name="l00323"></a>00323     <span class="keywordflow">case</span> <span class="charliteral">'C'</span>:   bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0193e36b9bffdd15baa2f110a5eeb91e1">MODE_RECOMPILE</a>;       <span class="keywordflow">break</span>;
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326     <span class="keywordflow">if</span> ((ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> &amp; <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca0d3ef3c991e0ef076bc03271705baaed">RPMBUILD_RMSOURCE</a>) &amp;&amp; bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a>)
<a name="l00327"></a>00327         bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>;
<a name="l00328"></a>00328 
<a name="l00329"></a>00329     <span class="keywordflow">if</span> ((ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> &amp; <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654caa7a47327cf13c9266d3ff4b92eb5dc6f">RPMBUILD_RMSPEC</a>) &amp;&amp; bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a>)
<a name="l00330"></a>00330         bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>;
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <span class="keywordflow">if</span> (ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c32d450aedf4796356fe9acdf0f3666f">buildRootOverride</a> &amp;&amp; bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a> &amp;&amp;
<a name="l00333"></a>00333         bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0e938d5ca7fc880318726b0eae528ae63">MODE_REBUILD</a> &amp;&amp; bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c026d894aafd0cb8e82ec0be9115ee7a09">MODE_TARBUILD</a>) {
<a name="l00334"></a>00334         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<span class="stringliteral">"--buildroot may only be used during package builds"</span>);
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMBT */</span>
<a name="l00337"></a>00337     
<a name="l00338"></a>00338 <span class="preprocessor">#ifdef  IAM_RPMDB</span>
<a name="l00339"></a>00339 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a> || (bigMode &amp; <a class="code" href="rpmqv_8c.html#1dd03fd0de0b0ba11c89fa7915bf94f3">MODES_DB</a>)) {
<a name="l00340"></a>00340     <span class="keywordflow">if</span> (da-&gt;<a class="code" href="structrpmDatabaseArguments__s.html#107afa2f8e268ee9d04eff14bfaae794">init</a>) {
<a name="l00341"></a>00341         <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a>) 
<a name="l00342"></a>00342             <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"only one major mode may be specified"</span>));
<a name="l00343"></a>00343         <span class="keywordflow">else</span>
<a name="l00344"></a>00344             bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0a0ff4d21dac86db4dc362ac08bf0f637">MODE_INITDB</a>;
<a name="l00345"></a>00345     } <span class="keywordflow">else</span>
<a name="l00346"></a>00346     <span class="keywordflow">if</span> (da-&gt;<a class="code" href="structrpmDatabaseArguments__s.html#b2083bb42ba7defbdb61d8e4a423109d">rebuild</a>) {
<a name="l00347"></a>00347         <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a>) 
<a name="l00348"></a>00348             <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"only one major mode may be specified"</span>));
<a name="l00349"></a>00349         <span class="keywordflow">else</span>
<a name="l00350"></a>00350             bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c03e9ff972b88d469f34274d5a47d0e4d5">MODE_REBUILDDB</a>;
<a name="l00351"></a>00351     } <span class="keywordflow">else</span>
<a name="l00352"></a>00352     <span class="keywordflow">if</span> (da-&gt;<a class="code" href="structrpmDatabaseArguments__s.html#f3aeb0ad35ab8a452ee48df2e3bd290e">verify</a>) {
<a name="l00353"></a>00353         <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a>) 
<a name="l00354"></a>00354             <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"only one major mode may be specified"</span>));
<a name="l00355"></a>00355         <span class="keywordflow">else</span>
<a name="l00356"></a>00356             bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c042548dfaa5df6f4be39579f543e5797e">MODE_VERIFYDB</a>;
<a name="l00357"></a>00357     }
<a name="l00358"></a>00358   }
<a name="l00359"></a>00359 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMDB */</span>
<a name="l00360"></a>00360 
<a name="l00361"></a>00361 <span class="preprocessor">#ifdef  IAM_RPMQV</span>
<a name="l00362"></a>00362 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a> || (bigMode &amp; <a class="code" href="rpmqv_8c.html#2fd2e4ce50867696d519f47f4ada8377">MODES_QV</a>)) {
<a name="l00363"></a>00363     <span class="keywordflow">switch</span> (qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#15937691758ddae9ec77fa9446b29b30">qva_mode</a>) {
<a name="l00364"></a>00364     <span class="keywordflow">case</span> <span class="charliteral">'q'</span>:   bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c04834b44c122dab4a87c0f6f944447471">MODE_QUERY</a>;           <span class="keywordflow">break</span>;
<a name="l00365"></a>00365     <span class="keywordflow">case</span> <span class="charliteral">'V'</span>:   bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c264959db5fabe4379fcc7b42f314032">MODE_VERIFY</a>;          <span class="keywordflow">break</span>;
<a name="l00366"></a>00366     }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     <span class="keywordflow">if</span> (qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#5ccbc1afb35f726ca74b0958bef89e50">qva_sourceCount</a>) {
<a name="l00369"></a>00369         <span class="keywordflow">if</span> (qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#5ccbc1afb35f726ca74b0958bef89e50">qva_sourceCount</a> &gt; 2)
<a name="l00370"></a>00370             <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"one type of query/verify may be performed at a "</span>
<a name="l00371"></a>00371                         <span class="stringliteral">"time"</span>));
<a name="l00372"></a>00372     }
<a name="l00373"></a>00373     <span class="keywordflow">if</span> (qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#cc945d709a159ce1dec392ba52750ab4">qva_flags</a> &amp;&amp; (bigMode &amp; ~MODES_QV)) 
<a name="l00374"></a>00374         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"unexpected query flags"</span>));
<a name="l00375"></a>00375 
<a name="l00376"></a>00376     <span class="keywordflow">if</span> (qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#9ece4dae8020e323fc9af97bc338e84c">qva_queryFormat</a> &amp;&amp; (bigMode &amp; ~MODES_QV)) 
<a name="l00377"></a>00377         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"unexpected query format"</span>));
<a name="l00378"></a>00378 
<a name="l00379"></a>00379     <span class="keywordflow">if</span> (qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#c4fd364f8629abfac17c21a49823df7b">qva_source</a> != <a class="code" href="group__rpmcli.html#gg50b433b67698e600e9073de639900c9f3504aac42c8a0fe3907a06ac7732966b">RPMQV_PACKAGE</a> &amp;&amp; (bigMode &amp; ~MODES_QV)) 
<a name="l00380"></a>00380         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"unexpected query source"</span>));
<a name="l00381"></a>00381   }
<a name="l00382"></a>00382 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMQV */</span>
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 <span class="preprocessor">#ifdef  IAM_RPMEIU</span>
<a name="l00385"></a>00385 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a> || (bigMode &amp; <a class="code" href="rpmqv_8c.html#1d327cbe0466cf1ad0a2bee5740a5f5d">MODES_IE</a>))
<a name="l00386"></a>00386     {   <span class="keywordtype">int</span> iflags = (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#5be354892399a7b1794474fc77a0e025">installInterfaceFlags</a> &amp;
<a name="l00387"></a>00387                 (<a class="code" href="group__rpmcli.html#gg8dafaec14dcb60d8e1cf64c58255f0402620e6e6ce7493d72f54b881d70d334e">INSTALL_UPGRADE</a>|<a class="code" href="group__rpmcli.html#gg8dafaec14dcb60d8e1cf64c58255f040bff8e3389181c78efff8d59764084f17">INSTALL_FRESHEN</a>|<a class="code" href="group__rpmcli.html#gg8dafaec14dcb60d8e1cf64c58255f040c93f0840348ac44b4e51fff8026fc1e0">INSTALL_INSTALL</a>));
<a name="l00388"></a>00388         <span class="keywordtype">int</span> eflags = (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#5be354892399a7b1794474fc77a0e025">installInterfaceFlags</a> &amp; <a class="code" href="group__rpmcli.html#gg8dafaec14dcb60d8e1cf64c58255f040c6020bfb34cc4b36b7525c21ea11e49a">INSTALL_ERASE</a>);
<a name="l00389"></a>00389 
<a name="l00390"></a>00390         <span class="keywordflow">if</span> (iflags &amp; eflags)
<a name="l00391"></a>00391             <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"only one major mode may be specified"</span>));
<a name="l00392"></a>00392         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iflags)
<a name="l00393"></a>00393             bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a>;
<a name="l00394"></a>00394         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eflags)
<a name="l00395"></a>00395             bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a>;
<a name="l00396"></a>00396     }
<a name="l00397"></a>00397 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMEIU */</span>
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="preprocessor">#ifdef  IAM_RPMK</span>
<a name="l00400"></a>00400 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a> || (bigMode &amp; <a class="code" href="rpmqv_8c.html#5cd7e1eeb52105b14aa7fdfb68088773">MODES_K</a>)) {
<a name="l00401"></a>00401         <span class="keywordflow">switch</span> (ka-&gt;<a class="code" href="structrpmQVKArguments__s.html#15937691758ddae9ec77fa9446b29b30">qva_mode</a>) {
<a name="l00402"></a>00402         <span class="keywordflow">case</span> <a class="code" href="group__rpmcli.html#gg1ee94b4a4b4a6683c47859b42b07f92f51be76fe628fdbc3fa28d5ec4d295675">RPMSIGN_NONE</a>:
<a name="l00403"></a>00403             ka-&gt;<a class="code" href="structrpmQVKArguments__s.html#eb02305021d6fde0b210f31d62ed6bd5">sign</a> = 0;
<a name="l00404"></a>00404             <span class="keywordflow">break</span>;
<a name="l00405"></a>00405         <span class="keywordflow">case</span> <a class="code" href="group__rpmcli.html#gg1ee94b4a4b4a6683c47859b42b07f92f08389cd4e4cec4060987c0efce65697b">RPMSIGN_IMPORT_PUBKEY</a>:
<a name="l00406"></a>00406         <span class="keywordflow">case</span> <a class="code" href="group__rpmcli.html#gg1ee94b4a4b4a6683c47859b42b07f92f5afa9cd3d73c6b7e6b187269520a006c">RPMSIGN_CHK_SIGNATURE</a>:
<a name="l00407"></a>00407             bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0dfa7048d726620c69d7a31877ad52f01">MODE_CHECKSIG</a>;
<a name="l00408"></a>00408             ka-&gt;<a class="code" href="structrpmQVKArguments__s.html#eb02305021d6fde0b210f31d62ed6bd5">sign</a> = 0;
<a name="l00409"></a>00409             <span class="keywordflow">break</span>;
<a name="l00410"></a>00410         <span class="keywordflow">case</span> <a class="code" href="group__rpmcli.html#gg1ee94b4a4b4a6683c47859b42b07f92f184c037c0bd2910e611199a507db35de">RPMSIGN_ADD_SIGNATURE</a>:
<a name="l00411"></a>00411         <span class="keywordflow">case</span> <a class="code" href="group__rpmcli.html#gg1ee94b4a4b4a6683c47859b42b07f92ffc49b99ef3d62cd2f2e4243c68f89cbf">RPMSIGN_NEW_SIGNATURE</a>:
<a name="l00412"></a>00412         <span class="keywordflow">case</span> <a class="code" href="group__rpmcli.html#gg1ee94b4a4b4a6683c47859b42b07f92fb351b023ea5d5b7f911f85b8c4811db0">RPMSIGN_DEL_SIGNATURE</a>:
<a name="l00413"></a>00413             bigMode = <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c06db4cf60ae90c071555a082bf7428cc3">MODE_RESIGN</a>;
<a name="l00414"></a>00414             ka-&gt;<a class="code" href="structrpmQVKArguments__s.html#eb02305021d6fde0b210f31d62ed6bd5">sign</a> = (ka-&gt;<a class="code" href="structrpmQVKArguments__s.html#15937691758ddae9ec77fa9446b29b30">qva_mode</a> != <a class="code" href="group__rpmcli.html#gg1ee94b4a4b4a6683c47859b42b07f92fb351b023ea5d5b7f911f85b8c4811db0">RPMSIGN_DEL_SIGNATURE</a>);
<a name="l00415"></a>00415             <span class="keywordflow">break</span>;
<a name="l00416"></a>00416         }
<a name="l00417"></a>00417   }
<a name="l00418"></a>00418 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMK */</span>
<a name="l00419"></a>00419 
<a name="l00420"></a>00420 <span class="preprocessor">#if defined(IAM_RPMEIU)</span>
<a name="l00421"></a>00421 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (!( bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> ) &amp;&amp;
<a name="l00422"></a>00422 (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#1fdabe9fda6bc8cdaeaf077fdbb4d4f7">probFilter</a> &amp; (<a class="code" href="rpmlib_8h.html#bb6103eff013f34a8fa2f11377227993778dd1e0c786a1d6afc39600b49d0e79">RPMPROB_FILTER_REPLACEPKG</a> | <a class="code" href="rpmlib_8h.html#bb6103eff013f34a8fa2f11377227993129ce141be9ae0a0a861524a853a9ec2">RPMPROB_FILTER_OLDPACKAGE</a>)))
<a name="l00423"></a>00423         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"only installation, upgrading, rmsource and rmspec may be forced"</span>));
<a name="l00424"></a>00424     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#1fdabe9fda6bc8cdaeaf077fdbb4d4f7">probFilter</a> &amp; <a class="code" href="rpmlib_8h.html#bb6103eff013f34a8fa2f11377227993608cb5c2b78fe7902f974a328fb01b63">RPMPROB_FILTER_FORCERELOCATE</a>))
<a name="l00425"></a>00425         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"files may only be relocated during package installation"</span>));
<a name="l00426"></a>00426 
<a name="l00427"></a>00427     <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a> &amp;&amp; ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#0cd1482df0b9dfec04c05c9aa53f146e">prefix</a>)
<a name="l00428"></a>00428         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"cannot use --prefix with --relocate or --excludepath"</span>));
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>)
<a name="l00431"></a>00431         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--relocate and --excludepath may only be used when installing new packages"</span>));
<a name="l00432"></a>00432 
<a name="l00433"></a>00433     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#0cd1482df0b9dfec04c05c9aa53f146e">prefix</a>)
<a name="l00434"></a>00434         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--prefix may only be used when installing new packages"</span>));
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#0cd1482df0b9dfec04c05c9aa53f146e">prefix</a> &amp;&amp; ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#0cd1482df0b9dfec04c05c9aa53f146e">prefix</a>[0] != <span class="charliteral">'/'</span>) 
<a name="l00437"></a>00437         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"arguments to --prefix must begin with a /"</span>));
<a name="l00438"></a>00438 
<a name="l00439"></a>00439     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#5be354892399a7b1794474fc77a0e025">installInterfaceFlags</a> &amp; <a class="code" href="group__rpmcli.html#gg8dafaec14dcb60d8e1cf64c58255f040bd4514732b7375f1895a327cb150f303">INSTALL_HASH</a>))
<a name="l00440"></a>00440         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--hash (-h) may only be specified during package "</span>
<a name="l00441"></a>00441                         <span class="stringliteral">"installation"</span>));
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#5be354892399a7b1794474fc77a0e025">installInterfaceFlags</a> &amp; <a class="code" href="group__rpmcli.html#gg8dafaec14dcb60d8e1cf64c58255f0409e5454d2285f5a3fad6962f9930ce178">INSTALL_PERCENT</a>))
<a name="l00444"></a>00444         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--percent may only be specified during package "</span>
<a name="l00445"></a>00445                         <span class="stringliteral">"installation"</span>));
<a name="l00446"></a>00446 
<a name="l00447"></a>00447     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#1fdabe9fda6bc8cdaeaf077fdbb4d4f7">probFilter</a> &amp; <a class="code" href="rpmlib_8h.html#bb6103eff013f34a8fa2f11377227993778dd1e0c786a1d6afc39600b49d0e79">RPMPROB_FILTER_REPLACEPKG</a>))
<a name="l00448"></a>00448         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--replacepkgs may only be specified during package "</span>
<a name="l00449"></a>00449                         <span class="stringliteral">"installation"</span>));
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> &amp; <a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2ef720f21009132b5d930e2de934fd87827">RPMTRANS_FLAG_NODOCS</a>))
<a name="l00452"></a>00452         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--excludedocs may only be specified during package "</span>
<a name="l00453"></a>00453                    <span class="stringliteral">"installation"</span>));
<a name="l00454"></a>00454 
<a name="l00455"></a>00455     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#42a3055a970f4e384e7697e2fa3e9102">incldocs</a>)
<a name="l00456"></a>00456         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--includedocs may only be specified during package "</span>
<a name="l00457"></a>00457                    <span class="stringliteral">"installation"</span>));
<a name="l00458"></a>00458 
<a name="l00459"></a>00459     <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#42a3055a970f4e384e7697e2fa3e9102">incldocs</a> &amp;&amp; (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> &amp; <a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2ef720f21009132b5d930e2de934fd87827">RPMTRANS_FLAG_NODOCS</a>))
<a name="l00460"></a>00460         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"only one of --excludedocs and --includedocs may be "</span>
<a name="l00461"></a>00461                  <span class="stringliteral">"specified"</span>));
<a name="l00462"></a>00462   
<a name="l00463"></a>00463     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#1fdabe9fda6bc8cdaeaf077fdbb4d4f7">probFilter</a> &amp; <a class="code" href="rpmlib_8h.html#bb6103eff013f34a8fa2f11377227993b82bc5dcd5f2df52d5f717c6a35bb23d">RPMPROB_FILTER_IGNOREARCH</a>))
<a name="l00464"></a>00464         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--ignorearch may only be specified during package "</span>
<a name="l00465"></a>00465                    <span class="stringliteral">"installation"</span>));
<a name="l00466"></a>00466 
<a name="l00467"></a>00467     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#1fdabe9fda6bc8cdaeaf077fdbb4d4f7">probFilter</a> &amp; <a class="code" href="rpmlib_8h.html#bb6103eff013f34a8fa2f11377227993a54976b2c31db62dcbcdc0965c4c6312">RPMPROB_FILTER_IGNOREOS</a>))
<a name="l00468"></a>00468         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--ignoreos may only be specified during package "</span>
<a name="l00469"></a>00469                    <span class="stringliteral">"installation"</span>));
<a name="l00470"></a>00470 
<a name="l00471"></a>00471     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a> &amp;&amp;
<a name="l00472"></a>00472         (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#1fdabe9fda6bc8cdaeaf077fdbb4d4f7">probFilter</a> &amp; (<a class="code" href="rpmlib_8h.html#bb6103eff013f34a8fa2f1137722799370396502b125e9bc3dd1d7a9cd874fa3">RPMPROB_FILTER_DISKSPACE</a>|<a class="code" href="rpmlib_8h.html#bb6103eff013f34a8fa2f11377227993a250128d752a2d5d18c0379b9f6fef05">RPMPROB_FILTER_DISKNODES</a>)))
<a name="l00473"></a>00473         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--ignoresize may only be specified during package "</span>
<a name="l00474"></a>00474                    <span class="stringliteral">"installation"</span>));
<a name="l00475"></a>00475 
<a name="l00476"></a>00476     <span class="keywordflow">if</span> ((ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#8f8fcc9b9ce508237f8b4fcc0db5a69c">eraseInterfaceFlags</a> &amp; <a class="code" href="group__rpmcli.html#gg711126b7038f407fdccf3928129ffe1f95a4b30e90ffee7458b3e86de5a22077">UNINSTALL_ALLMATCHES</a>) &amp;&amp; bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a>)
<a name="l00477"></a>00477         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--allmatches may only be specified during package "</span>
<a name="l00478"></a>00478                    <span class="stringliteral">"erasure"</span>));
<a name="l00479"></a>00479 
<a name="l00480"></a>00480     <span class="keywordflow">if</span> ((ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> &amp; <a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2ef3a8ca714d0ea4ab071d5546590b18c3d">RPMTRANS_FLAG_ALLFILES</a>) &amp;&amp; bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a>)
<a name="l00481"></a>00481         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--allfiles may only be specified during package "</span>
<a name="l00482"></a>00482                    <span class="stringliteral">"installation"</span>));
<a name="l00483"></a>00483 
<a name="l00484"></a>00484     <span class="keywordflow">if</span> ((ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> &amp; <a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2efd663fb501d4b54058f704c76cd8a48f1">RPMTRANS_FLAG_JUSTDB</a>) &amp;&amp;
<a name="l00485"></a>00485         bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a>)
<a name="l00486"></a>00486         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--justdb may only be specified during package "</span>
<a name="l00487"></a>00487                    <span class="stringliteral">"installation and erasure"</span>));
<a name="l00488"></a>00488 
<a name="l00489"></a>00489     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a> &amp;&amp;
<a name="l00490"></a>00490         (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> &amp; (<a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2ef1b2c7668caafc57e64a1e25735d75a11">RPMTRANS_FLAG_NOSCRIPTS</a> | <a class="code" href="rpmlib_8h.html#d1e32016045b2e6018dc681ff054edbe">_noTransScripts</a> | <a class="code" href="rpmlib_8h.html#d32a741d6b36990974245748ff5252c4">_noTransTriggers</a>)))
<a name="l00491"></a>00491         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"script disabling options may only be specified during "</span>
<a name="l00492"></a>00492                    <span class="stringliteral">"package installation and erasure"</span>));
<a name="l00493"></a>00493 
<a name="l00494"></a>00494     <span class="keywordflow">if</span> (bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a> &amp;&amp; bigMode != <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a> &amp;&amp;
<a name="l00495"></a>00495         (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> &amp; (<a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2ef5388ce6f16a1b47ec5b4de483d9563c4">RPMTRANS_FLAG_NOTRIGGERS</a> | <a class="code" href="rpmlib_8h.html#d32a741d6b36990974245748ff5252c4">_noTransTriggers</a>)))
<a name="l00496"></a>00496         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"trigger disabling options may only be specified during "</span>
<a name="l00497"></a>00497                    <span class="stringliteral">"package installation and erasure"</span>));
<a name="l00498"></a>00498 
<a name="l00499"></a>00499     <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#d28ea7e3a29ca777408fec02627e66cc">noDeps</a> &amp; (bigMode &amp; ~<a class="code" href="rpmqv_8c.html#ba43417bee535804ab6c64f5f93aae9f">MODES_FOR_NODEPS</a>))
<a name="l00500"></a>00500         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--nodeps may only be specified during package "</span>
<a name="l00501"></a>00501                    <span class="stringliteral">"building, rebuilding, recompilation, installation,"</span>
<a name="l00502"></a>00502                    <span class="stringliteral">"erasure, and verification"</span>));
<a name="l00503"></a>00503 
<a name="l00504"></a>00504     <span class="keywordflow">if</span> ((ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> &amp; <a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2efa9bb9b18c2c6c8fef92cf0c826e377c0">RPMTRANS_FLAG_TEST</a>) &amp;&amp; (bigMode &amp; ~<a class="code" href="rpmqv_8c.html#928e5e297b94cacb2450c3756d3e4370">MODES_FOR_TEST</a>))
<a name="l00505"></a>00505         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--test may only be specified during package installation, "</span>
<a name="l00506"></a>00506                  <span class="stringliteral">"erasure, and building"</span>));
<a name="l00507"></a>00507 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMEIU */</span>
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="keywordflow">if</span> (<a class="code" href="poptALL_8c.html#82a451d728a0042adf1a10f8d0d3877f">rpmcliRootDir</a> &amp;&amp; <a class="code" href="poptALL_8c.html#82a451d728a0042adf1a10f8d0d3877f">rpmcliRootDir</a>[1] &amp;&amp; (bigMode &amp; ~<a class="code" href="rpmqv_8c.html#694075d156022e6fa1bde11dbe915b69">MODES_FOR_ROOT</a>))
<a name="l00510"></a>00510         <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--root (-r) may only be specified during "</span>
<a name="l00511"></a>00511                  <span class="stringliteral">"installation, erasure, querying, and "</span>
<a name="l00512"></a>00512                  <span class="stringliteral">"database rebuilds"</span>));
<a name="l00513"></a>00513 
<a name="l00514"></a>00514     <span class="keywordflow">if</span> (<a class="code" href="poptALL_8c.html#82a451d728a0042adf1a10f8d0d3877f">rpmcliRootDir</a>) {
<a name="l00515"></a>00515         <span class="keywordflow">switch</span> (<a class="code" href="rpmurl_8h.html#9def993f3a6f0b632236c66e03df7da6" title="Return type of URL.">urlIsURL</a>(<a class="code" href="poptALL_8c.html#82a451d728a0042adf1a10f8d0d3877f">rpmcliRootDir</a>)) {
<a name="l00516"></a>00516         <span class="keywordflow">default</span>:
<a name="l00517"></a>00517             <span class="keywordflow">if</span> (bigMode &amp; <a class="code" href="rpmqv_8c.html#694075d156022e6fa1bde11dbe915b69">MODES_FOR_ROOT</a>)
<a name="l00518"></a>00518                 <span class="keywordflow">break</span>;
<a name="l00519"></a>00519             <span class="comment">/*@fallthrough@*/</span>
<a name="l00520"></a>00520         <span class="keywordflow">case</span> <a class="code" href="rpmurl_8h.html#2e76e00c963b73c23690b5ebfe156dabc46cb197ad2431b66a788485740c5c9d">URL_IS_UNKNOWN</a>:
<a name="l00521"></a>00521             <span class="keywordflow">if</span> (rpmcliRootDir[0] != <span class="charliteral">'/'</span>)
<a name="l00522"></a>00522                 <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"arguments to --root (-r) must begin with a /"</span>));
<a name="l00523"></a>00523             <span class="keywordflow">break</span>;
<a name="l00524"></a>00524         }
<a name="l00525"></a>00525     }
<a name="l00526"></a>00526 
<a name="l00527"></a>00527 <span class="preprocessor">#if defined(IAM_RPMBT) || defined(IAM_RPMK)</span>
<a name="l00528"></a>00528 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (0
<a name="l00529"></a>00529 #<span class="keywordflow">if</span> defined(IAM_RPMBT)
<a name="l00530"></a>00530     || ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#7858437b94dd2d76ecb32a214565a8a3">sign</a> 
<a name="l00531"></a>00531 #endif
<a name="l00532"></a>00532 #<span class="keywordflow">if</span> defined(IAM_RPMK)
<a name="l00533"></a>00533     || ka-&gt;<a class="code" href="structrpmQVKArguments__s.html#eb02305021d6fde0b210f31d62ed6bd5">sign</a>
<a name="l00534"></a>00534 #endif
<a name="l00535"></a>00535     )
<a name="l00536"></a>00536     <span class="comment">/*@-branchstate@*/</span>
<a name="l00537"></a>00537     {
<a name="l00538"></a>00538         <span class="keywordflow">if</span> (bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0e938d5ca7fc880318726b0eae528ae63">MODE_REBUILD</a> || bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a> ||
<a name="l00539"></a>00539             bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c06db4cf60ae90c071555a082bf7428cc3">MODE_RESIGN</a> || bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c026d894aafd0cb8e82ec0be9115ee7a09">MODE_TARBUILD</a>)
<a name="l00540"></a>00540         {
<a name="l00541"></a>00541             <span class="keyword">const</span> <span class="keywordtype">char</span> ** av;
<a name="l00542"></a>00542             <span class="keyword">struct </span>stat sb;
<a name="l00543"></a>00543             <span class="keywordtype">int</span> <a class="code" href="tar_8h.html#734168047e2076407d7b8f01df9194a9">errors</a> = 0;
<a name="l00544"></a>00544 
<a name="l00545"></a>00545             <span class="keywordflow">if</span> ((av = poptGetArgs(optCon)) == NULL) {
<a name="l00546"></a>00546                 fprintf(stderr, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"no files to sign\n"</span>));
<a name="l00547"></a>00547                 errors++;
<a name="l00548"></a>00548             } <span class="keywordflow">else</span>
<a name="l00549"></a>00549             <span class="keywordflow">while</span> (*av) {
<a name="l00550"></a>00550                 <span class="keywordflow">if</span> (stat(*av, &amp;sb)) {
<a name="l00551"></a>00551                     fprintf(stderr, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"cannot access file %s\n"</span>), *av);
<a name="l00552"></a>00552                     errors++;
<a name="l00553"></a>00553                 }
<a name="l00554"></a>00554                 av++;
<a name="l00555"></a>00555             }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557             <span class="keywordflow">if</span> (errors) {
<a name="l00558"></a>00558                 ec = errors;
<a name="l00559"></a>00559                 <span class="keywordflow">goto</span> exit;
<a name="l00560"></a>00560             }
<a name="l00561"></a>00561 
<a name="l00562"></a>00562             <span class="keywordflow">if</span> (poptPeekArg(optCon)) {
<a name="l00563"></a>00563                 <span class="keywordtype">int</span> sigTag = <a class="code" href="group__signature.html#g2ff1c79a477fc07e2f8fc46f6f043d2f" title="Return type of signature needed for signing/building.">rpmLookupSignatureType</a>(<a class="code" href="signature_8h.html#ea312a86d4018151e51d4205f0f15626" title="Possible actions for rpmLookupSignatureType().">RPMLOOKUPSIG_QUERY</a>);
<a name="l00564"></a>00564                 <span class="keywordflow">switch</span> (sigTag) {
<a name="l00565"></a>00565                   <span class="keywordflow">case</span> 0:
<a name="l00566"></a>00566                     <span class="keywordflow">break</span>;
<a name="l00567"></a>00567                   <span class="keywordflow">case</span> <a class="code" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c9318aeb48036aa9ad771643a62646e523a3">RPMSIGTAG_PGP</a>:
<a name="l00568"></a>00568 <span class="preprocessor">#ifdef  DYING   </span><span class="comment">/* XXX gpg can now be used for RSA signatures. */</span>
<a name="l00569"></a>00569                     <span class="keywordflow">if</span> ((sigTag == <a class="code" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c9318aeb48036aa9ad771643a62646e523a3">RPMSIGTAG_PGP</a> || sigTag == <a class="code" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c9310343f0ef12296e27046773dd9042ed8c">RPMSIGTAG_PGP5</a>) &amp;&amp;
<a name="l00570"></a>00570                         !<a class="code" href="group__signature.html#ge2cc77c91f11db1b73b43848dba892d5" title="Return path to pgp executable of given type, or NULL when not found.">rpmDetectPGPVersion</a>(NULL)) {
<a name="l00571"></a>00571                         fprintf(stderr, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"pgp not found: "</span>));
<a name="l00572"></a>00572                         ec = <a class="code" href="system_8h.html#d851a8925c3675478e7dbb01d23a4dfa">EXIT_FAILURE</a>;
<a name="l00573"></a>00573                         <span class="keywordflow">goto</span> exit;
<a name="l00574"></a>00574                     }   <span class="comment">/*@fallthrough@*/</span>
<a name="l00575"></a>00575 <span class="preprocessor">#endif</span>
<a name="l00576"></a>00576 <span class="preprocessor"></span>                  <span class="keywordflow">case</span> <a class="code" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c931cafcdd43174c21af59f624588be6c8ac">RPMSIGTAG_GPG</a>:
<a name="l00577"></a>00577                   <span class="keywordflow">case</span> <a class="code" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c9311071614e4c22173beb7909f3bf8df6f2">RPMSIGTAG_DSA</a>:
<a name="l00578"></a>00578                   <span class="keywordflow">case</span> <a class="code" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c93107f683ae18b9f79fc568f40e6a6a70be">RPMSIGTAG_RSA</a>:
<a name="l00579"></a>00579                     passPhrase = <a class="code" href="group__signature.html#g3c5f526587b37055f4f8d481d1e4fb49" title="Read a pass phrase using getpass(3), confirm with gpg/pgp helper binaries.">rpmGetPassPhrase</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"Enter pass phrase: "</span>), sigTag);
<a name="l00580"></a>00580                     <span class="keywordflow">if</span> (passPhrase == NULL) {
<a name="l00581"></a>00581                         fprintf(stderr, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"Pass phrase check failed\n"</span>));
<a name="l00582"></a>00582                         ec = <a class="code" href="system_8h.html#d851a8925c3675478e7dbb01d23a4dfa">EXIT_FAILURE</a>;
<a name="l00583"></a>00583                         <span class="keywordflow">goto</span> exit;
<a name="l00584"></a>00584                     }
<a name="l00585"></a>00585                     fprintf(stderr, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"Pass phrase is good.\n"</span>));
<a name="l00586"></a>00586                     passPhrase = <a class="code" href="system_8h.html#700bf3013e33311eacdd1f20d13bdc9a">xstrdup</a>(passPhrase);
<a name="l00587"></a>00587                     <span class="keywordflow">break</span>;
<a name="l00588"></a>00588                   <span class="keywordflow">default</span>:
<a name="l00589"></a>00589                     fprintf(stderr,
<a name="l00590"></a>00590                             <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"Invalid %%_signature spec in macro file.\n"</span>));
<a name="l00591"></a>00591                     ec = <a class="code" href="system_8h.html#d851a8925c3675478e7dbb01d23a4dfa">EXIT_FAILURE</a>;
<a name="l00592"></a>00592                     <span class="keywordflow">goto</span> exit;
<a name="l00593"></a>00593                     <span class="comment">/*@notreached@*/</span> <span class="keywordflow">break</span>;
<a name="l00594"></a>00594                 }
<a name="l00595"></a>00595             }
<a name="l00596"></a>00596         } <span class="keywordflow">else</span> {
<a name="l00597"></a>00597             <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"--sign may only be used during package building"</span>));
<a name="l00598"></a>00598         }
<a name="l00599"></a>00599     } <span class="keywordflow">else</span> {
<a name="l00600"></a>00600         <span class="comment">/* Make rpmLookupSignatureType() return 0 ("none") from now on */</span>
<a name="l00601"></a>00601         (void) <a class="code" href="group__signature.html#g2ff1c79a477fc07e2f8fc46f6f043d2f" title="Return type of signature needed for signing/building.">rpmLookupSignatureType</a>(<a class="code" href="signature_8h.html#f71356417f1c8c7a314d0328e7427fe1">RPMLOOKUPSIG_DISABLE</a>);
<a name="l00602"></a>00602     }
<a name="l00603"></a>00603     <span class="comment">/*@=branchstate@*/</span>
<a name="l00604"></a>00604 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMBT || IAM_RPMK */</span>
<a name="l00605"></a>00605 
<a name="l00606"></a>00606     <span class="keywordflow">if</span> (<a class="code" href="poptALL_8c.html#9c2d5914ee9fe08f64c2053b111cc6b3">rpmcliPipeOutput</a>) {
<a name="l00607"></a>00607         (void) pipe(p);
<a name="l00608"></a>00608 
<a name="l00609"></a>00609         <span class="keywordflow">if</span> (!(pipeChild = fork())) {
<a name="l00610"></a>00610             (void) close(p[1]);
<a name="l00611"></a>00611             (void) dup2(p[0], STDIN_FILENO);
<a name="l00612"></a>00612             (void) close(p[0]);
<a name="l00613"></a>00613             (void) execl(<span class="stringliteral">"/bin/sh"</span>, <span class="stringliteral">"/bin/sh"</span>, <span class="stringliteral">"-c"</span>, <a class="code" href="poptALL_8c.html#9c2d5914ee9fe08f64c2053b111cc6b3">rpmcliPipeOutput</a>, NULL);
<a name="l00614"></a>00614             fprintf(stderr, <a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"exec failed\n"</span>));
<a name="l00615"></a>00615         }
<a name="l00616"></a>00616 
<a name="l00617"></a>00617         (void) close(p[0]);
<a name="l00618"></a>00618         (void) dup2(p[1], STDOUT_FILENO);
<a name="l00619"></a>00619         (void) close(p[1]);
<a name="l00620"></a>00620     }
<a name="l00621"></a>00621         
<a name="l00622"></a>00622     ts = <a class="code" href="group__rpmts.html#gea8dfc313aaafce2c6e9ee3caabce8b5" title="Create an empty transaction set.">rpmtsCreate</a>();
<a name="l00623"></a>00623     (void) <a class="code" href="group__rpmts.html#g4d8b076cbebc0a7aab1dc34355fa1b7f" title="Set transaction rootDir, i.e.">rpmtsSetRootDir</a>(ts, <a class="code" href="poptALL_8c.html#82a451d728a0042adf1a10f8d0d3877f">rpmcliRootDir</a>);
<a name="l00624"></a>00624     <span class="keywordflow">switch</span> (bigMode) {
<a name="l00625"></a>00625 <span class="preprocessor">#ifdef  IAM_RPMDB</span>
<a name="l00626"></a>00626 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0a0ff4d21dac86db4dc362ac08bf0f637">MODE_INITDB</a>:
<a name="l00627"></a>00627         ec = <a class="code" href="group__rpmts.html#g8621cfde0cbdef088b4ff33cbf127b83" title="Initialize the database used by the transaction.">rpmtsInitDB</a>(ts, 0644);
<a name="l00628"></a>00628         <span class="keywordflow">break</span>;
<a name="l00629"></a>00629 
<a name="l00630"></a>00630     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c03e9ff972b88d469f34274d5a47d0e4d5">MODE_REBUILDDB</a>:
<a name="l00631"></a>00631     {   <a class="code" href="rpmts_8h.html#81f9b6e0b2512e082e5c9cb106261449" title="Bit(s) to control digest and signature verification.">rpmVSFlags</a> <a class="code" href="rpmcache_8c.html#8338952a29222460c2bc12c9545e5241">vsflags</a> = <a class="code" href="macro_8c.html#2e43f3dd86c8e646243de9f051f36f6a" title="Return macro expansion as a numeric value.">rpmExpandNumeric</a>(<span class="stringliteral">"%{_vsflags_rebuilddb}"</span>);
<a name="l00632"></a>00632         <a class="code" href="rpmts_8h.html#81f9b6e0b2512e082e5c9cb106261449" title="Bit(s) to control digest and signature verification.">rpmVSFlags</a> ovsflags = <a class="code" href="group__rpmts.html#gff981dca4017713bfffba1260802a601" title="Set verify signatures flag(s).">rpmtsSetVSFlags</a>(ts, vsflags);
<a name="l00633"></a>00633         ec = <a class="code" href="group__rpmts.html#ge82d124995dda2d74a24a6080f3f7f8d" title="Rebuild the database used by the transaction.">rpmtsRebuildDB</a>(ts);
<a name="l00634"></a>00634         vsflags = <a class="code" href="group__rpmts.html#gff981dca4017713bfffba1260802a601" title="Set verify signatures flag(s).">rpmtsSetVSFlags</a>(ts, ovsflags);
<a name="l00635"></a>00635     }   <span class="keywordflow">break</span>;
<a name="l00636"></a>00636     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c042548dfaa5df6f4be39579f543e5797e">MODE_VERIFYDB</a>:
<a name="l00637"></a>00637         ec = <a class="code" href="group__rpmts.html#g438fdab74aa719e911378a9eb5bfc5e0" title="Verify the database used by the transaction.">rpmtsVerifyDB</a>(ts);
<a name="l00638"></a>00638         <span class="keywordflow">break</span>;
<a name="l00639"></a>00639 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMDB */</span>
<a name="l00640"></a>00640 
<a name="l00641"></a>00641 <span class="preprocessor">#ifdef  IAM_RPMBT</span>
<a name="l00642"></a>00642 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0e938d5ca7fc880318726b0eae528ae63">MODE_REBUILD</a>:
<a name="l00643"></a>00643     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0193e36b9bffdd15baa2f110a5eeb91e1">MODE_RECOMPILE</a>:
<a name="l00644"></a>00644     {   <span class="keyword">const</span> <span class="keywordtype">char</span> * pkg;
<a name="l00645"></a>00645 
<a name="l00646"></a>00646         <span class="keywordflow">while</span> (!<a class="code" href="rpmmessages_8h.html#27e9ca69465ed215147b0ec1a018a7fa">rpmIsVerbose</a>())
<a name="l00647"></a>00647             <a class="code" href="rpmmessages_8h.html#83676a1aa81e902f9f0ebf0faa4557b7">rpmIncreaseVerbosity</a>();
<a name="l00648"></a>00648 
<a name="l00649"></a>00649         <span class="keywordflow">if</span> (!poptPeekArg(optCon))
<a name="l00650"></a>00650             <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"no packages files given for rebuild"</span>));
<a name="l00651"></a>00651 
<a name="l00652"></a>00652         ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> =
<a name="l00653"></a>00653             <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca4729bc09cf9a94b4ecff9d7ed1b72686">RPMBUILD_PREP</a> | <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca1cad4fbc34db0a7f75eb4158e0a1b9e0">RPMBUILD_BUILD</a> | <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654cabfc05fb92005b58eba09b7385199fbbc">RPMBUILD_INSTALL</a> | <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca468bdcd0cc795801a31f89f833a70670">RPMBUILD_CHECK</a>;
<a name="l00654"></a>00654         <span class="keywordflow">if</span> (bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0e938d5ca7fc880318726b0eae528ae63">MODE_REBUILD</a>) {
<a name="l00655"></a>00655             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca365c9ad7975a19f4a2ed3dbfe7854347">RPMBUILD_PACKAGEBINARY</a>;
<a name="l00656"></a>00656             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca0d3ef3c991e0ef076bc03271705baaed">RPMBUILD_RMSOURCE</a>;
<a name="l00657"></a>00657             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654caa7a47327cf13c9266d3ff4b92eb5dc6f">RPMBUILD_RMSPEC</a>;
<a name="l00658"></a>00658             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca7fdc18a43e8e4ae56553d49f16e86c44">RPMBUILD_CLEAN</a>;
<a name="l00659"></a>00659             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca4efe312533bdd6278b55e69520291e8e">RPMBUILD_RMBUILD</a>;
<a name="l00660"></a>00660         }
<a name="l00661"></a>00661 
<a name="l00662"></a>00662         <span class="keywordflow">while</span> ((pkg = poptGetArg(optCon))) {
<a name="l00663"></a>00663             <span class="keyword">const</span> <span class="keywordtype">char</span> * specFile = NULL;
<a name="l00664"></a>00664 
<a name="l00665"></a>00665             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#2ce2dc91d746edf47947672091076e18">cookie</a> = NULL;
<a name="l00666"></a>00666             ec = <a class="code" href="group__rpmcli.html#g85215b242bfb2206a3f352166ea8fbb2" title="Install source rpm package.">rpmInstallSource</a>(ts, pkg, &amp;specFile, &amp;ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#2ce2dc91d746edf47947672091076e18">cookie</a>);
<a name="l00667"></a>00667             <span class="keywordflow">if</span> (ec == 0) {
<a name="l00668"></a>00668                 ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#9eb6f52ab227773b3ae363e930857bb3">rootdir</a> = <a class="code" href="poptALL_8c.html#82a451d728a0042adf1a10f8d0d3877f">rpmcliRootDir</a>;
<a name="l00669"></a>00669                 ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#92e850e3d7de61afbc875159a0f9e932">passPhrase</a> = passPhrase;
<a name="l00670"></a>00670                 ec = <a class="code" href="build_8c.html#de97ea7ebf18085d7c92db9fd1df1622">build</a>(ts, specFile, ba, <a class="code" href="poptALL_8c.html#be15d4f1c2930c65877034aeac3cb5d6">rpmcliRcfile</a>);
<a name="l00671"></a>00671             }
<a name="l00672"></a>00672             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#2ce2dc91d746edf47947672091076e18">cookie</a> = <a class="code" href="rpmlib_8h.html#d608c2923552dbeeb832133a9a289bb7" title="Wrapper to free(3), hides const compilation noise, permit NULL, return NULL.">_free</a>(ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#2ce2dc91d746edf47947672091076e18">cookie</a>);
<a name="l00673"></a>00673             specFile = <a class="code" href="rpmlib_8h.html#d608c2923552dbeeb832133a9a289bb7" title="Wrapper to free(3), hides const compilation noise, permit NULL, return NULL.">_free</a>(specFile);
<a name="l00674"></a>00674 
<a name="l00675"></a>00675             <span class="keywordflow">if</span> (ec)
<a name="l00676"></a>00676                 <span class="comment">/*@loopbreak@*/</span> <span class="keywordflow">break</span>;
<a name="l00677"></a>00677         }
<a name="l00678"></a>00678 
<a name="l00679"></a>00679     }   <span class="keywordflow">break</span>;
<a name="l00680"></a>00680 
<a name="l00681"></a>00681     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>:
<a name="l00682"></a>00682     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c026d894aafd0cb8e82ec0be9115ee7a09">MODE_TARBUILD</a>:
<a name="l00683"></a>00683     {   <span class="keyword">const</span> <span class="keywordtype">char</span> * pkg;
<a name="l00684"></a>00684         <span class="keywordflow">while</span> (!<a class="code" href="rpmmessages_8h.html#27e9ca69465ed215147b0ec1a018a7fa">rpmIsVerbose</a>())
<a name="l00685"></a>00685             <a class="code" href="rpmmessages_8h.html#83676a1aa81e902f9f0ebf0faa4557b7">rpmIncreaseVerbosity</a>();
<a name="l00686"></a>00686        
<a name="l00687"></a>00687         <span class="keywordflow">switch</span> (ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#1c0e0c8ddf46fa7817bee8eae1ce6492">buildChar</a>) {
<a name="l00688"></a>00688         <span class="keywordflow">case</span> <span class="charliteral">'a'</span>:
<a name="l00689"></a>00689             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654cabf9adbf39da1bee237ff2c0cfcbabe93">RPMBUILD_PACKAGESOURCE</a>;
<a name="l00690"></a>00690             <span class="comment">/*@fallthrough@*/</span>
<a name="l00691"></a>00691         <span class="keywordflow">case</span> <span class="charliteral">'b'</span>:
<a name="l00692"></a>00692             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca365c9ad7975a19f4a2ed3dbfe7854347">RPMBUILD_PACKAGEBINARY</a>;
<a name="l00693"></a>00693             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca7fdc18a43e8e4ae56553d49f16e86c44">RPMBUILD_CLEAN</a>;
<a name="l00694"></a>00694             <span class="comment">/*@fallthrough@*/</span>
<a name="l00695"></a>00695         <span class="keywordflow">case</span> <span class="charliteral">'i'</span>:
<a name="l00696"></a>00696             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654cabfc05fb92005b58eba09b7385199fbbc">RPMBUILD_INSTALL</a>;
<a name="l00697"></a>00697             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca468bdcd0cc795801a31f89f833a70670">RPMBUILD_CHECK</a>;
<a name="l00698"></a>00698             <span class="keywordflow">if</span> ((ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#1c0e0c8ddf46fa7817bee8eae1ce6492">buildChar</a> == <span class="charliteral">'i'</span>) &amp;&amp; ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#78cf36859b6609c86aa25f72047e237a">shortCircuit</a>)
<a name="l00699"></a>00699                 <span class="comment">/*@innerbreak@*/</span> <span class="keywordflow">break</span>;
<a name="l00700"></a>00700             <span class="comment">/*@fallthrough@*/</span>
<a name="l00701"></a>00701         <span class="keywordflow">case</span> <span class="charliteral">'c'</span>:
<a name="l00702"></a>00702             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca1cad4fbc34db0a7f75eb4158e0a1b9e0">RPMBUILD_BUILD</a>;
<a name="l00703"></a>00703             <span class="keywordflow">if</span> ((ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#1c0e0c8ddf46fa7817bee8eae1ce6492">buildChar</a> == <span class="charliteral">'c'</span>) &amp;&amp; ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#78cf36859b6609c86aa25f72047e237a">shortCircuit</a>)
<a name="l00704"></a>00704                 <span class="comment">/*@innerbreak@*/</span> <span class="keywordflow">break</span>;
<a name="l00705"></a>00705             <span class="comment">/*@fallthrough@*/</span>
<a name="l00706"></a>00706         <span class="keywordflow">case</span> <span class="charliteral">'p'</span>:
<a name="l00707"></a>00707             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654ca4729bc09cf9a94b4ecff9d7ed1b72686">RPMBUILD_PREP</a>;
<a name="l00708"></a>00708             <span class="comment">/*@innerbreak@*/</span> <span class="keywordflow">break</span>;
<a name="l00709"></a>00709             
<a name="l00710"></a>00710         <span class="keywordflow">case</span> <span class="charliteral">'l'</span>:
<a name="l00711"></a>00711             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654cac2608a84ffbed8b56509cba3dd89452c">RPMBUILD_FILECHECK</a>;
<a name="l00712"></a>00712             <span class="comment">/*@innerbreak@*/</span> <span class="keywordflow">break</span>;
<a name="l00713"></a>00713         <span class="keywordflow">case</span> <span class="charliteral">'s'</span>:
<a name="l00714"></a>00714             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c863563f5aa082b89cacf561187ab1df">buildAmount</a> |= <a class="code" href="group__rpmbuild.html#gg97c097292f839a7e75aa9c512a6654cabf9adbf39da1bee237ff2c0cfcbabe93">RPMBUILD_PACKAGESOURCE</a>;
<a name="l00715"></a>00715             <span class="comment">/*@innerbreak@*/</span> <span class="keywordflow">break</span>;
<a name="l00716"></a>00716         }
<a name="l00717"></a>00717 
<a name="l00718"></a>00718         <span class="keywordflow">if</span> (!poptPeekArg(optCon)) {
<a name="l00719"></a>00719             <span class="keywordflow">if</span> (bigMode == <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>)
<a name="l00720"></a>00720                 <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"no spec files given for build"</span>));
<a name="l00721"></a>00721             <span class="keywordflow">else</span>
<a name="l00722"></a>00722                 <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"no tar files given for build"</span>));
<a name="l00723"></a>00723         }
<a name="l00724"></a>00724 
<a name="l00725"></a>00725         <span class="keywordflow">while</span> ((pkg = poptGetArg(optCon))) {
<a name="l00726"></a>00726             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#9eb6f52ab227773b3ae363e930857bb3">rootdir</a> = <a class="code" href="poptALL_8c.html#82a451d728a0042adf1a10f8d0d3877f">rpmcliRootDir</a>;
<a name="l00727"></a>00727             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#92e850e3d7de61afbc875159a0f9e932">passPhrase</a> = passPhrase;
<a name="l00728"></a>00728             ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#2ce2dc91d746edf47947672091076e18">cookie</a> = NULL;
<a name="l00729"></a>00729             ec = <a class="code" href="build_8c.html#de97ea7ebf18085d7c92db9fd1df1622">build</a>(ts, pkg, ba, <a class="code" href="poptALL_8c.html#be15d4f1c2930c65877034aeac3cb5d6">rpmcliRcfile</a>);
<a name="l00730"></a>00730             <span class="keywordflow">if</span> (ec)
<a name="l00731"></a>00731                 <span class="comment">/*@loopbreak@*/</span> <span class="keywordflow">break</span>;
<a name="l00732"></a>00732             <a class="code" href="macro_8c.html#b02b0d47ca43105f753852324a44caa9" title="Destroy macro context.">rpmFreeMacros</a>(NULL);
<a name="l00733"></a>00733             (void) <a class="code" href="group__rpmrc.html#g4a7184e58c74b1ada8f733449b8fd1cd" title="Read macro configuration file(s) for a target.">rpmReadConfigFiles</a>(<a class="code" href="poptALL_8c.html#be15d4f1c2930c65877034aeac3cb5d6">rpmcliRcfile</a>, NULL);
<a name="l00734"></a>00734         }
<a name="l00735"></a>00735     }   <span class="keywordflow">break</span>;
<a name="l00736"></a>00736 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMBT */</span>
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 <span class="preprocessor">#ifdef  IAM_RPMEIU</span>
<a name="l00739"></a>00739 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a>:
<a name="l00740"></a>00740         <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#d28ea7e3a29ca777408fec02627e66cc">noDeps</a>) ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#8f8fcc9b9ce508237f8b4fcc0db5a69c">eraseInterfaceFlags</a> |= <a class="code" href="group__rpmcli.html#gg711126b7038f407fdccf3928129ffe1f9cd22e3b0e64783a8f16eb250dc3e3b5">UNINSTALL_NODEPS</a>;
<a name="l00741"></a>00741 
<a name="l00742"></a>00742         <span class="keywordflow">if</span> (!poptPeekArg(optCon)) {
<a name="l00743"></a>00743             <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#a9029e19e764f84987c4f702b7c881ba">rbtid</a> == 0)
<a name="l00744"></a>00744                 <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"no packages given for erase"</span>));
<a name="l00745"></a>00745 ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> |= <a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2ef383755f9efb4d8d08f56a57ad9644072">RPMTRANS_FLAG_NOMD5</a>;
<a name="l00746"></a>00746 ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#1fdabe9fda6bc8cdaeaf077fdbb4d4f7">probFilter</a> |= <a class="code" href="rpmlib_8h.html#bb6103eff013f34a8fa2f11377227993129ce141be9ae0a0a861524a853a9ec2">RPMPROB_FILTER_OLDPACKAGE</a>;
<a name="l00747"></a>00747             ec += <a class="code" href="group__rpmcli.html#g95469c37c9c761ed4d52e7973ce2e7d7" title="Rollback transactions, erasing new, reinstalling old, package(s).">rpmRollback</a>(ts, ia, NULL);
<a name="l00748"></a>00748         } <span class="keywordflow">else</span> {
<a name="l00749"></a>00749             ec += <a class="code" href="group__rpmcli.html#geee7addf3260fcdac08815ac21a5950c" title="Erase binary rpm package.">rpmErase</a>(ts, ia, (<span class="keyword">const</span> <span class="keywordtype">char</span> **) poptGetArgs(optCon));
<a name="l00750"></a>00750         }
<a name="l00751"></a>00751         <span class="keywordflow">break</span>;
<a name="l00752"></a>00752 
<a name="l00753"></a>00753     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a>:
<a name="l00754"></a>00754 
<a name="l00755"></a>00755         <span class="comment">/* RPMTRANS_FLAG_KEEPOBSOLETE */</span>
<a name="l00756"></a>00756 
<a name="l00757"></a>00757         <span class="keywordflow">if</span> (!ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#42a3055a970f4e384e7697e2fa3e9102">incldocs</a>) {
<a name="l00758"></a>00758             <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> &amp; <a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2ef720f21009132b5d930e2de934fd87827">RPMTRANS_FLAG_NODOCS</a>) {
<a name="l00759"></a>00759                 ;
<a name="l00760"></a>00760             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="macro_8c.html#2e43f3dd86c8e646243de9f051f36f6a" title="Return macro expansion as a numeric value.">rpmExpandNumeric</a>(<span class="stringliteral">"%{_excludedocs}"</span>))
<a name="l00761"></a>00761                 ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> |= <a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2ef720f21009132b5d930e2de934fd87827">RPMTRANS_FLAG_NODOCS</a>;
<a name="l00762"></a>00762         }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764         <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#d28ea7e3a29ca777408fec02627e66cc">noDeps</a>) ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#5be354892399a7b1794474fc77a0e025">installInterfaceFlags</a> |= <a class="code" href="group__rpmcli.html#gg8dafaec14dcb60d8e1cf64c58255f0401e2bfc5b2bb89660a383c5099f519781">INSTALL_NODEPS</a>;
<a name="l00765"></a>00765 
<a name="l00766"></a>00766         <span class="comment">/* we've already ensured !(!ia-&gt;prefix &amp;&amp; !ia-&gt;relocations) */</span>
<a name="l00767"></a>00767         <span class="comment">/*@-branchstate@*/</span>
<a name="l00768"></a>00768         <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#0cd1482df0b9dfec04c05c9aa53f146e">prefix</a>) {
<a name="l00769"></a>00769             ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a> = <a class="code" href="system_8h.html#2ff4ef58da7e543466e75f20f2a2d8b7">xmalloc</a>(2 * <span class="keyword">sizeof</span>(*ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>));
<a name="l00770"></a>00770             ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>[0].<a class="code" href="structrpmRelocation__s.html#20c30b7649b9b0dc5968aa919ef1300d">oldPath</a> = NULL;   <span class="comment">/* special case magic */</span>
<a name="l00771"></a>00771             ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>[0].<a class="code" href="structrpmRelocation__s.html#f3351e0a30484b14e46e49bf0bd80297">newPath</a> = ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#0cd1482df0b9dfec04c05c9aa53f146e">prefix</a>;
<a name="l00772"></a>00772             ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>[1].<a class="code" href="structrpmRelocation__s.html#20c30b7649b9b0dc5968aa919ef1300d">oldPath</a> = NULL;
<a name="l00773"></a>00773             ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>[1].<a class="code" href="structrpmRelocation__s.html#f3351e0a30484b14e46e49bf0bd80297">newPath</a> = NULL;
<a name="l00774"></a>00774         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>) {
<a name="l00775"></a>00775             ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a> = <a class="code" href="system_8h.html#089316e2770f7e09a135f7128241af8a">xrealloc</a>(ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>, 
<a name="l00776"></a>00776                         <span class="keyword">sizeof</span>(*ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>) * (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#5d3042220bf1ee5033a32e1a2136a796">numRelocations</a> + 1));
<a name="l00777"></a>00777             ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>[ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#5d3042220bf1ee5033a32e1a2136a796">numRelocations</a>].<a class="code" href="structrpmRelocation__s.html#20c30b7649b9b0dc5968aa919ef1300d">oldPath</a> = NULL;
<a name="l00778"></a>00778             ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>[ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#5d3042220bf1ee5033a32e1a2136a796">numRelocations</a>].<a class="code" href="structrpmRelocation__s.html#f3351e0a30484b14e46e49bf0bd80297">newPath</a> = NULL;
<a name="l00779"></a>00779         }
<a name="l00780"></a>00780         <span class="comment">/*@=branchstate@*/</span>
<a name="l00781"></a>00781 
<a name="l00782"></a>00782         <span class="keywordflow">if</span> (!poptPeekArg(optCon)) {
<a name="l00783"></a>00783             <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#a9029e19e764f84987c4f702b7c881ba">rbtid</a> == 0)
<a name="l00784"></a>00784                 <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"no packages given for install"</span>));
<a name="l00785"></a>00785 ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#3ea56121ffcb86e21e08a25b09fa3f57">transFlags</a> |= <a class="code" href="rpmlib_8h.html#451385c9472c6ccc583867853442e2ef383755f9efb4d8d08f56a57ad9644072">RPMTRANS_FLAG_NOMD5</a>;
<a name="l00786"></a>00786 ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#1fdabe9fda6bc8cdaeaf077fdbb4d4f7">probFilter</a> |= <a class="code" href="rpmlib_8h.html#bb6103eff013f34a8fa2f11377227993129ce141be9ae0a0a861524a853a9ec2">RPMPROB_FILTER_OLDPACKAGE</a>;
<a name="l00787"></a>00787 <span class="comment">/*@i@*/</span>     ec += <a class="code" href="group__rpmcli.html#g95469c37c9c761ed4d52e7973ce2e7d7" title="Rollback transactions, erasing new, reinstalling old, package(s).">rpmRollback</a>(ts, ia, NULL);
<a name="l00788"></a>00788         } <span class="keywordflow">else</span> {
<a name="l00789"></a>00789             <span class="comment">/*@-compdef -compmempass@*/</span> <span class="comment">/* FIX: ia-&gt;relocations[0].newPath undefined */</span>
<a name="l00790"></a>00790             ec += <a class="code" href="group__rpmcli.html#gf0bf01b16463cb3d2c926ee9de666a49" title="Install/upgrade/freshen binary rpm package.">rpmInstall</a>(ts, ia, (<span class="keyword">const</span> <span class="keywordtype">char</span> **)poptGetArgs(optCon));
<a name="l00791"></a>00791             <span class="comment">/*@=compdef =compmempass@*/</span>
<a name="l00792"></a>00792         }
<a name="l00793"></a>00793         <span class="keywordflow">break</span>;
<a name="l00794"></a>00794 
<a name="l00795"></a>00795 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMEIU */</span>
<a name="l00796"></a>00796 
<a name="l00797"></a>00797 <span class="preprocessor">#ifdef  IAM_RPMQV</span>
<a name="l00798"></a>00798 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c04834b44c122dab4a87c0f6f944447471">MODE_QUERY</a>:
<a name="l00799"></a>00799         <span class="keywordflow">if</span> (!poptPeekArg(optCon)
<a name="l00800"></a>00800          &amp;&amp; !(qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#c4fd364f8629abfac17c21a49823df7b">qva_source</a> == <a class="code" href="group__rpmcli.html#gg50b433b67698e600e9073de639900c9f199486c942ba8c4bb3cccbf897827372">RPMQV_ALL</a> || qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#c4fd364f8629abfac17c21a49823df7b">qva_source</a> == <a class="code" href="group__rpmcli.html#gg50b433b67698e600e9073de639900c9f77076a79f6cc8cded6487c57c024b600">RPMQV_HDLIST</a>))
<a name="l00801"></a>00801             <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"no arguments given for query"</span>));
<a name="l00802"></a>00802 
<a name="l00803"></a>00803         qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#a0794c79455aa13a0ed157f25a9fcfc9">qva_specQuery</a> = <a class="code" href="group__rpmbuild.html#g1455cc2c9b125a06dd2973afba5518b9" title="Function to query spec file(s).">rpmspecQuery</a>;
<a name="l00804"></a>00804         ec = <a class="code" href="group__rpmcli.html#gf1716c297513bcab4ad1bcec98a0362d" title="Display package information.">rpmcliQuery</a>(ts, qva, (<span class="keyword">const</span> <span class="keywordtype">char</span> **) poptGetArgs(optCon));
<a name="l00805"></a>00805         qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#a0794c79455aa13a0ed157f25a9fcfc9">qva_specQuery</a> = NULL;
<a name="l00806"></a>00806         <span class="keywordflow">break</span>;
<a name="l00807"></a>00807 
<a name="l00808"></a>00808     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c264959db5fabe4379fcc7b42f314032">MODE_VERIFY</a>:
<a name="l00809"></a>00809     {   <a class="code" href="group__rpmcli.html#g24430462e03011e42998d5171d40e1ba" title="Bit(s) to control rpmVerify() operation, stored in qva_flags.">rpmVerifyFlags</a> verifyFlags = <a class="code" href="rpmcli_8h.html#9afb1a6b8cf390b3bfae884c00e90594">VERIFY_ALL</a>;
<a name="l00810"></a>00810 
<a name="l00811"></a>00811         verifyFlags &amp;= ~qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#cc945d709a159ce1dec392ba52750ab4">qva_flags</a>;
<a name="l00812"></a>00812         qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#cc945d709a159ce1dec392ba52750ab4">qva_flags</a> = (<a class="code" href="group__rpmcli.html#g0a7f799bb561a1526c0b9b9343cce421" title="Bit(s) to control rpmQuery() operation, stored in qva_flags.">rpmQueryFlags</a>) verifyFlags;
<a name="l00813"></a>00813 
<a name="l00814"></a>00814         <span class="keywordflow">if</span> (!poptPeekArg(optCon)
<a name="l00815"></a>00815          &amp;&amp; !(qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#c4fd364f8629abfac17c21a49823df7b">qva_source</a> == <a class="code" href="group__rpmcli.html#gg50b433b67698e600e9073de639900c9f199486c942ba8c4bb3cccbf897827372">RPMQV_ALL</a> || qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#c4fd364f8629abfac17c21a49823df7b">qva_source</a> == <a class="code" href="group__rpmcli.html#gg50b433b67698e600e9073de639900c9f77076a79f6cc8cded6487c57c024b600">RPMQV_HDLIST</a>))
<a name="l00816"></a>00816             <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"no arguments given for verify"</span>));
<a name="l00817"></a>00817         ec = <a class="code" href="group__rpmcli.html#g8260db9435f2688c52de712d13fd7af8" title="Verify package install.">rpmcliVerify</a>(ts, qva, (<span class="keyword">const</span> <span class="keywordtype">char</span> **) poptGetArgs(optCon));
<a name="l00818"></a>00818     }   <span class="keywordflow">break</span>;
<a name="l00819"></a>00819 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMQV */</span>
<a name="l00820"></a>00820 
<a name="l00821"></a>00821 <span class="preprocessor">#ifdef IAM_RPMK</span>
<a name="l00822"></a>00822 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0dfa7048d726620c69d7a31877ad52f01">MODE_CHECKSIG</a>:
<a name="l00823"></a>00823     {   <a class="code" href="group__rpmcli.html#g24430462e03011e42998d5171d40e1ba" title="Bit(s) to control rpmVerify() operation, stored in qva_flags.">rpmVerifyFlags</a> verifyFlags =
<a name="l00824"></a>00824                 (<a class="code" href="group__rpmcli.html#gge57534cde3e9032b6b0aa7e27bfe9e711b8896abc4e4a946e704da7ba5c86253">VERIFY_MD5</a>|<a class="code" href="group__rpmcli.html#gge57534cde3e9032b6b0aa7e27bfe9e71125165395e4d9d505c88cb532d564cdf">VERIFY_DIGEST</a>|<a class="code" href="group__rpmcli.html#gge57534cde3e9032b6b0aa7e27bfe9e71d180f7d9e674d6b3abeca381f18fb082">VERIFY_SIGNATURE</a>);
<a name="l00825"></a>00825 
<a name="l00826"></a>00826         verifyFlags &amp;= ~ka-&gt;<a class="code" href="structrpmQVKArguments__s.html#cc945d709a159ce1dec392ba52750ab4">qva_flags</a>;
<a name="l00827"></a>00827         ka-&gt;<a class="code" href="structrpmQVKArguments__s.html#cc945d709a159ce1dec392ba52750ab4">qva_flags</a> = (<a class="code" href="group__rpmcli.html#g0a7f799bb561a1526c0b9b9343cce421" title="Bit(s) to control rpmQuery() operation, stored in qva_flags.">rpmQueryFlags</a>) verifyFlags;
<a name="l00828"></a>00828     }   <span class="comment">/*@fallthrough@*/</span>
<a name="l00829"></a>00829     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c06db4cf60ae90c071555a082bf7428cc3">MODE_RESIGN</a>:
<a name="l00830"></a>00830         <span class="keywordflow">if</span> (!poptPeekArg(optCon))
<a name="l00831"></a>00831             <a class="code" href="rpmqv_8c.html#655cea3623755128deebfc21987a869b">argerror</a>(<a class="code" href="system_8h.html#2ec2c1c3098396e2d147d58b66f18ceb">_</a>(<span class="stringliteral">"no arguments given"</span>));
<a name="l00832"></a>00832         ka-&gt;<a class="code" href="structrpmQVKArguments__s.html#16462e36d72994cd7ef889476a6412c3">passPhrase</a> = passPhrase;
<a name="l00833"></a>00833         ec = <a class="code" href="group__rpmcli.html#g33f182c151d78105f8e4bc36b6f48420" title="Create/Modify/Check elements from signature header.">rpmcliSign</a>(ts, ka, (<span class="keyword">const</span> <span class="keywordtype">char</span> **)poptGetArgs(optCon));
<a name="l00834"></a>00834         <span class="keywordflow">break</span>;
<a name="l00835"></a>00835 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMK */</span>
<a name="l00836"></a>00836         
<a name="l00837"></a>00837 <span class="preprocessor">#if !defined(IAM_RPMQV)</span>
<a name="l00838"></a>00838 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c04834b44c122dab4a87c0f6f944447471">MODE_QUERY</a>:
<a name="l00839"></a>00839     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c264959db5fabe4379fcc7b42f314032">MODE_VERIFY</a>:
<a name="l00840"></a>00840 <span class="preprocessor">#endif</span>
<a name="l00841"></a>00841 <span class="preprocessor"></span><span class="preprocessor">#if !defined(IAM_RPMK)</span>
<a name="l00842"></a>00842 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0dfa7048d726620c69d7a31877ad52f01">MODE_CHECKSIG</a>:
<a name="l00843"></a>00843     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c06db4cf60ae90c071555a082bf7428cc3">MODE_RESIGN</a>:
<a name="l00844"></a>00844 <span class="preprocessor">#endif</span>
<a name="l00845"></a>00845 <span class="preprocessor"></span><span class="preprocessor">#if !defined(IAM_RPMDB)</span>
<a name="l00846"></a>00846 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0a0ff4d21dac86db4dc362ac08bf0f637">MODE_INITDB</a>:
<a name="l00847"></a>00847     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c03e9ff972b88d469f34274d5a47d0e4d5">MODE_REBUILDDB</a>:
<a name="l00848"></a>00848     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c042548dfaa5df6f4be39579f543e5797e">MODE_VERIFYDB</a>:
<a name="l00849"></a>00849 <span class="preprocessor">#endif</span>
<a name="l00850"></a>00850 <span class="preprocessor"></span><span class="preprocessor">#if !defined(IAM_RPMBT)</span>
<a name="l00851"></a>00851 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0070c34cfd2de1ae4767de7bfcc3b2040">MODE_BUILD</a>:
<a name="l00852"></a>00852     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0e938d5ca7fc880318726b0eae528ae63">MODE_REBUILD</a>:
<a name="l00853"></a>00853     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0193e36b9bffdd15baa2f110a5eeb91e1">MODE_RECOMPILE</a>:
<a name="l00854"></a>00854     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c026d894aafd0cb8e82ec0be9115ee7a09">MODE_TARBUILD</a>:
<a name="l00855"></a>00855 <span class="preprocessor">#endif</span>
<a name="l00856"></a>00856 <span class="preprocessor"></span><span class="preprocessor">#if !defined(IAM_RPMEIU)</span>
<a name="l00857"></a>00857 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c007dfd459ae7a01e17412048aca03fe01">MODE_INSTALL</a>:
<a name="l00858"></a>00858     <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0c23f6011a7b5919919af41a56f6d4d2f">MODE_ERASE</a>:
<a name="l00859"></a>00859 <span class="preprocessor">#endif</span>
<a name="l00860"></a>00860 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="rpmqv_8c.html#f58b82ccbe1dfb97fb367c46cedb56c0540549c3eca45ae01fcc8caaed352e54">MODE_UNKNOWN</a>:
<a name="l00861"></a>00861         <span class="keywordflow">if</span> (poptPeekArg(optCon) != NULL || argc &lt;= 1 || <a class="code" href="rpmmessages_8h.html#27e9ca69465ed215147b0ec1a018a7fa">rpmIsVerbose</a>()) {
<a name="l00862"></a>00862             <a class="code" href="rpmqv_8c.html#ecdd450b2d6963761ab9eb5783650842">printUsage</a>(optCon, stdout, 0);
<a name="l00863"></a>00863             ec = argc;
<a name="l00864"></a>00864         }
<a name="l00865"></a>00865         <span class="keywordflow">break</span>;
<a name="l00866"></a>00866     }
<a name="l00867"></a>00867 
<a name="l00868"></a>00868 <span class="preprocessor">#if defined(IAM_RPMBT) || defined(IAM_RPMK)</span>
<a name="l00869"></a>00869 <span class="preprocessor"></span>exit:
<a name="l00870"></a>00870 <span class="preprocessor">#endif  </span><span class="comment">/* IAM_RPMBT || IAM_RPMK */</span>
<a name="l00871"></a>00871 
<a name="l00872"></a>00872     ts = <a class="code" href="group__rpmts.html#g95515319c5194d997d6cb84a1e1938c2" title="Destroy transaction set, closing the database as well.">rpmtsFree</a>(ts);
<a name="l00873"></a>00873 
<a name="l00874"></a>00874     optCon = poptFreeContext(optCon);
<a name="l00875"></a>00875     <a class="code" href="macro_8c.html#b02b0d47ca43105f753852324a44caa9" title="Destroy macro context.">rpmFreeMacros</a>(NULL);
<a name="l00876"></a>00876 <span class="comment">/*@i@*/</span> <a class="code" href="macro_8c.html#b02b0d47ca43105f753852324a44caa9" title="Destroy macro context.">rpmFreeMacros</a>(<a class="code" href="rpmlib_8h.html#8006c2dbfafa9d855483d850e26c52d8">rpmCLIMacroContext</a>);
<a name="l00877"></a>00877     <a class="code" href="group__rpmrc.html#g7c70ff4302a55d2693df50d3bba0cc4a" title="Destroy rpmrc arch/os compatibility tables.">rpmFreeRpmrc</a>();
<a name="l00878"></a>00878 
<a name="l00879"></a>00879     <span class="keywordflow">if</span> (pipeChild) {
<a name="l00880"></a>00880         (void) fclose(stdout);
<a name="l00881"></a>00881         (void) waitpid(pipeChild, &amp;status, 0);
<a name="l00882"></a>00882     }
<a name="l00883"></a>00883 
<a name="l00884"></a>00884     <span class="comment">/* keeps memory leak checkers quiet */</span>
<a name="l00885"></a>00885     <a class="code" href="fs_8c.html#fa5fb9c994f3f7eb9f483cbeaa8e9ebe" title="Release storage used by file system usage cache.">freeFilesystems</a>();
<a name="l00886"></a>00886 <span class="comment">/*@i@*/</span> <a class="code" href="rpmurl_8h.html#c800978d37f9d36fee3ac630cfd73db5" title="Free cached URL control structures.">urlFreeCache</a>();
<a name="l00887"></a>00887     <a class="code" href="rpmlog_8c.html#97f26f7e474d50f738678da06d230522" title="Close desriptor used to write to system logger.">rpmlogClose</a>();
<a name="l00888"></a>00888     <a class="code" href="group__rpmdb.html#gaa38ed50d0d140f2f3423b8d65df36b1" title="Tags for which rpmdb indices will be built.">dbiTags</a> = <a class="code" href="rpmlib_8h.html#d608c2923552dbeeb832133a9a289bb7" title="Wrapper to free(3), hides const compilation noise, permit NULL, return NULL.">_free</a>(<a class="code" href="group__rpmdb.html#gaa38ed50d0d140f2f3423b8d65df36b1" title="Tags for which rpmdb indices will be built.">dbiTags</a>);
<a name="l00889"></a>00889 
<a name="l00890"></a>00890 <span class="preprocessor">#ifdef  IAM_RPMQV</span>
<a name="l00891"></a>00891 <span class="preprocessor"></span>    qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#9ece4dae8020e323fc9af97bc338e84c">qva_queryFormat</a> = <a class="code" href="rpmlib_8h.html#d608c2923552dbeeb832133a9a289bb7" title="Wrapper to free(3), hides const compilation noise, permit NULL, return NULL.">_free</a>(qva-&gt;<a class="code" href="structrpmQVKArguments__s.html#9ece4dae8020e323fc9af97bc338e84c">qva_queryFormat</a>);
<a name="l00892"></a>00892 <span class="preprocessor">#endif</span>
<a name="l00893"></a>00893 <span class="preprocessor"></span>
<a name="l00894"></a>00894 <span class="preprocessor">#ifdef  IAM_RPMBT</span>
<a name="l00895"></a>00895 <span class="preprocessor"></span>    <a class="code" href="group__rpmbuild.html#g7b91a111a6dfb74aaf43b30fa7d2ea97" title="Destroy uid/gid caches.">freeNames</a>();
<a name="l00896"></a>00896     ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c32d450aedf4796356fe9acdf0f3666f">buildRootOverride</a> = <a class="code" href="rpmlib_8h.html#d608c2923552dbeeb832133a9a289bb7" title="Wrapper to free(3), hides const compilation noise, permit NULL, return NULL.">_free</a>(ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#c32d450aedf4796356fe9acdf0f3666f">buildRootOverride</a>);
<a name="l00897"></a>00897     ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#ae7cbaaf3845e9a3aaaeef98925b9558">targets</a> = <a class="code" href="rpmlib_8h.html#d608c2923552dbeeb832133a9a289bb7" title="Wrapper to free(3), hides const compilation noise, permit NULL, return NULL.">_free</a>(ba-&gt;<a class="code" href="structrpmBuildArguments__s.html#ae7cbaaf3845e9a3aaaeef98925b9558">targets</a>);
<a name="l00898"></a>00898 <span class="preprocessor">#endif</span>
<a name="l00899"></a>00899 <span class="preprocessor"></span>
<a name="l00900"></a>00900 <span class="preprocessor">#ifdef  IAM_RPMEIU</span>
<a name="l00901"></a>00901 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a> != NULL)
<a name="l00902"></a>00902     <span class="keywordflow">for</span> (i = 0; i &lt; ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#5d3042220bf1ee5033a32e1a2136a796">numRelocations</a>; i++)
<a name="l00903"></a>00903         ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>[i].<a class="code" href="structrpmRelocation__s.html#20c30b7649b9b0dc5968aa919ef1300d">oldPath</a> = <a class="code" href="rpmlib_8h.html#d608c2923552dbeeb832133a9a289bb7" title="Wrapper to free(3), hides const compilation noise, permit NULL, return NULL.">_free</a>(ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>[i].<a class="code" href="structrpmRelocation__s.html#20c30b7649b9b0dc5968aa919ef1300d">oldPath</a>);
<a name="l00904"></a>00904     ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a> = <a class="code" href="rpmlib_8h.html#d608c2923552dbeeb832133a9a289bb7" title="Wrapper to free(3), hides const compilation noise, permit NULL, return NULL.">_free</a>(ia-&gt;<a class="code" href="structrpmInstallArguments__s.html#7968d86d569917676657de3d2a1356c6">relocations</a>);
<a name="l00905"></a>00905 #endif
<a name="l00906"></a>00906 
<a name="l00907"></a>00907 #<span class="keywordflow">if</span> <a class="code" href="config_8h.html#bf7ed2b5fd471f4a8ff31f04a97f9fbf">HAVE_MCHECK_H</a> &amp;&amp; <a class="code" href="config_8h.html#dc93d302586c33a1df47719a5634999a">HAVE_MTRACE</a>
<a name="l00908"></a>00908     <span class="comment">/*@-noeffect@*/</span>
<a name="l00909"></a>00909     muntrace();   <span class="comment">/* Trace malloc only if MALLOC_TRACE=mtrace-output-file. */</span>
<a name="l00910"></a>00910     <span class="comment">/*@=noeffect@*/</span>
<a name="l00911"></a>00911 <span class="preprocessor">#endif</span>
<a name="l00912"></a>00912 <span class="preprocessor"></span>
<a name="l00913"></a>00913     <span class="comment">/* XXX don't overflow single byte exit status */</span>
<a name="l00914"></a>00914     <span class="keywordflow">if</span> (ec &gt; 255) ec = 255;
<a name="l00915"></a>00915 
<a name="l00916"></a>00916     <span class="comment">/*@-globstate@*/</span>
<a name="l00917"></a>00917     <span class="keywordflow">return</span> ec;
<a name="l00918"></a>00918     <span class="comment">/*@=globstate@*/</span>
<a name="l00919"></a>00919 }
<a name="l00920"></a>00920 <span class="comment">/*@=mods@*/</span>
<a name="l00921"></a>00921 <span class="comment">/*@=bounds@*/</span>
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Fri Oct 12 08:44:55 2007 for rpm by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
