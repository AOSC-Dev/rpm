<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>rpm: SIGNATURE.</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1>SIGNATURE.</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Files</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmlib_8h.html">rpmlib.h</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">In Memoriam: Steve Taylor &lt;<a href="mailto:staylor@redhat.com">staylor@redhat.com</a>&gt; was here, now he's not. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8c.html">signature.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signature_8h.html">signature.h</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate and verify signatures. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="digest_8c.html">digest.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmpgp_8c.html">rpmpgp.c</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Routines to handle RFC-2440 detached signatures. <br></td></tr>

<p>
<tr><td colspan="2"><br><h2>RPMK</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g2c705e9138aa336a57ab3198bf40c931">rpmtagSignature</a> { <br>
&nbsp;&nbsp;<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c931bf2c0cb8b00afc9be9c2ef44c744773e">RPMSIGTAG_SIZE</a> =  1000, 
<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c9314ed9f88cee6995a16442e0924bf2e30a">RPMSIGTAG_LEMD5_1</a> =  1001, 
<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c9318aeb48036aa9ad771643a62646e523a3">RPMSIGTAG_PGP</a> =  1002, 
<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c93133562c18d7a91ed0a558b67a1a340fff">RPMSIGTAG_LEMD5_2</a> =  1003, 
<br>
&nbsp;&nbsp;<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c931771f9e86ff018c23e1ba924deb6d0a2d">RPMSIGTAG_MD5</a> =  1004, 
<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c931cafcdd43174c21af59f624588be6c8ac">RPMSIGTAG_GPG</a> =  1005, 
<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c9310343f0ef12296e27046773dd9042ed8c">RPMSIGTAG_PGP5</a> =  1006, 
<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c93105739f171824a615714ff2e056616c60">RPMSIGTAG_PAYLOADSIZE</a> =  1007, 
<br>
&nbsp;&nbsp;<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c931899d21f6c30441791de437a459cd249c">RPMSIGTAG_BADSHA1_1</a> =  RPMTAG_BADSHA1_1, 
<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c9314407b497af22607ced8a0726bc04a1ad">RPMSIGTAG_BADSHA1_2</a> =  RPMTAG_BADSHA1_2, 
<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c931ab3ad30e0cccc2b4cab52d3fda68a6b7">RPMSIGTAG_SHA1</a> =  RPMTAG_SHA1HEADER, 
<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c9311071614e4c22173beb7909f3bf8df6f2">RPMSIGTAG_DSA</a> =  RPMTAG_DSAHEADER, 
<br>
&nbsp;&nbsp;<a class="el" href="group__signature.html#gg2c705e9138aa336a57ab3198bf40c93107f683ae18b9f79fc568f40e6a6a70be">RPMSIGTAG_RSA</a> =  RPMTAG_RSAHEADER
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tags found in signature header from package.  <a href="group__signature.html#g2c705e9138aa336a57ab3198bf40c931">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g0057ca9b565ec097c7e80dc7640a9196">rpmVerifySignature</a> (const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, char *result)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify a signature from a package.  <a href="#g0057ca9b565ec097c7e80dc7640a9196"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#gc8c1b815975de5d320d36eb5d6ae032d">rpmFreeSignature</a> (<a class="el" href="structheaderToken__s.html">Header</a> h)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy signature header from package.  <a href="#gc8c1b815975de5d320d36eb5d6ae032d"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef enum <a class="el" href="group__signature.html#g756c202de50032237c4268d4e27af15b">sigType_e</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g2104c37f6609aab12980d46c54299008">sigType</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Signature types stored in rpm lead.  <a href="#g2104c37f6609aab12980d46c54299008"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef enum <a class="el" href="group__signature.html#g1ad71af6d3ac7d98df0aad42170200bb">pgpVersion_e</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#gfa8ccac086339aaef67c9ff8497e9798">pgpVersion</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Identify PGP versions.  <a href="#gfa8ccac086339aaef67c9ff8497e9798"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g756c202de50032237c4268d4e27af15b">sigType_e</a> { <a class="el" href="group__signature.html#gg756c202de50032237c4268d4e27af15bd4fee221c06b291b91af2dd0f52ed04a">RPMSIGTYPE_HEADERSIG</a> =  5
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Signature types stored in rpm lead.  <a href="group__signature.html#g756c202de50032237c4268d4e27af15b">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g1ad71af6d3ac7d98df0aad42170200bb">pgpVersion_e</a> { <a class="el" href="group__signature.html#gg1ad71af6d3ac7d98df0aad42170200bbcffdb0cecb8f79c69c6834720f2c8cf6">PGP_NOTDETECTED</a> =  -1, 
<a class="el" href="group__signature.html#gg1ad71af6d3ac7d98df0aad42170200bbe1a8bde97b24892ca355ae1573caa691">PGP_UNKNOWN</a> =  0, 
<a class="el" href="group__signature.html#gg1ad71af6d3ac7d98df0aad42170200bb86b1e283e69076034c38d6ecd0e0cfa4">PGP_2</a> =  2, 
<a class="el" href="group__signature.html#gg1ad71af6d3ac7d98df0aad42170200bb1b84d869c36aef6833a3ed35b69385bd">PGP_5</a> =  5
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Identify PGP versions.  <a href="group__signature.html#g1ad71af6d3ac7d98df0aad42170200bb">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g7b8d13bd83797ed4e64684d4f128004e">rpmNewSignature</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return new, empty (signature) header instance.  <a href="#g7b8d13bd83797ed4e64684d4f128004e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g0fe8e4ac74a97007c91b911720df2941">rpmReadSignature</a> (<a class="el" href="struct__FD__s.html">FD_t</a> fd, <a class="el" href="structheaderToken__s.html">Header</a> *sighp, <a class="el" href="group__signature.html#g2104c37f6609aab12980d46c54299008">sigType</a> sig_type, const char **msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read (and verify header+payload size) signature header.  <a href="#g0fe8e4ac74a97007c91b911720df2941"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#gaa40d7f97708b8badc11deabb0f35207">rpmWriteSignature</a> (<a class="el" href="struct__FD__s.html">FD_t</a> fd, <a class="el" href="structheaderToken__s.html">Header</a> h)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write signature header.  <a href="#gaa40d7f97708b8badc11deabb0f35207"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g83c70b3fbfde7ba29cdde61689bbb29f">rpmAddSignature</a> (<a class="el" href="structheaderToken__s.html">Header</a> sigh, const char *<a class="el" href="parseScript_8c.html#4f4da8b93048dccc588f5ddc4d7e1561">file</a>, <a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a> sigTag, const char *passPhrase)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate signature(s) from a header+payload file, save in signature header.  <a href="#g83c70b3fbfde7ba29cdde61689bbb29f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g2ff1c79a477fc07e2f8fc46f6f043d2f">rpmLookupSignatureType</a> (int action)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return type of signature needed for signing/building.  <a href="#g2ff1c79a477fc07e2f8fc46f6f043d2f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#g3c5f526587b37055f4f8d481d1e4fb49">rpmGetPassPhrase</a> (const char *prompt, const int sigTag)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a pass phrase using getpass(3), confirm with gpg/pgp helper binaries.  <a href="#g3c5f526587b37055f4f8d481d1e4fb49"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__signature.html#ge2cc77c91f11db1b73b43848dba892d5">rpmDetectPGPVersion</a> (<a class="el" href="group__signature.html#gfa8ccac086339aaef67c9ff8497e9798">pgpVersion</a> *pgpVer)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return path to pgp executable of given type, or NULL when not found.  <a href="#ge2cc77c91f11db1b73b43848dba892d5"></a><br></td></tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="gfa8ccac086339aaef67c9ff8497e9798"></a><!-- doxytag: member="signature.h::pgpVersion" ref="gfa8ccac086339aaef67c9ff8497e9798" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="group__signature.html#g1ad71af6d3ac7d98df0aad42170200bb">pgpVersion_e</a>  <a class="el" href="group__signature.html#gfa8ccac086339aaef67c9ff8497e9798">pgpVersion</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Identify PGP versions. 
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Greater than 0 is a valid PGP version. </dd></dl>

</div>
</div><p>
<a class="anchor" name="g2104c37f6609aab12980d46c54299008"></a><!-- doxytag: member="signature.h::sigType" ref="g2104c37f6609aab12980d46c54299008" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="group__signature.html#g756c202de50032237c4268d4e27af15b">sigType_e</a>  <a class="el" href="group__signature.html#g2104c37f6609aab12980d46c54299008">sigType</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Signature types stored in rpm lead. 
<p>

</div>
</div><p>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="g1ad71af6d3ac7d98df0aad42170200bb"></a><!-- doxytag: member="signature.h::pgpVersion_e" ref="g1ad71af6d3ac7d98df0aad42170200bb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__signature.html#g1ad71af6d3ac7d98df0aad42170200bb">pgpVersion_e</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Identify PGP versions. 
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Greater than 0 is a valid PGP version. </dd></dl>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gg1ad71af6d3ac7d98df0aad42170200bbcffdb0cecb8f79c69c6834720f2c8cf6"></a><!-- doxytag: member="PGP_NOTDETECTED" ref="gg1ad71af6d3ac7d98df0aad42170200bbcffdb0cecb8f79c69c6834720f2c8cf6" args="" -->PGP_NOTDETECTED</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1ad71af6d3ac7d98df0aad42170200bbe1a8bde97b24892ca355ae1573caa691"></a><!-- doxytag: member="PGP_UNKNOWN" ref="gg1ad71af6d3ac7d98df0aad42170200bbe1a8bde97b24892ca355ae1573caa691" args="" -->PGP_UNKNOWN</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1ad71af6d3ac7d98df0aad42170200bb86b1e283e69076034c38d6ecd0e0cfa4"></a><!-- doxytag: member="PGP_2" ref="gg1ad71af6d3ac7d98df0aad42170200bb86b1e283e69076034c38d6ecd0e0cfa4" args="" -->PGP_2</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1ad71af6d3ac7d98df0aad42170200bb1b84d869c36aef6833a3ed35b69385bd"></a><!-- doxytag: member="PGP_5" ref="gg1ad71af6d3ac7d98df0aad42170200bb1b84d869c36aef6833a3ed35b69385bd" args="" -->PGP_5</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="signature_8h-source.html#l00022">22</a> of file <a class="el" href="signature_8h-source.html">signature.h</a>.
</div>
</div><p>
<a class="anchor" name="g2c705e9138aa336a57ab3198bf40c931"></a><!-- doxytag: member="rpmlib.h::rpmtagSignature" ref="g2c705e9138aa336a57ab3198bf40c931" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__signature.html#g2c705e9138aa336a57ab3198bf40c931">rpmtagSignature</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Tags found in signature header from package. 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c931bf2c0cb8b00afc9be9c2ef44c744773e"></a><!-- doxytag: member="RPMSIGTAG_SIZE" ref="gg2c705e9138aa336a57ab3198bf40c931bf2c0cb8b00afc9be9c2ef44c744773e" args="" -->RPMSIGTAG_SIZE</em>&nbsp;</td><td>
internal Header+Payload size in bytes. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c9314ed9f88cee6995a16442e0924bf2e30a"></a><!-- doxytag: member="RPMSIGTAG_LEMD5_1" ref="gg2c705e9138aa336a57ab3198bf40c9314ed9f88cee6995a16442e0924bf2e30a" args="" -->RPMSIGTAG_LEMD5_1</em>&nbsp;</td><td>
internal Broken MD5, take 1 <dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000011">Deprecated:</a></b></dt><dd>legacy. </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c9318aeb48036aa9ad771643a62646e523a3"></a><!-- doxytag: member="RPMSIGTAG_PGP" ref="gg2c705e9138aa336a57ab3198bf40c9318aeb48036aa9ad771643a62646e523a3" args="" -->RPMSIGTAG_PGP</em>&nbsp;</td><td>
internal PGP 2.6.3 signature. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c93133562c18d7a91ed0a558b67a1a340fff"></a><!-- doxytag: member="RPMSIGTAG_LEMD5_2" ref="gg2c705e9138aa336a57ab3198bf40c93133562c18d7a91ed0a558b67a1a340fff" args="" -->RPMSIGTAG_LEMD5_2</em>&nbsp;</td><td>
internal Broken MD5, take 2 <dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000012">Deprecated:</a></b></dt><dd>legacy. </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c931771f9e86ff018c23e1ba924deb6d0a2d"></a><!-- doxytag: member="RPMSIGTAG_MD5" ref="gg2c705e9138aa336a57ab3198bf40c931771f9e86ff018c23e1ba924deb6d0a2d" args="" -->RPMSIGTAG_MD5</em>&nbsp;</td><td>
internal MD5 signature. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c931cafcdd43174c21af59f624588be6c8ac"></a><!-- doxytag: member="RPMSIGTAG_GPG" ref="gg2c705e9138aa336a57ab3198bf40c931cafcdd43174c21af59f624588be6c8ac" args="" -->RPMSIGTAG_GPG</em>&nbsp;</td><td>
internal GnuPG signature. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c9310343f0ef12296e27046773dd9042ed8c"></a><!-- doxytag: member="RPMSIGTAG_PGP5" ref="gg2c705e9138aa336a57ab3198bf40c9310343f0ef12296e27046773dd9042ed8c" args="" -->RPMSIGTAG_PGP5</em>&nbsp;</td><td>
internal PGP5 signature <dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000013">Deprecated:</a></b></dt><dd>legacy. </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c93105739f171824a615714ff2e056616c60"></a><!-- doxytag: member="RPMSIGTAG_PAYLOADSIZE" ref="gg2c705e9138aa336a57ab3198bf40c93105739f171824a615714ff2e056616c60" args="" -->RPMSIGTAG_PAYLOADSIZE</em>&nbsp;</td><td>
internal uncompressed payload size in bytes. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c931899d21f6c30441791de437a459cd249c"></a><!-- doxytag: member="RPMSIGTAG_BADSHA1_1" ref="gg2c705e9138aa336a57ab3198bf40c931899d21f6c30441791de437a459cd249c" args="" -->RPMSIGTAG_BADSHA1_1</em>&nbsp;</td><td>
internal Broken SHA1, take 1. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c9314407b497af22607ced8a0726bc04a1ad"></a><!-- doxytag: member="RPMSIGTAG_BADSHA1_2" ref="gg2c705e9138aa336a57ab3198bf40c9314407b497af22607ced8a0726bc04a1ad" args="" -->RPMSIGTAG_BADSHA1_2</em>&nbsp;</td><td>
internal Broken SHA1, take 2. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c931ab3ad30e0cccc2b4cab52d3fda68a6b7"></a><!-- doxytag: member="RPMSIGTAG_SHA1" ref="gg2c705e9138aa336a57ab3198bf40c931ab3ad30e0cccc2b4cab52d3fda68a6b7" args="" -->RPMSIGTAG_SHA1</em>&nbsp;</td><td>
internal sha1 header digest. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c9311071614e4c22173beb7909f3bf8df6f2"></a><!-- doxytag: member="RPMSIGTAG_DSA" ref="gg2c705e9138aa336a57ab3198bf40c9311071614e4c22173beb7909f3bf8df6f2" args="" -->RPMSIGTAG_DSA</em>&nbsp;</td><td>
internal DSA header signature. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2c705e9138aa336a57ab3198bf40c93107f683ae18b9f79fc568f40e6a6a70be"></a><!-- doxytag: member="RPMSIGTAG_RSA" ref="gg2c705e9138aa336a57ab3198bf40c93107f683ae18b9f79fc568f40e6a6a70be" args="" -->RPMSIGTAG_RSA</em>&nbsp;</td><td>
internal RSA header signature. </td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="rpmlib_8h-source.html#l01206">1206</a> of file <a class="el" href="rpmlib_8h-source.html">rpmlib.h</a>.
</div>
</div><p>
<a class="anchor" name="g756c202de50032237c4268d4e27af15b"></a><!-- doxytag: member="signature.h::sigType_e" ref="g756c202de50032237c4268d4e27af15b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__signature.html#g756c202de50032237c4268d4e27af15b">sigType_e</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Signature types stored in rpm lead. 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gg756c202de50032237c4268d4e27af15bd4fee221c06b291b91af2dd0f52ed04a"></a><!-- doxytag: member="RPMSIGTYPE_HEADERSIG" ref="gg756c202de50032237c4268d4e27af15bd4fee221c06b291b91af2dd0f52ed04a" args="" -->RPMSIGTYPE_HEADERSIG</em>&nbsp;</td><td>
Header style signature </td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="signature_8h-source.html#l00014">14</a> of file <a class="el" href="signature_8h-source.html">signature.h</a>.
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g83c70b3fbfde7ba29cdde61689bbb29f"></a><!-- doxytag: member="signature.h::rpmAddSignature" ref="g83c70b3fbfde7ba29cdde61689bbb29f" args="(Header sigh, const char *file, int_32 sigTag, const char *passPhrase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rpmAddSignature           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td>
          <td class="paramname"> <em>sigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="header_8h.html#ec881c85645bc01204441cbc24e9c025">int_32</a>&nbsp;</td>
          <td class="paramname"> <em>sigTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>passPhrase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate signature(s) from a header+payload file, save in signature header. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sigh</em>&nbsp;</td><td>signature header </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>header+payload file <a class="el" href="structname.html">name</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sigTag</em>&nbsp;</td><td>type of signature(s) to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>passPhrase</em>&nbsp;</td><td>private key pass phrase </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00801">801</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h.html#58ff5c3142f685bf7e95cc0cbfaf49c9">alloca()</a>, <a class="el" href="legacy_8c-source.html#l00148">domd5()</a>, <a class="el" href="hdrinline_8h-source.html#l00315">headerAddEntry()</a>, <a class="el" href="signature_8c-source.html#l00544">makeGPGSignature()</a>, <a class="el" href="signature_8c-source.html#l00697">makeHDRSignature()</a>, <a class="el" href="signature_8c-source.html#l00395">makePGPSignature()</a>, <a class="el" href="header_8h-source.html#l00224">RPM_BIN_TYPE</a>, <a class="el" href="header_8h-source.html#l00221">RPM_INT32_TYPE</a>, <a class="el" href="rpmlib_8h-source.html#l01218">RPMSIGTAG_DSA</a>, <a class="el" href="rpmlib_8h-source.html#l01212">RPMSIGTAG_GPG</a>, <a class="el" href="rpmlib_8h-source.html#l01211">RPMSIGTAG_MD5</a>, <a class="el" href="rpmlib_8h-source.html#l01209">RPMSIGTAG_PGP</a>, <a class="el" href="rpmlib_8h-source.html#l01213">RPMSIGTAG_PGP5</a>, <a class="el" href="rpmlib_8h-source.html#l01219">RPMSIGTAG_RSA</a>, <a class="el" href="rpmlib_8h-source.html#l01217">RPMSIGTAG_SHA1</a>, and <a class="el" href="rpmlib_8h-source.html#l01207">RPMSIGTAG_SIZE</a>.
<p>
Referenced by <a class="el" href="rpmchecksig_8c-source.html#l00172">rpmReSign()</a>, and <a class="el" href="pack_8c-source.html#l00420">writeRPM()</a>.
</div>
</div><p>
<a class="anchor" name="ge2cc77c91f11db1b73b43848dba892d5"></a><!-- doxytag: member="signature.h::rpmDetectPGPVersion" ref="ge2cc77c91f11db1b73b43848dba892d5" args="(pgpVersion *pgpVer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* rpmDetectPGPVersion           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__signature.html#gfa8ccac086339aaef67c9ff8497e9798">pgpVersion</a> *&nbsp;</td>
          <td class="paramname"> <em>pgpVer</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return path to pgp executable of given type, or NULL when not found. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pgpVer</em>&nbsp;</td><td>pgp version </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>path to pgp executable </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00073">73</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="system_8h.html#58ff5c3142f685bf7e95cc0cbfaf49c9">alloca()</a>, <a class="el" href="signature_8h-source.html#l00025">PGP_2</a>, <a class="el" href="signature_8h-source.html#l00026">PGP_5</a>, <a class="el" href="signature_8h-source.html#l00023">PGP_NOTDETECTED</a>, <a class="el" href="signature_8h-source.html#l00024">PGP_UNKNOWN</a>, <a class="el" href="macro_8c-source.html#l02254">rpmGetPath()</a>, and <a class="el" href="system_8h.html#58841684f76853b313e27e663c850381">stpcpy()</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l00854">checkPassPhrase()</a>, <a class="el" href="rpmqv_8c-source.html#l00166">main()</a>, and <a class="el" href="signature_8c-source.html#l00395">makePGPSignature()</a>.
</div>
</div><p>
<a class="anchor" name="gc8c1b815975de5d320d36eb5d6ae032d"></a><!-- doxytag: member="rpmlib.h::rpmFreeSignature" ref="gc8c1b815975de5d320d36eb5d6ae032d" args="(Header h)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structheaderToken__s.html">Header</a> rpmFreeSignature           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td>
          <td class="paramname"> <em>h</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destroy signature header from package. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>signature header </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>NULL always </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00381">381</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="hdrinline_8h-source.html#l00047">headerFree()</a>.
<p>
Referenced by <a class="el" href="psm_8c-source.html#l01355">rpmpsmStage()</a>, <a class="el" href="package_8c-source.html#l00748">rpmReadPackageFile()</a>, <a class="el" href="rpmchecksig_8c-source.html#l00172">rpmReSign()</a>, <a class="el" href="rpmchecksig_8c-source.html#l00721">rpmVerifySignatures()</a>, and <a class="el" href="pack_8c-source.html#l00420">writeRPM()</a>.
</div>
</div><p>
<a class="anchor" name="g3c5f526587b37055f4f8d481d1e4fb49"></a><!-- doxytag: member="signature.h::rpmGetPassPhrase" ref="g3c5f526587b37055f4f8d481d1e4fb49" args="(const char *prompt, const int sigTag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* rpmGetPassPhrase           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>prompt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>sigTag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read a pass phrase using getpass(3), confirm with gpg/pgp helper binaries. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>prompt</em>&nbsp;</td><td>user prompt </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sigTag</em>&nbsp;</td><td>signature type/tag </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>pass phrase </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00965">965</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="signature_8c-source.html#l00854">checkPassPhrase()</a>, <a class="el" href="rpmerr_8h-source.html#l00128">RPMERR_SIGGEN</a>, <a class="el" href="rpmerr_8h-source.html#l00143">rpmError</a>, <a class="el" href="macro_8c-source.html#l02116">rpmExpand()</a>, <a class="el" href="rpmlib_8h-source.html#l01218">RPMSIGTAG_DSA</a>, <a class="el" href="rpmlib_8h-source.html#l01212">RPMSIGTAG_GPG</a>, <a class="el" href="rpmlib_8h-source.html#l01209">RPMSIGTAG_PGP</a>, <a class="el" href="rpmlib_8h-source.html#l01213">RPMSIGTAG_PGP5</a>, and <a class="el" href="rpmlib_8h-source.html#l01219">RPMSIGTAG_RSA</a>.
<p>
Referenced by <a class="el" href="rpmqv_8c-source.html#l00166">main()</a>.
</div>
</div><p>
<a class="anchor" name="g2ff1c79a477fc07e2f8fc46f6f043d2f"></a><!-- doxytag: member="signature.h::rpmLookupSignatureType" ref="g2ff1c79a477fc07e2f8fc46f6f043d2f" args="(int action)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rpmLookupSignatureType           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>action</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return type of signature needed for signing/building. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>action</em>&nbsp;</td><td>enable/disable/query action </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>sigTag to use, 0 if none, -1 on error </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00033">33</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="macro_8c-source.html#l02116">rpmExpand()</a>, <a class="el" href="signature_8h-source.html#l00083">RPMLOOKUPSIG_DISABLE</a>, <a class="el" href="signature_8h-source.html#l00084">RPMLOOKUPSIG_ENABLE</a>, <a class="el" href="signature_8h-source.html#l00082">RPMLOOKUPSIG_QUERY</a>, <a class="el" href="rpmlib_8h-source.html#l01212">RPMSIGTAG_GPG</a>, <a class="el" href="rpmlib_8h-source.html#l01209">RPMSIGTAG_PGP</a>, and <a class="el" href="strcasecmp_8c-source.html#l00009">xstrcasecmp()</a>.
<p>
Referenced by <a class="el" href="rpmqv_8c-source.html#l00166">main()</a>, <a class="el" href="rpmchecksig_8c-source.html#l00172">rpmReSign()</a>, and <a class="el" href="pack_8c-source.html#l00420">writeRPM()</a>.
</div>
</div><p>
<a class="anchor" name="g7b8d13bd83797ed4e64684d4f128004e"></a><!-- doxytag: member="signature.h::rpmNewSignature" ref="g7b8d13bd83797ed4e64684d4f128004e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structheaderToken__s.html">Header</a> rpmNewSignature           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return new, empty (signature) header instance. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>signature header </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00375">375</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="hdrinline_8h-source.html#l00035">headerNew()</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00178">headerRegenSigHeader()</a>, and <a class="el" href="pack_8c-source.html#l00420">writeRPM()</a>.
</div>
</div><p>
<a class="anchor" name="g0fe8e4ac74a97007c91b911720df2941"></a><!-- doxytag: member="signature.h::rpmReadSignature" ref="g0fe8e4ac74a97007c91b911720df2941" args="(FD_t fd, Header *sighp, sigType sig_type, const char **msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> rpmReadSignature           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__FD__s.html">FD_t</a>&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structheaderToken__s.html">Header</a> *&nbsp;</td>
          <td class="paramname"> <em>sighp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__signature.html#g2104c37f6609aab12980d46c54299008">sigType</a>&nbsp;</td>
          <td class="paramname"> <em>sig_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>msg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read (and verify header+payload size) signature header. 
<p>
If an old-style signature is found, we emulate a new style one. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>file handle </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sighp</em>&nbsp;</td><td>address of (signature) header (or NULL) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sig_type</em>&nbsp;</td><td>type of signature header to read (from lead) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>failure msg </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>rpmRC return code </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00155">155</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="system_8h.html#58ff5c3142f685bf7e95cc0cbfaf49c9">alloca()</a>, <a class="el" href="lparser_8c-source.html#l00952">block()</a>, <a class="el" href="header__internal_8h-source.html#l00064">headerToken_s::flags</a>, <a class="el" href="package_8c-source.html#l00044">header_magic</a>, <a class="el" href="header_8h-source.html#l00209">HEADER_MAGIC_YES</a>, <a class="el" href="header__internal_8h-source.html#l00066">HEADERFLAG_ALLOCATED</a>, <a class="el" href="hdrinline_8h-source.html#l00047">headerFree()</a>, <a class="el" href="hdrinline_8h-source.html#l00268">headerGetEntry()</a>, <a class="el" href="hdrinline_8h-source.html#l00062">headerLink()</a>, <a class="el" href="hdrinline_8h-source.html#l00175">headerLoad()</a>, <a class="el" href="hdrinline_8h-source.html#l00120">headerSizeof()</a>, <a class="el" href="package_8c-source.html#l00281">headerVerifyInfo()</a>, <a class="el" href="signature_8c-source.html#l00122">printSize()</a>, <a class="el" href="header__internal_8h-source.html#l00034">REGION_TAG_COUNT</a>, <a class="el" href="header_8h-source.html#l00224">RPM_BIN_TYPE</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>, <a class="el" href="rpmlib_8h-source.html#l01207">RPMSIGTAG_SIZE</a>, <a class="el" href="signature_8h-source.html#l00015">RPMSIGTYPE_HEADERSIG</a>, <a class="el" href="rpmlib_8h-source.html#l00234">RPMTAG_HEADERIMAGE</a>, <a class="el" href="rpmlib_8h-source.html#l00235">RPMTAG_HEADERSIGNATURES</a>, <a class="el" href="rpmps_8c-source.html#l00182">snprintf()</a>, <a class="el" href="rpmio_8h-source.html#l00640">timedRead</a>, <a class="el" href="rpmmalloc_8c-source.html#l00024">xmalloc()</a>, and <a class="el" href="rpmmalloc_8c-source.html#l00055">xstrdup()</a>.
<p>
Referenced by <a class="el" href="rpmtool_8c-source.html#l00275">main()</a>, <a class="el" href="package_8c-source.html#l00748">rpmReadPackageFile()</a>, <a class="el" href="rpmchecksig_8c-source.html#l00172">rpmReSign()</a>, and <a class="el" href="rpmchecksig_8c-source.html#l00721">rpmVerifySignatures()</a>.
</div>
</div><p>
<a class="anchor" name="g0057ca9b565ec097c7e80dc7640a9196"></a><!-- doxytag: member="rpmlib.h::rpmVerifySignature" ref="g0057ca9b565ec097c7e80dc7640a9196" args="(const rpmts ts, char *result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> rpmVerifySignature           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Verify a signature from a package. 
<p>
This needs the following variables from the transaction set:<ul>
<li>ts-&gt;sigtag type of signature</li><li>ts-&gt;sig signature itself (from signature header)</li><li>ts-&gt;siglen no. of bytes in signature</li><li>ts-&gt;dig signature/pubkey parameters (malloc'd workspace)</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ts</em>&nbsp;</td><td>transaction set </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>result</em>&nbsp;</td><td>detailed text result of signature verification </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>result of signature verification </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l01486">1486</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmio__internal_8h-source.html#l00052">pgpDigParams_s::hash_algo</a>, <a class="el" href="rpmio__internal_8h-source.html#l00083">pgpDig_s::hdrmd5ctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00075">pgpDig_s::hdrsha1ctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00081">pgpDig_s::md5ctx</a>, <a class="el" href="rpmpgp_8h-source.html#l00285">PGPHASHALGO_MD5</a>, <a class="el" href="rpmlib_8h-source.html#l00022">RPMRC_NOTFOUND</a>, <a class="el" href="rpmlib_8h-source.html#l01218">RPMSIGTAG_DSA</a>, <a class="el" href="rpmlib_8h-source.html#l01212">RPMSIGTAG_GPG</a>, <a class="el" href="rpmlib_8h-source.html#l01208">RPMSIGTAG_LEMD5_1</a>, <a class="el" href="rpmlib_8h-source.html#l01210">RPMSIGTAG_LEMD5_2</a>, <a class="el" href="rpmlib_8h-source.html#l01211">RPMSIGTAG_MD5</a>, <a class="el" href="rpmlib_8h-source.html#l01209">RPMSIGTAG_PGP</a>, <a class="el" href="rpmlib_8h-source.html#l01213">RPMSIGTAG_PGP5</a>, <a class="el" href="rpmlib_8h-source.html#l01219">RPMSIGTAG_RSA</a>, <a class="el" href="rpmlib_8h-source.html#l01217">RPMSIGTAG_SHA1</a>, <a class="el" href="rpmlib_8h-source.html#l01207">RPMSIGTAG_SIZE</a>, <a class="el" href="rpmts_8c-source.html#l01171">rpmtsDig()</a>, <a class="el" href="rpmts_8c-source.html#l01139">rpmtsSig()</a>, <a class="el" href="rpmts_8c-source.html#l01147">rpmtsSiglen()</a>, <a class="el" href="rpmts_8c-source.html#l01123">rpmtsSigtag()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00073">pgpDig_s::sha1ctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00067">pgpDig_s::signature</a>, <a class="el" href="signature_8c-source.html#l01390">verifyDSASignature()</a>, <a class="el" href="signature_8c-source.html#l01072">verifyMD5Signature()</a>, <a class="el" href="signature_8c-source.html#l01206">verifyRSASignature()</a>, <a class="el" href="signature_8c-source.html#l01131">verifySHA1Signature()</a>, and <a class="el" href="signature_8c-source.html#l01035">verifySizeSignature()</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00748">rpmReadPackageFile()</a>, and <a class="el" href="rpmchecksig_8c-source.html#l00721">rpmVerifySignatures()</a>.
</div>
</div><p>
<a class="anchor" name="gaa40d7f97708b8badc11deabb0f35207"></a><!-- doxytag: member="signature.h::rpmWriteSignature" ref="gaa40d7f97708b8badc11deabb0f35207" args="(FD_t fd, Header h)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rpmWriteSignature           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__FD__s.html">FD_t</a>&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td>
          <td class="paramname"> <em>h</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write signature header. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>file handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>(signature) header </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, 1 on error </dd></dl>

<p>
Definition at line <a class="el" href="signature_8c-source.html#l00353">353</a> of file <a class="el" href="signature_8c-source.html">signature.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmio_8c-source.html#l02846">Fwrite()</a>, <a class="el" href="header_8h-source.html#l00209">HEADER_MAGIC_YES</a>, <a class="el" href="hdrinline_8h-source.html#l00120">headerSizeof()</a>, <a class="el" href="hdrinline_8h-source.html#l00214">headerWrite()</a>, <a class="el" href="rpmmessages_8h-source.html#l00011">RPMMESS_DEBUG</a>, and <a class="el" href="rpmmessages_8h-source.html#l00020">rpmMessage</a>.
<p>
Referenced by <a class="el" href="psm_8c-source.html#l01355">rpmpsmStage()</a>, <a class="el" href="rpmchecksig_8c-source.html#l00172">rpmReSign()</a>, and <a class="el" href="pack_8c-source.html#l00420">writeRPM()</a>.
</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Oct 12 08:44:57 2007 for rpm by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
