<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>rpm: lib/package.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul>
</div>
<h1>lib/package.c File Reference</h1><code>#include &quot;<a class="el" href="system_8h-source.html">system.h</a>&quot;</code><br>
<code>#include &lt;netinet/in.h&gt;</code><br>
<code>#include &lt;<a class="el" href="rpmio__internal_8h-source.html">rpmio_internal.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="rpmlib_8h-source.html">rpmlib.h</a>&gt;</code><br>
<code>#include &quot;<a class="el" href="rpmts_8h-source.html">rpmts.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="misc_8h-source.html">misc.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="legacy_8h-source.html">legacy.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="rpmlead_8h-source.html">rpmlead.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="header__internal_8h-source.html">header_internal.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="signature_8h-source.html">signature.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="debug_8h-source.html">debug.h</a>&quot;</code><br>

<p>
<a href="package_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#0e6c36aa207979a118f67d4ddb341fce">alloca_strdup</a>(_s)&nbsp;&nbsp;&nbsp;strcpy(alloca(strlen(_s)+1), (_s))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#5a4115ad1f3efe3fbda6218d6132ba14">hdrchkTags</a>(_ntags)&nbsp;&nbsp;&nbsp;((_ntags) &amp; 0xffff0000)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sanity check on no.  <a href="#5a4115ad1f3efe3fbda6218d6132ba14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#e1ad42464a20425abacf59456acd27dd">hdrchkType</a>(_type)&nbsp;&nbsp;&nbsp;((_type) &lt; RPM_MIN_TYPE || (_type) &gt; RPM_MAX_TYPE)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sanity check on type values.  <a href="#e1ad42464a20425abacf59456acd27dd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#9caa0fb536c6839c19e081476b48fc51">hdrchkData</a>(_nbytes)&nbsp;&nbsp;&nbsp;((_nbytes) &amp; 0xff000000)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sanity check on data size and/or offset and/or count.  <a href="#9caa0fb536c6839c19e081476b48fc51"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#3274da9994c1298b79452ac2fa84b23a">hdrchkAlign</a>(_type, _off)&nbsp;&nbsp;&nbsp;((_off) &amp; (<a class="el" href="group__header.html#g95fa690843429c2a518b13150729cfac">typeAlign</a>[_type]-1))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sanity check on data alignment for data type.  <a href="#3274da9994c1298b79452ac2fa84b23a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#13ce7868c9389b672524dc12e7ba550a">hdrchkRange</a>(_dl, _off)&nbsp;&nbsp;&nbsp;((_off) &lt; 0 || (_off) &gt; (_dl))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sanity check on range of data offset.  <a href="#13ce7868c9389b672524dc12e7ba550a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#372388230d60c5ff6cae83ce233865ca">_chk</a>(_mask)&nbsp;&nbsp;&nbsp;(sigtag == 0 &amp;&amp; !(<a class="el" href="rpmgraph_8c.html#8338952a29222460c2bc12c9545e5241">vsflags</a> &amp; (_mask)))</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__header.html#gb0d069249abe3ae321f175e32f353164">headerMergeLegacySigs</a> (<a class="el" href="structheaderToken__s.html">Header</a> h, const <a class="el" href="structheaderToken__s.html">Header</a> sigh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Translate and merge legacy signature tags into header.  <a href="group__header.html#gb0d069249abe3ae321f175e32f353164"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__header.html#g222a4880487e9a0500a058d4e2e20784">headerRegenSigHeader</a> (const <a class="el" href="structheaderToken__s.html">Header</a> h, int noArchiveSize)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Regenerate signature header.  <a href="group__header.html#g222a4880487e9a0500a058d4e2e20784"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#e6ae2a65259638005b456c01f5d8eb0d">rpmtsStashKeyid</a> (<a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remember current key id.  <a href="#e6ae2a65259638005b456c01f5d8eb0d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#cdec739fc16ab9017bc3da6edd8e1b37">headerVerifyInfo</a> (int il, int dl, const void *pev, void *iv, int negate)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Perform simple sanity and range checks on header tag(s).  <a href="#cdec739fc16ab9017bc3da6edd8e1b37"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#abf649f1a539bc4315e8f4f6f301af3e">headerCheck</a> (<a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, const void *uh, size_t uc, const char **msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check header consistency, performing <a class="el" href="group__header.html#gddebc5eb6a9605829e11a5b356b36d33" title="Retrieve tag value.">headerGetEntry()</a> the hard way.  <a href="#abf649f1a539bc4315e8f4f6f301af3e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#e2775648b3d7a30b9902566017b16070">rpmReadHeader</a> (<a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, <a class="el" href="struct__FD__s.html">FD_t</a> fd, <a class="el" href="structheaderToken__s.html">Header</a> *hdrp, const char **msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return checked and loaded header.  <a href="#e2775648b3d7a30b9902566017b16070"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#6c5d130a0a25cf475d18a269e3438cee">rpmReadPackageFile</a> (<a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a> ts, <a class="el" href="struct__FD__s.html">FD_t</a> fd, const char *fn, <a class="el" href="structheaderToken__s.html">Header</a> *hdrp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return package header from file handle, verifying digests/signatures.  <a href="#6c5d130a0a25cf475d18a269e3438cee"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#5918514711d1c2eb1739294b3265e1ce">headerCheckPayloadFormat</a> (<a class="el" href="structheaderToken__s.html">Header</a> h)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check for supported payload format in header.  <a href="#5918514711d1c2eb1739294b3265e1ce"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#751ebc9b28c168fda034b5a6b5b25722">_print_pkts</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#4dd70aef76799c6e3f3b455aac77d78e">nkeyids_max</a> = 256</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#f09cce9e3e2bdef272ab28ab6acc3843">nkeyids</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#d7f8bc9937b87df00aa88bdde50557d6">nextkeyid</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned int *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#4ef959fa1d9d2126f229e52aeb27a2a2">keyids</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#739b796ffa0a2e9218383068dc83b215">header_magic</a> [8]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="package_8c.html#95fa690843429c2a518b13150729cfac">typeAlign</a> [16]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Alignment needs (and sizeof scalars types) for internal rpm data types.  <a href="#95fa690843429c2a518b13150729cfac"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>
Definition in file <a class="el" href="package_8c-source.html">package.c</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="372388230d60c5ff6cae83ce233865ca"></a><!-- doxytag: member="package.c::_chk" ref="372388230d60c5ff6cae83ce233865ca" args="(_mask)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _chk          </td>
          <td>(</td>
          <td class="paramtype">_mask&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;(sigtag == 0 &amp;&amp; !(<a class="el" href="rpmgraph_8c.html#8338952a29222460c2bc12c9545e5241">vsflags</a> &amp; (_mask)))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Referenced by <a class="el" href="package_8c-source.html#l00748">rpmReadPackageFile()</a>.
</div>
</div><p>
<a class="anchor" name="0e6c36aa207979a118f67d4ddb341fce"></a><!-- doxytag: member="package.c::alloca_strdup" ref="0e6c36aa207979a118f67d4ddb341fce" args="(_s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define alloca_strdup          </td>
          <td>(</td>
          <td class="paramtype">_s&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;strcpy(alloca(strlen(_s)+1), (_s))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00022">22</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
</div>
</div><p>
<a class="anchor" name="3274da9994c1298b79452ac2fa84b23a"></a><!-- doxytag: member="package.c::hdrchkAlign" ref="3274da9994c1298b79452ac2fa84b23a" args="(_type, _off)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define hdrchkAlign          </td>
          <td>(</td>
          <td class="paramtype">_type,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_off&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((_off) &amp; (<a class="el" href="group__header.html#g95fa690843429c2a518b13150729cfac">typeAlign</a>[_type]-1))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sanity check on data alignment for data type. 
<p>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00091">91</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00281">headerVerifyInfo()</a>, and <a class="el" href="header_8c-source.html#l00473">regionSwab()</a>.
</div>
</div><p>
<a class="anchor" name="9caa0fb536c6839c19e081476b48fc51"></a><!-- doxytag: member="package.c::hdrchkData" ref="9caa0fb536c6839c19e081476b48fc51" args="(_nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define hdrchkData          </td>
          <td>(</td>
          <td class="paramtype">_nbytes&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((_nbytes) &amp; 0xff000000)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sanity check on data size and/or offset and/or count. 
<p>
This check imposes a limit of 16 MB, more than enough. 
<p>
Definition at line <a class="el" href="package_8c-source.html#l00086">86</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="header_8c-source.html#l00608">doHeaderUnload()</a>, <a class="el" href="package_8c-source.html#l00098">headerMergeLegacySigs()</a>, <a class="el" href="package_8c-source.html#l00281">headerVerifyInfo()</a>, <a class="el" href="header_8c-source.html#l00473">regionSwab()</a>, and <a class="el" href="package_8c-source.html#l00650">rpmReadHeader()</a>.
</div>
</div><p>
<a class="anchor" name="13ce7868c9389b672524dc12e7ba550a"></a><!-- doxytag: member="package.c::hdrchkRange" ref="13ce7868c9389b672524dc12e7ba550a" args="(_dl, _off)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define hdrchkRange          </td>
          <td>(</td>
          <td class="paramtype">_dl,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_off&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((_off) &lt; 0 || (_off) &gt; (_dl))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sanity check on range of data offset. 
<p>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00096">96</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00281">headerVerifyInfo()</a>.
</div>
</div><p>
<a class="anchor" name="5a4115ad1f3efe3fbda6218d6132ba14"></a><!-- doxytag: member="package.c::hdrchkTags" ref="5a4115ad1f3efe3fbda6218d6132ba14" args="(_ntags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define hdrchkTags          </td>
          <td>(</td>
          <td class="paramtype">_ntags&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((_ntags) &amp; 0xffff0000)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sanity check on no. 
<p>
of tags. This check imposes a limit of 65K tags, more than enough. 
<p>
Definition at line <a class="el" href="package_8c-source.html#l00075">75</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="header_8c-source.html#l00608">doHeaderUnload()</a>, and <a class="el" href="package_8c-source.html#l00650">rpmReadHeader()</a>.
</div>
</div><p>
<a class="anchor" name="e1ad42464a20425abacf59456acd27dd"></a><!-- doxytag: member="package.c::hdrchkType" ref="e1ad42464a20425abacf59456acd27dd" args="(_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define hdrchkType          </td>
          <td>(</td>
          <td class="paramtype">_type&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((_type) &lt; RPM_MIN_TYPE || (_type) &gt; RPM_MAX_TYPE)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sanity check on type values. 
<p>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00080">80</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00098">headerMergeLegacySigs()</a>, <a class="el" href="package_8c-source.html#l00281">headerVerifyInfo()</a>, and <a class="el" href="header_8c-source.html#l00473">regionSwab()</a>.
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="abf649f1a539bc4315e8f4f6f301af3e"></a><!-- doxytag: member="package.c::headerCheck" ref="abf649f1a539bc4315e8f4f6f301af3e" args="(rpmts ts, const void *uh, size_t uc, const char **msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> headerCheck           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>uh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>uc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>msg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check header consistency, performing <a class="el" href="group__header.html#gddebc5eb6a9605829e11a5b356b36d33" title="Retrieve tag value.">headerGetEntry()</a> the hard way. 
<p>
Sanity checks on the header are performed while looking for a header-only digest or signature to verify the blob. If found, the digest or signature is verified.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ts</em>&nbsp;</td><td>transaction set </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>uh</em>&nbsp;</td><td>unloaded header blob </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>uc</em>&nbsp;</td><td>no. of bytes in blob (or 0 to disable) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*msg</em>&nbsp;</td><td>signature verification msg </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>RPMRC_OK/RPMRC_NOTFOUND/RPMRC_FAIL </dd></dl>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00325">325</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="system_8h.html#58ff5c3142f685bf7e95cc0cbfaf49c9">alloca()</a>, <a class="el" href="package_8c-source.html#l00281">headerVerifyInfo()</a>, <a class="el" href="header__internal_8h-source.html#l00034">REGION_TAG_COUNT</a>, <a class="el" href="header_8h-source.html#l00224">RPM_BIN_TYPE</a>, <a class="el" href="header_8h-source.html#l00223">RPM_STRING_TYPE</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00022">RPMRC_NOTFOUND</a>, <a class="el" href="rpmlib_8h-source.html#l00236">RPMTAG_HEADERIMMUTABLE</a>, <a class="el" href="rpmlib_8h-source.html#l00261">RPMTAG_SHA1HEADER</a>, <a class="el" href="rpmts_8c-source.html#l00909">rpmtsVSFlags()</a>, <a class="el" href="rpmts_8h-source.html#l00030">RPMVSF_NOSHA1HEADER</a>, <a class="el" href="rpmps_8c-source.html#l00182">snprintf()</a>, and <a class="el" href="rpmcache_8c-source.html#l00511">vsflags</a>.
<p>
Referenced by <a class="el" href="psm_8c-source.html#l01355">rpmpsmStage()</a>, <a class="el" href="package_8c-source.html#l00650">rpmReadHeader()</a>, <a class="el" href="rpmts-py_8c-source.html#l00811">rpmts_HdrCheck()</a>, <a class="el" href="rpmts_8c-source.html#l00256">rpmtsInitIterator()</a>, and <a class="el" href="rpmts_8c-source.html#l00203">rpmtsRebuildDB()</a>.
</div>
</div><p>
<a class="anchor" name="5918514711d1c2eb1739294b3265e1ce"></a><!-- doxytag: member="package.c::headerCheckPayloadFormat" ref="5918514711d1c2eb1739294b3265e1ce" args="(Header h)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> headerCheckPayloadFormat           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structheaderToken__s.html">Header</a>&nbsp;</td>
          <td class="paramname"> <em>h</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check for supported payload format in header. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>header to check </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>RPMRC_OK if supported, RPMRC_FAIL otherwise </dd></dl>

<p>
Definition at line <a class="el" href="package_8c-source.html#l01075">1075</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="hdrinline_8h-source.html#l00268">headerGetEntry()</a>, <a class="el" href="rpmts_8c-source.html#l00090">hGetNEVRA()</a>, <a class="el" href="rpmmessages_8h-source.html#l00015">RPMMESS_ERROR</a>, <a class="el" href="rpmmessages_8h-source.html#l00020">rpmMessage</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>, and <a class="el" href="rpmlib_8h-source.html#l00407">RPMTAG_PAYLOADFORMAT</a>.
<p>
Referenced by <a class="el" href="depends_8c-source.html#l00127">rpmtsAddInstallElement()</a>.
</div>
</div><p>
<a class="anchor" name="cdec739fc16ab9017bc3da6edd8e1b37"></a><!-- doxytag: member="package.c::headerVerifyInfo" ref="cdec739fc16ab9017bc3da6edd8e1b37" args="(int il, int dl, const void *pev, void *iv, int negate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int headerVerifyInfo           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>il</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>pev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>negate</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Perform simple sanity and range checks on header tag(s). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>il</em>&nbsp;</td><td>no. of tags in header </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dl</em>&nbsp;</td><td>no. of bytes in header data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pev</em>&nbsp;</td><td>1st element in tag array, big-endian </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iv</em>&nbsp;</td><td>failing (or last) tag element, host-endian </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negate</em>&nbsp;</td><td>negative offset expected? </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>-1 on success, otherwise failing tag element index </dd></dl>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00281">281</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
References <a class="el" href="header__internal_8h-source.html#l00030">entryInfo_s::count</a>, <a class="el" href="package_8c-source.html#l00091">hdrchkAlign</a>, <a class="el" href="package_8c-source.html#l00086">hdrchkData</a>, <a class="el" href="package_8c-source.html#l00096">hdrchkRange</a>, <a class="el" href="package_8c-source.html#l00080">hdrchkType</a>, <a class="el" href="header__internal_8h-source.html#l00029">entryInfo_s::offset</a>, <a class="el" href="header__internal_8h-source.html#l00027">entryInfo_s::tag</a>, and <a class="el" href="header__internal_8h-source.html#l00028">entryInfo_s::type</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00325">headerCheck()</a>, and <a class="el" href="signature_8c-source.html#l00155">rpmReadSignature()</a>.
</div>
</div><p>
<a class="anchor" name="e2775648b3d7a30b9902566017b16070"></a><!-- doxytag: member="package.c::rpmReadHeader" ref="e2775648b3d7a30b9902566017b16070" args="(rpmts ts, FD_t fd, Header *hdrp, const char **msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> rpmReadHeader           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__FD__s.html">FD_t</a>&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structheaderToken__s.html">Header</a> *&nbsp;</td>
          <td class="paramname"> <em>hdrp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>msg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return checked and loaded header. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ts</em>&nbsp;</td><td>transaction set </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>file handle </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hdrp</em>&nbsp;</td><td>address of header (or NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>*msg</em>&nbsp;</td><td>verification error message (or NULL) </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>RPMRC_OK on success </dd></dl>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00650">650</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="lparser_8c-source.html#l00952">block()</a>, <a class="el" href="header__internal_8h-source.html#l00064">headerToken_s::flags</a>, <a class="el" href="package_8c-source.html#l00086">hdrchkData</a>, <a class="el" href="package_8c-source.html#l00075">hdrchkTags</a>, <a class="el" href="package_8c-source.html#l00044">header_magic</a>, <a class="el" href="package_8c-source.html#l00325">headerCheck()</a>, <a class="el" href="header__internal_8h-source.html#l00066">HEADERFLAG_ALLOCATED</a>, <a class="el" href="hdrinline_8h-source.html#l00047">headerFree()</a>, <a class="el" href="hdrinline_8h-source.html#l00062">headerLink()</a>, <a class="el" href="hdrinline_8h-source.html#l00175">headerLoad()</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>, <a class="el" href="rpmps_8c-source.html#l00182">snprintf()</a>, <a class="el" href="rpmio_8h-source.html#l00640">timedRead</a>, <a class="el" href="rpmmalloc_8c-source.html#l00024">xmalloc()</a>, and <a class="el" href="rpmmalloc_8c-source.html#l00055">xstrdup()</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00748">rpmReadPackageFile()</a>.
</div>
</div><p>
<a class="anchor" name="6c5d130a0a25cf475d18a269e3438cee"></a><!-- doxytag: member="package.c::rpmReadPackageFile" ref="6c5d130a0a25cf475d18a269e3438cee" args="(rpmts ts, FD_t fd, const char *fn, Header *hdrp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmlib_8h.html#f1718b0bac61cc03eaf3e3cb02806fb3">rpmRC</a> rpmReadPackageFile           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__FD__s.html">FD_t</a>&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structheaderToken__s.html">Header</a> *&nbsp;</td>
          <td class="paramname"> <em>hdrp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return package header from file handle, verifying digests/signatures. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ts</em>&nbsp;</td><td>transaction set </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>file handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fn</em>&nbsp;</td><td>file <a class="el" href="structname.html">name</a> </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hdrp</em>&nbsp;</td><td>address of header (or NULL) </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>RPMRC_OK on success </dd></dl>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000021">Todo:</a></b></dt><dd>Implement disable/enable/warn/error/anal policy. </dd></dl>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00748">748</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="package_8c.html#372388230d60c5ff6cae83ce233865ca">_chk</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="package_8c-source.html#l00032">_print_pkts</a>, <a class="el" href="system_8h.html#58ff5c3142f685bf7e95cc0cbfaf49c9">alloca()</a>, <a class="el" href="header__internal_8h-source.html#l00030">entryInfo_s::count</a>, <a class="el" href="rpmsw_8h-source.html#l00035">rpmop_s::count</a>, <a class="el" href="rpmio__internal_8h-source.html#l00174">_FD_s::digests</a>, <a class="el" href="rpmio__internal_8h-source.html#l00533">fdInitDigest()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00118">FDSTAT_READ</a>, <a class="el" href="rpmio_8c-source.html#l03316">Fileno()</a>, <a class="el" href="rpmio_8c-source.html#l02824">Fread()</a>, <a class="el" href="rpmio_8c-source.html#l02813">Fstrerror()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00052">pgpDigParams_s::hash_algo</a>, <a class="el" href="rpmio__internal_8h-source.html#l00136">_FDDIGEST_s::hashalgo</a>, <a class="el" href="rpmio__internal_8h-source.html#l00137">_FDDIGEST_s::hashctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00083">pgpDig_s::hdrmd5ctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00075">pgpDig_s::hdrsha1ctx</a>, <a class="el" href="package_8c-source.html#l00044">header_magic</a>, <a class="el" href="hdrinline_8h-source.html#l00047">headerFree()</a>, <a class="el" href="header_8h-source.html#l00704">headerFreeData()</a>, <a class="el" href="hdrinline_8h-source.html#l00268">headerGetEntry()</a>, <a class="el" href="hdrinline_8h-source.html#l00230">headerIsEntry()</a>, <a class="el" href="hdrinline_8h-source.html#l00062">headerLink()</a>, <a class="el" href="package_8c-source.html#l00098">headerMergeLegacySigs()</a>, <a class="el" href="legacy_8c-source.html#l00530">legacyRetrofit()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00081">pgpDig_s::md5ctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00070">pgpDig_s::nbytes</a>, <a class="el" href="rpmio__internal_8h-source.html#l00172">_FD_s::ndigests</a>, <a class="el" href="rpmpgp_8h-source.html#l00285">PGPHASHALGO_MD5</a>, <a class="el" href="rpmpgp_8h-source.html#l00286">PGPHASHALGO_SHA1</a>, <a class="el" href="rpmpgp_8h-source.html#l00291">PGPHASHALGO_SHA256</a>, <a class="el" href="rpmpgp_8h-source.html#l00292">PGPHASHALGO_SHA384</a>, <a class="el" href="rpmpgp_8h-source.html#l00293">PGPHASHALGO_SHA512</a>, <a class="el" href="rpmpgp_8c-source.html#l01109">pgpPrtPkts()</a>, <a class="el" href="rpmlead_8c-source.html#l00048">readLead()</a>, <a class="el" href="rpmpgp_8h-source.html#l00978">RPMDIGEST_NONE</a>, <a class="el" href="digest_8c-source.html#l00046">rpmDigestInit()</a>, <a class="el" href="digest_8c-source.html#l00141">rpmDigestUpdate()</a>, <a class="el" href="rpmerr_8h-source.html#l00117">RPMERR_FREAD</a>, <a class="el" href="rpmerr_8h-source.html#l00042">RPMERR_NEWPACKAGE</a>, <a class="el" href="rpmerr_8h-source.html#l00128">RPMERR_SIGGEN</a>, <a class="el" href="rpmerr_8h-source.html#l00143">rpmError</a>, <a class="el" href="signature_8c-source.html#l00381">rpmFreeSignature()</a>, <a class="el" href="rpmmessages_8h-source.html#l00031">rpmIsDebug</a>, <a class="el" href="rpmmessages_8h-source.html#l00011">RPMMESS_DEBUG</a>, <a class="el" href="rpmmessages_8h-source.html#l00015">RPMMESS_ERROR</a>, <a class="el" href="rpmmessages_8h-source.html#l00014">RPMMESS_WARNING</a>, <a class="el" href="rpmmessages_8h-source.html#l00020">rpmMessage</a>, <a class="el" href="rpmlib_8h-source.html#l00023">RPMRC_FAIL</a>, <a class="el" href="rpmlib_8h-source.html#l00025">RPMRC_NOKEY</a>, <a class="el" href="rpmlib_8h-source.html#l00022">RPMRC_NOTFOUND</a>, <a class="el" href="rpmlib_8h-source.html#l00024">RPMRC_NOTTRUSTED</a>, <a class="el" href="rpmlib_8h-source.html#l00021">RPMRC_OK</a>, <a class="el" href="package_8c-source.html#l00650">rpmReadHeader()</a>, <a class="el" href="signature_8c-source.html#l00155">rpmReadSignature()</a>, <a class="el" href="rpmlib_8h-source.html#l01218">RPMSIGTAG_DSA</a>, <a class="el" href="rpmlib_8h-source.html#l01212">RPMSIGTAG_GPG</a>, <a class="el" href="rpmlib_8h-source.html#l01211">RPMSIGTAG_MD5</a>, <a class="el" href="rpmlib_8h-source.html#l01209">RPMSIGTAG_PGP</a>, <a class="el" href="rpmlib_8h-source.html#l01213">RPMSIGTAG_PGP5</a>, <a class="el" href="rpmlib_8h-source.html#l01219">RPMSIGTAG_RSA</a>, <a class="el" href="rpmlib_8h-source.html#l01217">RPMSIGTAG_SHA1</a>, <a class="el" href="rpmsw_8c-source.html#l00241">rpmswEnter()</a>, <a class="el" href="rpmsw_8c-source.html#l00257">rpmswExit()</a>, <a class="el" href="rpmlib_8h-source.html#l00236">RPMTAG_HEADERIMMUTABLE</a>, <a class="el" href="rpmts_8h-source.html#l00089">RPMTS_OP_DIGEST</a>, <a class="el" href="rpmts_8h-source.html#l00090">RPMTS_OP_SIGNATURE</a>, <a class="el" href="rpmts_8c-source.html#l00754">rpmtsCleanDig()</a>, <a class="el" href="rpmts_8c-source.html#l01171">rpmtsDig()</a>, <a class="el" href="rpmts_8c-source.html#l01483">rpmtsOp()</a>, <a class="el" href="rpmts_8c-source.html#l01155">rpmtsSetSig()</a>, <a class="el" href="package_8c-source.html#l00242">rpmtsStashKeyid()</a>, <a class="el" href="rpmts_8c-source.html#l00909">rpmtsVSFlags()</a>, <a class="el" href="signature_8c-source.html#l01486">rpmVerifySignature()</a>, <a class="el" href="rpmts_8h-source.html#l00028">RPMVSF_NEEDPAYLOAD</a>, <a class="el" href="rpmts_8h-source.html#l00037">RPMVSF_NODSA</a>, <a class="el" href="rpmts_8h-source.html#l00036">RPMVSF_NOMD5</a>, <a class="el" href="rpmts_8h-source.html#l00038">RPMVSF_NORSA</a>, <a class="el" href="rpmts_8h-source.html#l00030">RPMVSF_NOSHA1HEADER</a>, <a class="el" href="rpmio__internal_8h-source.html#l00073">pgpDig_s::sha1ctx</a>, <a class="el" href="rpmio__internal_8h-source.html#l00067">pgpDig_s::signature</a>, <a class="el" href="rpmio__internal_8h-source.html#l00170">_FD_s::stats</a>, <a class="el" href="rpmio__internal_8h-source.html#l00048">pgpDigParams_s::version</a>, and <a class="el" href="rpmcache_8c-source.html#l00511">vsflags</a>.
<p>
Referenced by <a class="el" href="rpmcache_8c-source.html#l00181">ftsStashLatest()</a>, <a class="el" href="rpminstall_8c-source.html#l01012">IDTXglob()</a>, <a class="el" href="rpm2cpio_8c-source.html#l00013">main()</a>, <a class="el" href="pack_8c-source.html#l00296">readRPM()</a>, <a class="el" href="rpmgi_8c-source.html#l00117">rpmgiReadHeader()</a>, <a class="el" href="rpmgraph_8c-source.html#l00044">rpmGraph()</a>, <a class="el" href="rpminstall_8c-source.html#l00286">rpmInstall()</a>, <a class="el" href="psm_8c-source.html#l00238">rpmInstallSourcePackage()</a>, <a class="el" href="rpmts-py_8c-source.html#l00758">rpmts_HdrFromFdno()</a>, <a class="el" href="transaction_8c-source.html#l01406">rpmtsRun()</a>, and <a class="el" href="rpmts_8c-source.html#l00547">rpmtsSolve()</a>.
</div>
</div><p>
<a class="anchor" name="e6ae2a65259638005b456c01f5d8eb0d"></a><!-- doxytag: member="package.c::rpmtsStashKeyid" ref="e6ae2a65259638005b456c01f5d8eb0d" args="(rpmts ts)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int rpmtsStashKeyid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmlib_8h.html#35d575e76e47e498176ffb43c6bd7fcb">rpmts</a>&nbsp;</td>
          <td class="paramname"> <em>ts</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Remember current key id. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ts</em>&nbsp;</td><td>transaction set </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if new keyid, otherwise 1 </dd></dl>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00242">242</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
References <a class="el" href="package_8c-source.html#l00041">keyids</a>, <a class="el" href="package_8c-source.html#l00039">nextkeyid</a>, <a class="el" href="package_8c-source.html#l00037">nkeyids</a>, <a class="el" href="package_8c-source.html#l00035">nkeyids_max</a>, <a class="el" href="rpmpgp_8h-source.html#l00994">pgpGrab()</a>, <a class="el" href="rpmts_8c-source.html#l01171">rpmtsDig()</a>, <a class="el" href="rpmts_8c-source.html#l01139">rpmtsSig()</a>, <a class="el" href="rpmts_8c-source.html#l01182">rpmtsSignature()</a>, <a class="el" href="rpmio__internal_8h-source.html#l00056">pgpDigParams_s::signid</a>, and <a class="el" href="rpmmalloc_8c-source.html#l00045">xrealloc()</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00748">rpmReadPackageFile()</a>.
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="751ebc9b28c168fda034b5a6b5b25722"></a><!-- doxytag: member="package.c::_print_pkts" ref="751ebc9b28c168fda034b5a6b5b25722" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="rpmchecksig_8c.html#751ebc9b28c168fda034b5a6b5b25722">_print_pkts</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00032">32</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00748">rpmReadPackageFile()</a>, and <a class="el" href="rpmchecksig_8c-source.html#l00721">rpmVerifySignatures()</a>.
</div>
</div><p>
<a class="anchor" name="739b796ffa0a2e9218383068dc83b215"></a><!-- doxytag: member="package.c::header_magic" ref="739b796ffa0a2e9218383068dc83b215" args="[8]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char <a class="el" href="group__header.html#g739b796ffa0a2e9218383068dc83b215">header_magic</a>[8]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        0x8e, 0xad, 0xe8, 0x01, 0x00, 0x00, 0x00, 0x00
}
</pre></div>
<p>
Definition at line <a class="el" href="package_8c-source.html#l00044">44</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="signature_8c-source.html#l00697">makeHDRSignature()</a>, <a class="el" href="package_8c-source.html#l00650">rpmReadHeader()</a>, <a class="el" href="package_8c-source.html#l00748">rpmReadPackageFile()</a>, and <a class="el" href="signature_8c-source.html#l00155">rpmReadSignature()</a>.
</div>
</div><p>
<a class="anchor" name="4ef959fa1d9d2126f229e52aeb27a2a2"></a><!-- doxytag: member="package.c::keyids" ref="4ef959fa1d9d2126f229e52aeb27a2a2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int* <a class="el" href="package_8c.html#4ef959fa1d9d2126f229e52aeb27a2a2">keyids</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00041">41</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00242">rpmtsStashKeyid()</a>.
</div>
</div><p>
<a class="anchor" name="d7f8bc9937b87df00aa88bdde50557d6"></a><!-- doxytag: member="package.c::nextkeyid" ref="d7f8bc9937b87df00aa88bdde50557d6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="package_8c.html#d7f8bc9937b87df00aa88bdde50557d6">nextkeyid</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00039">39</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00242">rpmtsStashKeyid()</a>.
</div>
</div><p>
<a class="anchor" name="f09cce9e3e2bdef272ab28ab6acc3843"></a><!-- doxytag: member="package.c::nkeyids" ref="f09cce9e3e2bdef272ab28ab6acc3843" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="package_8c.html#f09cce9e3e2bdef272ab28ab6acc3843">nkeyids</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00037">37</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00242">rpmtsStashKeyid()</a>.
</div>
</div><p>
<a class="anchor" name="4dd70aef76799c6e3f3b455aac77d78e"></a><!-- doxytag: member="package.c::nkeyids_max" ref="4dd70aef76799c6e3f3b455aac77d78e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="package_8c.html#4dd70aef76799c6e3f3b455aac77d78e">nkeyids_max</a> = 256<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00035">35</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
<p>
Referenced by <a class="el" href="package_8c-source.html#l00242">rpmtsStashKeyid()</a>.
</div>
</div><p>
<a class="anchor" name="95fa690843429c2a518b13150729cfac"></a><!-- doxytag: member="package.c::typeAlign" ref="95fa690843429c2a518b13150729cfac" args="[16]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__header.html#g95fa690843429c2a518b13150729cfac">typeAlign</a>[16]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">  {
    1,  
    1,  
    1,  
    2,  
    4,  
    8,  
    1,  
    1,  
    1,  
    1,  
    0,
    0,
    0,
    0,
    0,
    0
}
</pre></div>Alignment needs (and sizeof scalars types) for internal rpm data types. 
<p>

<p>
Definition at line <a class="el" href="package_8c-source.html#l00052">52</a> of file <a class="el" href="package_8c-source.html">package.c</a>.
</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Oct 12 08:44:55 2007 for rpm by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
