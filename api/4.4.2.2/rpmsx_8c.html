<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>rpm: lib/rpmsx.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul>
</div>
<h1>lib/rpmsx.c File Reference</h1><code>#include &quot;<a class="el" href="system_8h-source.html">system.h</a>&quot;</code><br>
<code>#include &lt;<a class="el" href="rpmlib_8h-source.html">rpmlib.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="rpmmacro_8h-source.html">rpmmacro.h</a>&gt;</code><br>
<code>#include &quot;<a class="el" href="rpmsx_8h-source.html">rpmsx.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="debug_8h-source.html">debug.h</a>&quot;</code><br>

<p>
<a href="rpmsx_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#f248ac24d8294258fd6638b10c380145">_RPMSX_INTERNAL</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#89e2731fc49d52e3853fc18cc813613c">inc_err</a>()&nbsp;&nbsp;&nbsp;nerr++</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#f6ab6a741ecfb4b84dbba7e2ae4f778c">rpmsxSort</a> (<a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stable sort for policy specifications, patterns before paths.  <a href="#f6ab6a741ecfb4b84dbba7e2ae4f778c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#834949f51258429747f5bb6d4b56348b">rpmsxpHasMetaChars</a> (<a class="el" href="rpmsx_8h.html#babe058f6c13a6d0e5aaf13d45e5ea35">rpmsxp</a> sxp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#5903e292f18137fccbae5ab520ac1aae">rpmsxsPStem</a> (const char *const buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the length of the text that can be considered the stem.  <a href="#5903e292f18137fccbae5ab520ac1aae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#621c77e48e82bbe38218ff57f64b0f3d">rpmsxsFStem</a> (const char *const buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the length of the text that is the stem of a file <a class="el" href="structname.html">name</a>.  <a href="#621c77e48e82bbe38218ff57f64b0f3d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#887fba314534736e604595bc8dad85b8">rpmsxAdd</a> (<a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx, const char **bpp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find (or create) the stem of a file spec.  <a href="#887fba314534736e604595bc8dad85b8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#0eec8cf8fa1b44501afcde1cb4d8839e">rpmsxFind</a> (const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx, const char **bpp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find the stem of a file <a class="el" href="structname.html">name</a>.  <a href="#0eec8cf8fa1b44501afcde1cb4d8839e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#41127b7ea33bde5db9af5c877f38e60d">XrpmsxUnlink</a> (<a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx, const char *msg, const char *fn, unsigned ln)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#3ad7856b7e98b91e5c87e810720665c3">XrpmsxLink</a> (<a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx, const char *msg, const char *fn, unsigned ln)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#d7df0ab22dc0e290e370db3a100f76fa">rpmsxFree</a> (<a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy a security context patterns.  <a href="#d7df0ab22dc0e290e370db3a100f76fa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#3be6e9ea0064d76fb775901f21e99322">rpmsxpCheckNoDupes</a> (const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check for duplicate specifications.  <a href="#3be6e9ea0064d76fb775901f21e99322"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#ef266043e432fd963098aa72d74e2a52">rpmsxParse</a> (<a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx, const char *fn)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parse selinux file security context patterns.  <a href="#ef266043e432fd963098aa72d74e2a52"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#5463f4fa130947cf449159dc8241df7b">rpmsxNew</a> (const char *fn)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create and load security context patterns.  <a href="#5463f4fa130947cf449159dc8241df7b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#c6e496feec24f34c1cdaea18eac082a2">rpmsxCount</a> (const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return security context patterns count.  <a href="#c6e496feec24f34c1cdaea18eac082a2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#08c64dac101fbf81d8ffde6a68669723">rpmsxIx</a> (const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return security context patterns index.  <a href="#08c64dac101fbf81d8ffde6a68669723"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#1a7e1c9d0bc2cd471020c89176af590d">rpmsxSetIx</a> (<a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx, int ix)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set security context patterns index.  <a href="#1a7e1c9d0bc2cd471020c89176af590d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#07220d13ea60d67a59db1f2ae25239ba">rpmsxPattern</a> (const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return current pattern.  <a href="#07220d13ea60d67a59db1f2ae25239ba"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#fc2ff24d90fe93386c81ca716b5706ec">rpmsxType</a> (const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return current type.  <a href="#fc2ff24d90fe93386c81ca716b5706ec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#79e0aae2108751997920d1425cc7964b">rpmsxContext</a> (const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return current context.  <a href="#79e0aae2108751997920d1425cc7964b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">regex_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#575875eaaab6bf0407c44af0c749c291">rpmsxRE</a> (const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return current regex.  <a href="#575875eaaab6bf0407c44af0c749c291"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">mode_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#c4251e1351a923d637a98bc023540398">rpmsxFMode</a> (const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return current file mode.  <a href="#c4251e1351a923d637a98bc023540398"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#a95eae2ede5cd2888586de31407b56b2">rpmsxFStem</a> (const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return current file stem.  <a href="#a95eae2ede5cd2888586de31407b56b2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#512d060a6b14a274347c71a0d752f271">rpmsxNext</a> (<a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return next security context patterns iterator index.  <a href="#512d060a6b14a274347c71a0d752f271"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#5c768acaedc669beb0165cc93aa4d650">rpmsxInit</a> (<a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx, int <a class="el" href="rpminstall_8c.html#052f243a02ba4a715c9e395aff5ec1d2">reverse</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize security context patterns iterator.  <a href="#5c768acaedc669beb0165cc93aa4d650"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#abb8573e3d9334d7a05cc7683a5a73c2">rpmsxFContext</a> (<a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> sx, const char *fn, mode_t fmode)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find file security context from path and type.  <a href="#abb8573e3d9334d7a05cc7683a5a73c2"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpmsx_8c.html#24ba841aad63f1e594c3f73625686fb8">_rpmsx_debug</a> = 0</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>
Definition in file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="f248ac24d8294258fd6638b10c380145"></a><!-- doxytag: member="rpmsx.c::_RPMSX_INTERNAL" ref="f248ac24d8294258fd6638b10c380145" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _RPMSX_INTERNAL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00009">9</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
</div>
</div><p>
<a class="anchor" name="89e2731fc49d52e3853fc18cc813613c"></a><!-- doxytag: member="rpmsx.c::inc_err" ref="89e2731fc49d52e3853fc18cc813613c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define inc_err          </td>
          <td>(</td>
&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;nerr++</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00319">rpmsxParse()</a>.
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="887fba314534736e604595bc8dad85b8"></a><!-- doxytag: member="rpmsx.c::rpmsxAdd" ref="887fba314534736e604595bc8dad85b8" args="(rpmsx sx, const char **bpp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int rpmsxAdd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>bpp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find (or create) the stem of a file spec. 
<p>
Error iff a file in the root directory or a regex that is too complex.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*bpp</em>&nbsp;</td><td>ptr to text after stem. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>stem index, -1 on error </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00138">138</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
References <a class="el" href="rpmsx_8c-source.html#l00099">rpmsxsPStem()</a>, and <a class="el" href="rpmmalloc_8c-source.html#l00045">xrealloc()</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00319">rpmsxParse()</a>.
</div>
</div><p>
<a class="anchor" name="79e0aae2108751997920d1425cc7964b"></a><!-- doxytag: member="rpmsx.c::rpmsxContext" ref="79e0aae2108751997920d1425cc7964b" args="(const rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* rpmsxContext           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return current context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>current context, NULL on invalid </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00578">578</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00658">rpmsxFContext()</a>.
</div>
</div><p>
<a class="anchor" name="c6e496feec24f34c1cdaea18eac082a2"></a><!-- doxytag: member="rpmsx.c::rpmsxCount" ref="c6e496feec24f34c1cdaea18eac082a2" args="(const rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rpmsxCount           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return security context patterns count. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>current count </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00539">539</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
</div>
</div><p>
<a class="anchor" name="abb8573e3d9334d7a05cc7683a5a73c2"></a><!-- doxytag: member="rpmsx.c::rpmsxFContext" ref="abb8573e3d9334d7a05cc7683a5a73c2" args="(rpmsx sx, const char *fn, mode_t fmode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* rpmsxFContext           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t&nbsp;</td>
          <td class="paramname"> <em>fmode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find file security context from path and type. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fn</em>&nbsp;</td><td>file path </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fmode</em>&nbsp;</td><td>file mode </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>file security context </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00658">658</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
References <a class="el" href="rpmsx_8c-source.html#l00578">rpmsxContext()</a>, <a class="el" href="rpmsx_8c-source.html#l00182">rpmsxFind()</a>, <a class="el" href="rpmsx_8c-source.html#l00596">rpmsxFMode()</a>, <a class="el" href="rpmsx_8c-source.html#l00605">rpmsxFStem()</a>, <a class="el" href="rpmsx_8c-source.html#l00646">rpmsxInit()</a>, <a class="el" href="rpmsx_8c-source.html#l00614">rpmsxNext()</a>, <a class="el" href="rpmsx_8c-source.html#l00560">rpmsxPattern()</a>, and <a class="el" href="rpmsx_8c-source.html#l00587">rpmsxRE()</a>.
</div>
</div><p>
<a class="anchor" name="0eec8cf8fa1b44501afcde1cb4d8839e"></a><!-- doxytag: member="rpmsx.c::rpmsxFind" ref="0eec8cf8fa1b44501afcde1cb4d8839e" args="(const rpmsx sx, const char **bpp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int rpmsxFind           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>bpp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find the stem of a file <a class="el" href="structname.html">name</a>. 
<p>
Error iff a file in the root directory or a regex that is too complex.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*bpp</em>&nbsp;</td><td>ptr to text after stem. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>stem index, -1 on error </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00182">182</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
References <a class="el" href="rpmsx_8c-source.html#l00121">rpmsxsFStem()</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00658">rpmsxFContext()</a>.
</div>
</div><p>
<a class="anchor" name="c4251e1351a923d637a98bc023540398"></a><!-- doxytag: member="rpmsx.c::rpmsxFMode" ref="c4251e1351a923d637a98bc023540398" args="(const rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mode_t rpmsxFMode           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return current file mode. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>current file mode, 0 on invalid </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00596">596</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00658">rpmsxFContext()</a>.
</div>
</div><p>
<a class="anchor" name="d7df0ab22dc0e290e370db3a100f76fa"></a><!-- doxytag: member="rpmsx.c::rpmsxFree" ref="d7df0ab22dc0e290e370db3a100f76fa" args="(rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> rpmsxFree           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destroy a security context patterns. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>NULL always </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00226">226</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
References <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="rpmsx_8c-source.html#l00017">_rpmsx_debug</a>, and <a class="el" href="rpmsx_8h-source.html#l00097">rpmsxUnlink</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00518">rpmsxNew()</a>, <a class="el" href="rpmts_8c-source.html#l00850">rpmtsFree()</a>, and <a class="el" href="rpmts_8c-source.html#l01092">rpmtsSetREContext()</a>.
</div>
</div><p>
<a class="anchor" name="a95eae2ede5cd2888586de31407b56b2"></a><!-- doxytag: member="rpmsx.c::rpmsxFStem" ref="a95eae2ede5cd2888586de31407b56b2" args="(const rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rpmsxFStem           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return current file stem. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>current file stem, -1 on invalid </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00605">605</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00658">rpmsxFContext()</a>.
</div>
</div><p>
<a class="anchor" name="5c768acaedc669beb0165cc93aa4d650"></a><!-- doxytag: member="rpmsx.c::rpmsxInit" ref="5c768acaedc669beb0165cc93aa4d650" args="(rpmsx sx, int reverse)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> rpmsxInit           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>reverse</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize security context patterns iterator. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reverse</em>&nbsp;</td><td>iterate in reverse order? </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>security context patterns </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00646">646</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00658">rpmsxFContext()</a>.
</div>
</div><p>
<a class="anchor" name="08c64dac101fbf81d8ffde6a68669723"></a><!-- doxytag: member="rpmsx.c::rpmsxIx" ref="08c64dac101fbf81d8ffde6a68669723" args="(const rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rpmsxIx           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return security context patterns index. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>current index </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00544">544</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
</div>
</div><p>
<a class="anchor" name="5463f4fa130947cf449159dc8241df7b"></a><!-- doxytag: member="rpmsx.c::rpmsxNew" ref="5463f4fa130947cf449159dc8241df7b" args="(const char *fn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> rpmsxNew           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fn</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create and load security context patterns. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fn</em>&nbsp;</td><td>security context patterns file <a class="el" href="structname.html">name</a> </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>new security context patterns </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00518">518</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
References <a class="el" href="rpmsx_8c-source.html#l00226">rpmsxFree()</a>, <a class="el" href="rpmsx_8h-source.html#l00116">rpmsxLink</a>, <a class="el" href="rpmsx_8c-source.html#l00319">rpmsxParse()</a>, and <a class="el" href="rpmmalloc_8c-source.html#l00034">xcalloc()</a>.
</div>
</div><p>
<a class="anchor" name="512d060a6b14a274347c71a0d752f271"></a><!-- doxytag: member="rpmsx.c::rpmsxNext" ref="512d060a6b14a274347c71a0d752f271" args="(rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rpmsxNext           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return next security context patterns iterator index. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>security context patterns iterator index, -1 on termination </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00614">614</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
References <a class="el" href="rpmsx_8c-source.html#l00017">_rpmsx_debug</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00658">rpmsxFContext()</a>.
</div>
</div><p>
<a class="anchor" name="ef266043e432fd963098aa72d74e2a52"></a><!-- doxytag: member="rpmsx.c::rpmsxParse" ref="ef266043e432fd963098aa72d74e2a52" args="(rpmsx sx, const char *fn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rpmsxParse           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Parse selinux file security context patterns. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fn</em>&nbsp;</td><td>file <a class="el" href="structname.html">name</a> to parse </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00319">319</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
References <a class="el" href="system_8h-source.html#l00478">_</a>, <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, <a class="el" href="system_8h.html#a5e6580e8f12679392f66d3c9b146ab4">errno</a>, <a class="el" href="rpmsx_8c.html#89e2731fc49d52e3853fc18cc813613c">inc_err</a>, <a class="el" href="rpmcache_8c-source.html#l00049">items</a>, <a class="el" href="macro_8c-source.html#l02254">rpmGetPath()</a>, <a class="el" href="rpmsx_8c-source.html#l00138">rpmsxAdd()</a>, <a class="el" href="rpmsx_8c-source.html#l00280">rpmsxpCheckNoDupes()</a>, <a class="el" href="rpmsx_8c-source.html#l00057">rpmsxpHasMetaChars()</a>, <a class="el" href="rpmsx_8c-source.html#l00023">rpmsxSort()</a>, <a class="el" href="system_8h-source.html#l00608">S_IFSOCK</a>, <a class="el" href="system_8h-source.html#l00309">security_check_context</a>, <a class="el" href="rpmmalloc_8c-source.html#l00034">xcalloc()</a>, and <a class="el" href="rpmmalloc_8c-source.html#l00024">xmalloc()</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00518">rpmsxNew()</a>.
</div>
</div><p>
<a class="anchor" name="07220d13ea60d67a59db1f2ae25239ba"></a><!-- doxytag: member="rpmsx.c::rpmsxPattern" ref="07220d13ea60d67a59db1f2ae25239ba" args="(const rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* rpmsxPattern           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return current pattern. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>current pattern, NULL on invalid </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00560">560</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00658">rpmsxFContext()</a>.
</div>
</div><p>
<a class="anchor" name="3be6e9ea0064d76fb775901f21e99322"></a><!-- doxytag: member="rpmsx.c::rpmsxpCheckNoDupes" ref="3be6e9ea0064d76fb775901f21e99322" args="(const rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int rpmsxpCheckNoDupes           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check for duplicate specifications. 
<p>
If a duplicate specification is found and the context is the same, give a warning to the user. If a duplicate specification is found and the context is different, give a warning to the user (This could be changed to error). Return of non-zero is an error.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00280">280</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00319">rpmsxParse()</a>.
</div>
</div><p>
<a class="anchor" name="834949f51258429747f5bb6d4b56348b"></a><!-- doxytag: member="rpmsx.c::rpmsxpHasMetaChars" ref="834949f51258429747f5bb6d4b56348b" args="(rpmsxp sxp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void rpmsxpHasMetaChars           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#babe058f6c13a6d0e5aaf13d45e5ea35">rpmsxp</a>&nbsp;</td>
          <td class="paramname"> <em>sxp</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00057">57</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00319">rpmsxParse()</a>.
</div>
</div><p>
<a class="anchor" name="575875eaaab6bf0407c44af0c749c291"></a><!-- doxytag: member="rpmsx.c::rpmsxRE" ref="575875eaaab6bf0407c44af0c749c291" args="(const rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">regex_t* rpmsxRE           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return current regex. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>current context, NULL on invalid </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00587">587</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00658">rpmsxFContext()</a>.
</div>
</div><p>
<a class="anchor" name="1a7e1c9d0bc2cd471020c89176af590d"></a><!-- doxytag: member="rpmsx.c::rpmsxSetIx" ref="1a7e1c9d0bc2cd471020c89176af590d" args="(rpmsx sx, int ix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rpmsxSetIx           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ix</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set security context patterns index. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ix</em>&nbsp;</td><td>new index </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>current index </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00549">549</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
</div>
</div><p>
<a class="anchor" name="621c77e48e82bbe38218ff57f64b0f3d"></a><!-- doxytag: member="rpmsx.c::rpmsxsFStem" ref="621c77e48e82bbe38218ff57f64b0f3d" args="(const char *const buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static size_t rpmsxsFStem           </td>
          <td>(</td>
          <td class="paramtype">const char *const&nbsp;</td>
          <td class="paramname"> <em>buf</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the length of the text that is the stem of a file <a class="el" href="structname.html">name</a>. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>stem length, 0 if no identifiable stem </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00121">121</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00182">rpmsxFind()</a>.
</div>
</div><p>
<a class="anchor" name="f6ab6a741ecfb4b84dbba7e2ae4f778c"></a><!-- doxytag: member="rpmsx.c::rpmsxSort" ref="f6ab6a741ecfb4b84dbba7e2ae4f778c" args="(rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void rpmsxSort           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stable sort for policy specifications, patterns before paths. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00023">23</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
References <a class="el" href="rpmlib_8h-source.html#l00058">_free()</a>, and <a class="el" href="rpmmalloc_8c-source.html#l00024">xmalloc()</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00319">rpmsxParse()</a>.
</div>
</div><p>
<a class="anchor" name="5903e292f18137fccbae5ab520ac1aae"></a><!-- doxytag: member="rpmsx.c::rpmsxsPStem" ref="5903e292f18137fccbae5ab520ac1aae" args="(const char *const buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static size_t rpmsxsPStem           </td>
          <td>(</td>
          <td class="paramtype">const char *const&nbsp;</td>
          <td class="paramname"> <em>buf</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the length of the text that can be considered the stem. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>stem length, 0 if no identifiable stem </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00099">99</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
Referenced by <a class="el" href="rpmsx_8c-source.html#l00138">rpmsxAdd()</a>.
</div>
</div><p>
<a class="anchor" name="fc2ff24d90fe93386c81ca716b5706ec"></a><!-- doxytag: member="rpmsx.c::rpmsxType" ref="fc2ff24d90fe93386c81ca716b5706ec" args="(const rpmsx sx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* rpmsxType           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return current type. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sx</em>&nbsp;</td><td>security context patterns </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>current type, NULL on invalid/missing </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00569">569</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
</div>
</div><p>
<a class="anchor" name="3ad7856b7e98b91e5c87e810720665c3"></a><!-- doxytag: member="rpmsx.c::XrpmsxLink" ref="3ad7856b7e98b91e5c87e810720665c3" args="(rpmsx sx, const char *msg, const char *fn, unsigned ln)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> XrpmsxLink           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>ln</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000077">Todo:</a></b></dt><dd>Remove debugging entry from the ABI. </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00213">213</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
References <a class="el" href="rpmsx_8c-source.html#l00017">_rpmsx_debug</a>.
</div>
</div><p>
<a class="anchor" name="41127b7ea33bde5db9af5c877f38e60d"></a><!-- doxytag: member="rpmsx.c::XrpmsxUnlink" ref="41127b7ea33bde5db9af5c877f38e60d" args="(rpmsx sx, const char *msg, const char *fn, unsigned ln)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a> XrpmsxUnlink           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpmsx_8h.html#8f8544521e8b2be769e1319094986bba">rpmsx</a>&nbsp;</td>
          <td class="paramname"> <em>sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>ln</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000076">Todo:</a></b></dt><dd>Remove debugging entry from the ABI. </dd></dl>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00202">202</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
<p>
References <a class="el" href="rpmsx_8c-source.html#l00017">_rpmsx_debug</a>.
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="24ba841aad63f1e594c3f73625686fb8"></a><!-- doxytag: member="rpmsx.c::_rpmsx_debug" ref="24ba841aad63f1e594c3f73625686fb8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="rpmsx_8h.html#24ba841aad63f1e594c3f73625686fb8">_rpmsx_debug</a> = 0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="rpmsx_8c-source.html#l00017">17</a> of file <a class="el" href="rpmsx_8c-source.html">rpmsx.c</a>.
</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Oct 12 08:44:55 2007 for rpm by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
